<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sheets Master</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg-color: #0f172a;
            --card-bg: #1e293b;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --accent-green: #10b981;
            --accent-green-glow: rgba(16, 185, 129, 0.5);
            --border-color: #334155;
            --sheet-grid: #e2e8f0;
            --sheet-header: #f1f5f9;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            overflow-x: hidden;
            padding-top: 80px;
        }

        /* Ambient Background */
        .ambient-light {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            z-index: -1;
            background: radial-gradient(circle at 10% 20%, rgba(16, 185, 129, 0.05) 0%, transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(59, 130, 246, 0.05) 0%, transparent 40%);
        }

        header {
            padding: 4rem 2rem;
            text-align: center;
            position: relative;
        }

        h1 {
            font-size: 3.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #fff 0%, #94a3b8 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
            letter-spacing: -0.02em;
        }

        p.subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto;
        }

        /* Search and Filter */
        .controls-wrapper {
            max-width: 800px;
            margin: 2rem auto;
            display: flex;
            gap: 1rem;
            padding: 0 2rem;
        }

        .search-box {
            flex: 1;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(30, 41, 59, 0.6);
            color: #fff;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #3b82f6;
            background: rgba(30, 41, 59, 0.9);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }

        .filter-select {
            padding: 0 1.5rem;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(30, 41, 59, 0.6);
            color: #fff;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2394a3b8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 1rem;
            min-width: 160px;
        }

        .filter-select:focus {
            outline: none;
            border-color: #3b82f6;
        }

        /* Main Table Container */
        .container {
            max-width: 100%;
            margin: 0 auto 4rem auto;
            padding: 0 2rem;
        }

        .controls-wrapper {
            max-width: 1400px;
            /* Match container width */
        }

        .table-wrapper {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            overflow: hidden;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 1rem;
        }

        thead {
            background: rgba(15, 23, 42, 0.8);
            border-bottom: 1px solid var(--border-color);
        }

        th {
            text-align: left;
            padding: 1.5rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.05em;
        }

        tbody tr {
            border-bottom: 1px solid rgba(255, 255, 255, 0.02);
            transition: background-color 0.2s ease;
        }

        tbody tr:hover {
            background-color: rgba(255, 255, 255, 0.02);
        }

        td {
            padding: 1.5rem;
            vertical-align: middle;
        }

        /* Type Badge */
        .type-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .type-math {
            background: rgba(59, 130, 246, 0.1);
            color: #60a5fa;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .type-logical {
            background: rgba(234, 179, 8, 0.1);
            color: #facc15;
            border: 1px solid rgba(234, 179, 8, 0.2);
        }

        .type-text {
            background: rgba(236, 72, 153, 0.1);
            color: #f472b6;
            border: 1px solid rgba(236, 72, 153, 0.2);
        }

        .type-date {
            background: rgba(16, 185, 129, 0.1);
            color: #34d399;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .type-lookup {
            background: rgba(139, 92, 246, 0.1);
            color: #a78bfa;
            border: 1px solid rgba(139, 92, 246, 0.2);
        }

        .type-array {
            background: #fdf2f8;
            color: #db2777;
            border: 1px solid rgba(219, 39, 119, 0.2);
        }

        /* Pink */
        .type-filter {
            background: #f5f3ff;
            color: #7c3aed;
            border: 1px solid rgba(124, 58, 237, 0.2);
        }

        /* Violet */
        .type-google {
            background: #eff6ff;
            color: #2563eb;
            border: 1px solid rgba(37, 99, 235, 0.2);
        }

        /* Blue */
        .type-statistical {
            background: #fff7ed;
            color: #ea580c;
            border: 1px solid rgba(234, 88, 12, 0.2);
        }

        /* Orange */
        .type-web {
            background: #f0f9ff;
            color: #0284c7;
            border: 1px solid rgba(2, 132, 199, 0.2);
        }

        /* Light Blue */
        .type-financial {
            background: #ecfdf5;
            color: #059669;
            border: 1px solid rgba(5, 150, 105, 0.2);
        }

        /* Emerald */
        .type-info {
            background: #f8fafc;
            color: #475569;
            border: 1px solid rgba(71, 85, 105, 0.2);
        }

        /* Slate */

        /* Custom Neon Checkbox */
        .read-checkbox {
            appearance: none;
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(16, 185, 129, 0.3);
            border-radius: 4px;
            background: rgba(15, 23, 42, 0.5);
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        .read-checkbox:hover {
            border-color: rgba(16, 185, 129, 0.6);
            box-shadow: 0 0 8px rgba(16, 185, 129, 0.3);
        }

        .read-checkbox:checked {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(16, 185, 129, 0.1));
            border-color: var(--accent-green);
            box-shadow: 0 0 12px rgba(16, 185, 129, 0.5),
                inset 0 0 8px rgba(16, 185, 129, 0.2);
        }

        .read-checkbox:checked::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--accent-green);
            font-size: 14px;
            font-weight: bold;
            text-shadow: 0 0 8px rgba(16, 185, 129, 0.8);
        }

        .read-checkbox:focus {
            outline: none;
            border-color: var(--accent-green);
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2);
        }

        .func_name {
            font-family: 'Space Mono', monospace;
            font-weight: 700;
            font-size: 1.1rem;
            color: #fff;
        }

        .syntax {
            font-family: 'Space Mono', monospace;
            font-size: 0.9rem;
            color: var(--text-secondary);
            background: rgba(0, 0, 0, 0.3);
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            display: inline-block;
        }

        .example {
            font-family: 'Space Mono', monospace;
            color: var(--accent-green);
        }

        .desc {
            color: #cbd5e1;
            line-height: 1.6;
            max-width: 300px;
        }

        /* Play Button */
        .play-btn {
            background: transparent;
            border: 1px solid var(--accent-green);
            color: var(--accent-green);
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .play-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--accent-green);
            opacity: 0;
            transition: opacity 0.3s;
            z-index: -1;
        }

        .play-btn:hover {
            color: #0f172a;
            box-shadow: 0 0 20px var(--accent-green-glow);
            transform: scale(1.05);
        }

        .play-btn:hover::before {
            opacity: 1;
        }

        .play-icon {
            width: 16px;
            height: 16px;
            fill: currentColor;
            transform: translateX(2px);
            /* visual center correction */
        }

        /* Modal / Animation Stage */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .animation-stage {
            width: 800px;
            max-width: 90vw;
            background: #fff;
            /* Sheet look */
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 50px 100px -20px rgba(0, 0, 0, 0.5);
            transform: translateY(20px);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
        }

        .modal-overlay.active .animation-stage {
            transform: translateY(0);
        }

        /* Mock Sheet UI */
        .sheet-header {
            background: #f8f9fa;
            border-bottom: 1px solid #e0e0e0;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sheet-title {
            color: #202124;
            font-weight: 500;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sheet-icon {
            color: var(--accent-green);
            font-size: 1.5rem;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #5f6368;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: background 0.2s;
        }

        .close-btn:hover {
            background: #eeeeee;
        }

        .formula-bar {
            background: #fff;
            border-bottom: 1px solid #e0e0e0;
            padding: 0.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .fx-symbol {
            color: #5f6368;
            font-weight: bold;
            font-family: 'Times', serif;
            font-style: italic;
            padding-left: 1rem;
        }

        .formula-input {
            background: #f1f3f4;
            border-radius: 4px;
            /* Pill shapeish */
            height: 28px;
            flex: 1;
            display: flex;
            align-items: center;
            padding: 0 10px;
            font-family: 'Space Mono', monospace;
            font-size: 0.9rem;
            color: #000;
            position: relative;
        }

        .cursor {
            display: inline-block;
            width: 2px;
            height: 1.2em;
            background-color: black;
            animation: blink 1s step-end infinite;
            vertical-align: middle;
            display: none;
        }

        @keyframes blink {
            50% {
                opacity: 0;
            }
        }

        .sheet-grid {
            display: grid;
            grid-template-columns: 50px repeat(4, 1fr);
            /* Row header + 4 cols */
            grid-auto-rows: 40px;
            background: #e0e0e0;
            /* Grid lines */
            gap: 1px;
            border-bottom: 1px solid #e0e0e0;
            padding: 0;
            overflow: hidden;
        }

        .cell {
            background: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            /* Generally center for demo */
            font-size: 0.9rem;
            color: #202124;
            position: relative;
        }

        .cell-header {
            background: #f8f9fa;
            font-weight: bold;
            color: #5f6368;
        }

        .cell.active {
            border: 2px solid var(--accent-green);
            z-index: 10;
        }

        .cell.highlight {
            background: rgba(16, 185, 129, 0.1);
            border: 1px dashed var(--accent-green);
        }

        .animation-controls {
            padding: 1.5rem;
            text-align: center;
            background: #f8f9fa;
            border-top: 1px solid #e0e0e0;
        }

        .status-text {
            color: #5f6368;
            font-size: 0.9rem;
            min-height: 1.5em;
        }

        /* Sticky Progress Bar */
        .progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: var(--text-secondary);
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        .progress-bar-track {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 999px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: var(--accent-green);
            width: 0%;
            transition: width 0.4s ease;
            border-radius: 999px;
            box-shadow: 0 0 10px var(--accent-green-glow);
        }

        .completion-rate {
            color: var(--accent-green);
            font-weight: 600;
        }
    </style>
    <style>
        /* Responsive Design */
        @media (max-width: 768px) {
            header {
                padding: 2rem 1rem;
            }

            h1 {
                font-size: 2.5rem;
            }

            p.subtitle {
                font-size: 1rem;
                padding: 0 1rem;
            }

            .controls-wrapper {
                flex-direction: column;
                padding: 0 1.5rem;
                gap: 0.75rem;
            }

            .search-box,
            .filter-select {
                width: 100%;
            }

            .container {
                padding: 0 1rem;
                margin-bottom: 2rem;
            }

            .table-wrapper {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                border-radius: 12px;
                /* Reduce radius to prevent clipping */
                /* Smooth scroll on iOS */
            }

            table {
                min-width: 900px;
                /* Ensure table doesn't squash */
                border-collapse: separate;
                /* Fixes some border render issues */
                border-spacing: 0;
            }

            th,
            td {
                padding: 1rem;
                font-size: 0.9rem;
                white-space: nowrap;
                /* Prevent awkward wrapping */
            }

            th:last-child,
            td:last-child {
                padding-right: 1.5rem;
                /* Extra padding for the last column */
            }

            /* Modal Responsive */
            .modal-content {
                width: 95%;
                margin: 1rem;
                max-height: 90vh;
                display: flex;
                flex-direction: column;
            }

            .animation-stage {
                overflow-y: auto;
            }

            .sheet-grid {
                /* Adjust grid for smaller screens if needed, 
                   but usually horizontal space is the constraint */
                min-width: 300px;
            }
        }

        /* Small mobile tweaks */
        @media (max-width: 480px) {
            h1 {
                font-size: 2rem;
            }

            .modal-overlay {
                padding: 0;
                align-items: flex-end;
                /* Sheet style popup */
            }

            .modal-content {
                width: 100%;
                margin: 0;
                border-radius: 20px 20px 0 0;
            }
        }

        /* Mobile Restriction Styles */
        .mobile-restriction {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-color);
            z-index: 10000;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 2rem;
        }

        .restriction-content h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #fff 0%, #94a3b8 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .restriction-content p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            max-width: 400px;
        }

        @media (max-width: 768px) {
            .mobile-restriction {
                display: flex;
            }

            /* Hide all other content */
            body>*:not(.mobile-restriction) {
                display: none !important;
            }
        }

        @media (max-width: 768px) {
            .progress-container {
                padding: 0.75rem 1rem;
            }

            body {
                padding-top: 70px;
                padding-bottom: 80px;
            }
        }

        .fixed-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem;
            text-align: center;
            z-index: 1000;
        }

        .fixed-footer p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin: 0;
        }

        .creator-name {
            color: var(--accent-green);
            font-weight: 600;
        }
    </style>
</head>

<body>

    <div class="ambient-light"></div>

    <!-- Sticky Progress Bar -->
    <div class="progress-container">
        <div class="progress-header">
            <span>Progress</span>
            <span id="completion-rate" class="completion-rate">0%</span>
        </div>
        <div class="progress-bar-track">
            <div id="progress-bar-fill" class="progress-bar-fill"></div>
        </div>
    </div>

    <header>
        <h1>Sheets Master</h1>
        <p class="subtitle">Interactive visual guide to the most powerful Google Sheets functions.</p>
        <p class="subtitle">
            <font color="grey" size="2">Ideation & development Satyaki Das | Innovation in Education</font>
        </p>
    </header>

    <!-- Mobile Restriction Overlay -->
    <div class="mobile-restriction">
        <div class="restriction-content">
            <h1>Desktop Only</h1>
            <p>This application is designed for larger screens. Please open it on a desktop or tablet for the best
                experience.</p>
        </div>
    </div>

    <div class="container">
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th style="width: 50px;">✓</th>
                        <th>Type</th>
                        <th>Name</th>
                        <th>Syntax</th>
                        <th>Example</th>
                        <th>Description</th>
                        <th>Demo</th>
                    </tr>
                </thead>
                <tbody id="functions-body">
                    <!-- Rows will be populated by JS -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Animation Modal -->
    <div class="modal-overlay" id="modal">
        <div class="animation-stage">
            <div class="sheet-header">
                <div class="sheet-title">
                    <span class="sheet-icon">田</span>
                    <span id="demo-title">SUM Function Demo</span>
                </div>
                <button class="close-btn" onclick="closeModal()">×</button>
            </div>

            <div class="formula-bar">
                <span class="fx-symbol">fx</span>
                <div class="formula-input" id="formula-display">
                    <span id="formula-text"></span><span class="cursor" id="cursor"></span>
                </div>
            </div>

            <div class="sheet-grid" id="grid-container">
                <!-- Grid generated by JS -->
            </div>

            <div class="animation-controls">
                <p class="status-text" id="status-text">Initializing...</p>
            </div>
        </div>
    </div>

    <script>
        // Data Source
        const functions = [
            // --- EXISTING ---
            {
                type: 'Math',
                name: 'SUM',
                syntax: 'SUM(value1, [value2])',
                example: '=SUM(A1:A3)',
                desc: 'Calculates the sum of a range of cells.',
                data: {
                    A1: 10, A2: 20, A3: 30, B1: 5, B2: 2, B3: 8,
                    target: 'A4',
                    formula: '=SUM(A1:A3)',
                    result: 60,
                    highlight: ['A1', 'A2', 'A3'],
                    steps: ["Select cell A4.", "Type standard sum formula.", "Reference range A1 to A3.", "Total is calculated."]
                }
            },
            {
                type: 'Math',
                name: 'AVERAGE',
                syntax: 'AVERAGE(value1, [value2])',
                example: '=AVERAGE(B1:B3)',
                desc: 'Returns the numerical average value in a dataset.',
                data: {
                    A1: 10, A2: 20, A3: 30, B1: 100, B2: 200, B3: 600,
                    target: 'B4',
                    formula: '=AVERAGE(B1:B3)',
                    result: 300,
                    highlight: ['B1', 'B2', 'B3'],
                    steps: ["Select target cell B4.", "Input AVERAGE function.", "Select the data range.", "Average (Mean) is computed."]
                }
            },
            {
                type: 'Math',
                name: 'MAX',
                syntax: 'MAX(value1, [value2])',
                example: '=MAX(A1:A5)',
                desc: 'Returns the maximum value in a numeric dataset.',
                data: {
                    A1: 12, A2: 45, A3: 7, A4: 98, A5: 23,
                    target: 'A6',
                    formula: '=MAX(A1:A5)',
                    result: 98,
                    highlight: ['A1', 'A2', 'A3', 'A4', 'A5'],
                    steps: ["Identify range.", "Use MAX function.", "Scan for highest value.", "98 is the maximum."]
                }
            },
            {
                type: 'Math',
                name: 'MIN',
                syntax: 'MIN(value1, [value2])',
                example: '=MIN(A1:A5)',
                desc: 'Returns the minimum value in a numeric dataset.',
                data: {
                    A1: 12, A2: 45, A3: 7, A4: 98, A5: 23,
                    target: 'A6',
                    formula: '=MIN(A1:A5)',
                    result: 7,
                    highlight: ['A1', 'A2', 'A3', 'A4', 'A5'],
                    steps: ["Identify range.", "Use MIN function.", "Scan for lowest value.", "7 is the minimum."]
                }
            },
            {
                type: 'Logical',
                name: 'IF',
                syntax: 'IF(expr, true_val, false_val)',
                example: '=IF(A1>10, "Pass", "Fail")',
                desc: 'Returns one value if TRUE and another if FALSE.',
                data: {
                    A1: 5, A2: 15, A3: 8,
                    target: 'B1',
                    formula: '=IF(A1>10, "Pass", "Fail")',
                    result: "Fail",
                    highlight: ['A1'],
                    steps: ["Check if A1 (5) > 10.", "Condition is False.", "Return second argument.", "Result is 'Fail'."]
                }
            },
            {
                type: 'Text',
                name: 'ARABIC',
                syntax: 'ARABIC(roman_numeral)',
                example: '=ARABIC("XIV")',
                desc: 'Computes the value of a Roman numeral.',
                data: {
                    A1: "XIV",
                    target: 'B1',
                    formula: '=ARABIC(A1)',
                    result: 14,
                    highlight: ['A1'],
                    steps: ["Read Roman Numeral 'XIV'.", "X=10, IV=4.", "Add values.", "Result is 14."]
                }
            },
            {
                type: 'Text',
                name: 'ASC',
                syntax: 'ASC(text)',
                example: '=ASC("Ｅｘｃｅｌ")',
                desc: 'Converts full-width ASCII and katakana characters to their half-width counterparts.',
                data: {
                    A1: "Ｅｘｃｅｌ",
                    target: 'B1',
                    formula: '=ASC(A1)',
                    result: "Excel",
                    highlight: ['A1'],
                    steps: ["Read full-width text.", "Convert to half-width.", "Result is 'Excel'."]
                }
            },
            {
                type: 'Text',
                name: 'CHAR',
                syntax: 'CHAR(number)',
                example: '=CHAR(65)',
                desc: 'Convert a number into a character according to the current Unicode table.',
                data: {
                    A1: 65,
                    target: 'B1',
                    formula: '=CHAR(A1)',
                    result: "A",
                    highlight: ['A1'],
                    steps: ["Read Unicode 65.", "Map to character.", "Result is 'A'."]
                }
            },
            {
                type: 'Text',
                name: 'CLEAN',
                syntax: 'CLEAN(text)',
                example: '=CLEAN(A1)',
                desc: 'Returns the text with the non-printable ASCII characters removed.',
                data: {
                    A1: "Hi" + String.fromCharCode(7) + "There",
                    target: 'B1',
                    formula: '=CLEAN(A1)',
                    result: "HiThere",
                    highlight: ['A1'],
                    steps: ["Scan text.", "Remove non-printable char (7).", "Result clean string."]
                }
            },
            {
                type: 'Text',
                name: 'CODE',
                syntax: 'CODE(string)',
                example: '=CODE("A")',
                desc: 'Returns the numeric Unicode map value of the first character in the string provided.',
                data: {
                    A1: "A",
                    target: 'B1',
                    formula: '=CODE(A1)',
                    result: 65,
                    highlight: ['A1'],
                    steps: ["Read first char 'A'.", "Get Unicode value.", "Result is 65."]
                }
            },
            {
                type: 'Text',
                name: 'CONCATENATE',
                syntax: 'CONCATENATE(string1, [string2, ...])',
                example: '=CONCATENATE("Hi ", A1)',
                desc: 'Appends strings to one another.',
                data: {
                    A1: "John", A2: "Doe",
                    target: 'C1',
                    formula: '=CONCATENATE(A1, " ", A2)',
                    result: "John Doe",
                    highlight: ['A1', 'A2'],
                    steps: ["Take value in A1.", "Add a space.", "Add value in A2.", "Combine into one string."]
                }
            },
            {
                type: 'Text',
                name: 'DOLLAR',
                syntax: 'DOLLAR(number, [places])',
                example: '=DOLLAR(1234.567, 2)',
                desc: 'Formats a number into the locale-specific currency format.',
                data: {
                    A1: 1234.567,
                    target: 'B1',
                    formula: '=DOLLAR(A1, 2)',
                    result: "$1,234.57",
                    highlight: ['A1'],
                    steps: ["Read number.", "Round to 2 decimals.", "Add currency symbol.", "Format as string."]
                }
            },
            {
                type: 'Text',
                name: 'EXACT',
                syntax: 'EXACT(string1, string2)',
                example: '=EXACT("abc", "ABC")',
                desc: 'Tests whether two strings are identical.',
                data: {
                    A1: "abc", B1: "ABC",
                    target: 'C1',
                    formula: '=EXACT(A1, B1)',
                    result: "FALSE",
                    highlight: ['A1', 'B1'],
                    steps: ["Compare 'abc' and 'ABC'.", "Case-sensitive check.", "Strings match? No.", "Result is FALSE."]
                }
            },
            {
                type: 'Text',
                name: 'FIND',
                syntax: 'FIND(search_for, text, [start])',
                example: '=FIND("M", "Miriam")',
                desc: 'Returns the position at which a string is first found within text (Case-sensitive).',
                data: {
                    A1: "Miriam",
                    target: 'B1',
                    formula: '=FIND("m", A1)',
                    result: 6,
                    highlight: ['A1'],
                    steps: ["Search 'Miriam' for 'm'.", "Case sensitive.", "Found at index 6.", "Result is 6."]
                }
            },
            {
                type: 'Text',
                name: 'FINDB',
                syntax: 'FINDB(search_for, text, [start])',
                example: '=FINDB("M", "Miriam")',
                desc: 'Returns the position at which a string is first found within text counting each double-character as 2.',
                data: {
                    A1: "Hello",
                    target: 'B1',
                    formula: '=FINDB("e", A1)',
                    result: 2,
                    highlight: ['A1'],
                    steps: ["Index by bytes.", "e is at byte 2.", "Result is 2."]
                }
            },
            {
                type: 'Text',
                name: 'FIXED',
                syntax: 'FIXED(number, [places], [no_commas])',
                example: '=FIXED(3.14159, 2)',
                desc: 'Formats a number with a fixed number of decimal places.',
                data: {
                    A1: 3.14159,
                    target: 'B1',
                    formula: '=FIXED(A1, 2)',
                    result: "3.14",
                    highlight: ['A1'],
                    steps: ["Read number.", "Round to 2 places.", "Convert to text.", "Result '3.14'."]
                }
            },
            {
                type: 'Text',
                name: 'JOIN',
                syntax: 'JOIN(delimiter, array)',
                example: '=JOIN(", ", A1:A3)',
                desc: 'Concatenates the elements of one or more one-dimensional arrays using a specified delimiter.',
                data: {
                    A1: "A", A2: "B", A3: "C",
                    target: 'B1',
                    formula: '=JOIN("-", A1:A3)',
                    result: "A-B-C",
                    highlight: ['A1', 'A2', 'A3'],
                    steps: ["Take array A1:A3.", "Insert '-' between.", "Result 'A-B-C'."]
                }
            },
            {
                type: 'Text',
                name: 'LEFT',
                syntax: 'LEFT(string, [chars])',
                example: '=LEFT("Sales 2023", 5)',
                desc: 'Returns a substring from the beginning of a specified string.',
                data: {
                    A1: "Google",
                    target: 'B1',
                    formula: '=LEFT(A1, 1)',
                    result: "G",
                    highlight: ['A1'],
                    steps: ["Take string 'Google'.", "Extract first 1 char.", "Result 'G'."]
                }
            },
            {
                type: 'Text',
                name: 'LEFTB',
                syntax: 'LEFTB(string, [bytes])',
                example: '=LEFTB("Google", 1)',
                desc: 'Returns the left portion of a string up to a certain number of bytes.',
                data: {
                    A1: "Google",
                    target: 'B1',
                    formula: '=LEFTB(A1, 2)',
                    result: "Go",
                    highlight: ['A1'],
                    steps: ["Count 2 bytes from left.", "Standard chars are 1 byte.", "Return 'Go'."]
                }
            },
            {
                type: 'Text',
                name: 'LEN',
                syntax: 'LEN(text)',
                example: '=LEN("Hello")',
                desc: 'Returns the length of a string.',
                data: {
                    A1: "Hello",
                    target: 'B1',
                    formula: '=LEN(A1)',
                    result: 5,
                    highlight: ['A1'],
                    steps: ["Count characters.", "H-e-l-l-o", "Total 5 chars.", "Result is 5."]
                }
            },
            {
                type: 'Text',
                name: 'LENB',
                syntax: 'LENB(text)',
                example: '=LENB("Hello")',
                desc: 'Returns the length of a string in bytes.',
                data: {
                    A1: "Hello",
                    target: 'B1',
                    formula: '=LENB(A1)',
                    result: 5,
                    highlight: ['A1'],
                    steps: ["Count bytes.", "1 byte per char.", "Total 5 bytes."]
                }
            },
            {
                type: 'Text',
                name: 'LOWER',
                syntax: 'LOWER(text)',
                example: '=LOWER("HELLO")',
                desc: 'Converts a specified string to lowercase.',
                data: {
                    A1: "HELLO",
                    target: 'B1',
                    formula: '=LOWER(A1)',
                    result: "hello",
                    highlight: ['A1'],
                    steps: ["Read 'HELLO'.", "Convert char codes.", "Result 'hello'."]
                }
            },
            {
                type: 'Text',
                name: 'MID',
                syntax: 'MID(string, start, len)',
                example: '=MID("Fluid", 2, 3)',
                desc: 'Returns a segment of a string.',
                data: {
                    A1: "Fluid",
                    target: 'B1',
                    formula: '=MID(A1, 2, 3)',
                    result: "lui",
                    highlight: ['A1'],
                    steps: ["Start at pos 2 (l).", "Take 3 chars (l,u,i).", "Result 'lui'."]
                }
            },
            {
                type: 'Text',
                name: 'MIDB',
                syntax: 'MIDB(string, start, bytes)',
                example: '=MIDB("Fluid", 2, 3)',
                desc: 'Returns a segment of a string starting at a given character and up to a specified number of bytes.',
                data: {
                    A1: "Fluid",
                    target: 'B1',
                    formula: '=MIDB(A1, 2, 3)',
                    result: "lui",
                    highlight: ['A1'],
                    steps: ["Start byte 2.", "Extract 3 bytes.", "Result 'lui'."]
                }
            },
            {
                type: 'Text',
                name: 'PROPER',
                syntax: 'PROPER(text)',
                example: '=PROPER("this is a title")',
                desc: 'Capitalizes each word in a specified string.',
                data: {
                    A1: "john doe",
                    target: 'B1',
                    formula: '=PROPER(A1)',
                    result: "John Doe",
                    highlight: ['A1'],
                    steps: ["Find word boundaries.", "Capitalize first letters.", "Result 'John Doe'."]
                }
            },
            {
                type: 'Text',
                name: 'REGEXEXTRACT',
                syntax: 'REGEXEXTRACT(text, regex)',
                example: '=REGEXEXTRACT("My price is $50", "\\$([0-9]+)")',
                desc: 'Extracts matching substrings according to a regular expression.',
                data: {
                    A1: "SKU-123",
                    target: 'B1',
                    formula: '=REGEXEXTRACT(A1, "\\d+")',
                    result: "123",
                    highlight: ['A1'],
                    steps: ["Apply regex \\d+.", "Find digits.", "Extract '123'."]
                }
            },
            {
                type: 'Text',
                name: 'REGEXMATCH',
                syntax: 'REGEXMATCH(text, regex)',
                example: '=REGEXMATCH("Local", "Loc")',
                desc: 'Whether a piece of text matches a regular expression.',
                data: {
                    A1: "email@test.com",
                    target: 'B1',
                    formula: '=REGEXMATCH(A1, "@")',
                    result: "TRUE",
                    highlight: ['A1'],
                    steps: ["Check regex '@'.", "Symbol found.", "Return TRUE."]
                }
            },
            {
                type: 'Text',
                name: 'REGEXREPLACE',
                syntax: 'REGEXREPLACE(text, regex, replacement)',
                example: '=REGEXREPLACE("A1B2", "\\d", "")',
                desc: 'Replaces part of a text string with a different text string using regular expressions.',
                data: {
                    A1: "(555) 123-4567",
                    target: 'B1',
                    formula: '=REGEXREPLACE(A1, "\\D", "")',
                    result: "5551234567",
                    highlight: ['A1'],
                    steps: ["Find non-digits (\\D).", "Replace with empty.", "Result numbers only."]
                }
            },
            {
                type: 'Text',
                name: 'REPLACE',
                syntax: 'REPLACE(text, pos, len, new_text)',
                example: '=REPLACE("Google Sheets", 8, 6, "Docs")',
                desc: 'Replaces part of a text string with a different text string.',
                data: {
                    A1: "Google Sheets",
                    target: 'B1',
                    formula: '=REPLACE(A1, 8, 6, "Docs")',
                    result: "Google Docs",
                    highlight: ['A1'],
                    steps: ["Go to pos 8 (S).", "Remove 6 chars (Sheets).", "Insert 'Docs'.", "Result 'Google Docs'."]
                }
            },
            {
                type: 'Text',
                name: 'REPLACEB',
                syntax: 'REPLACEB(text, pos, bytes, new_text)',
                example: '=REPLACEB("Google", 1, 1, "D")',
                desc: 'Replaces part of a text string, based on a number of bytes.',
                data: {
                    A1: "ABC",
                    target: 'B1',
                    formula: '=REPLACEB(A1, 1, 1, "X")',
                    result: "XBC",
                    highlight: ['A1'],
                    steps: ["Byte 1 is 'A'.", "Replace 1 byte with 'X'.", "Result 'XBC'."]
                }
            },
            {
                type: 'Text',
                name: 'REPT',
                syntax: 'REPT(text, number)',
                example: '=REPT("*", 5)',
                desc: 'Returns specified text repeated a number of times.',
                data: {
                    A1: "*",
                    target: 'B1',
                    formula: '=REPT(A1, 3)',
                    result: "***",
                    highlight: ['A1'],
                    steps: ["Take string '*'.", "Repeat 3 times.", "Result '***'."]
                }
            },
            {
                type: 'Text',
                name: 'RIGHT',
                syntax: 'RIGHT(string, [chars])',
                example: '=RIGHT("Order 500", 3)',
                desc: 'Returns a substring from the end of a specified string.',
                data: {
                    A1: "Order-99",
                    target: 'B1',
                    formula: '=RIGHT(A1, 2)',
                    result: "99",
                    highlight: ['A1'],
                    steps: ["Start from end.", "Take 2 characters.", "Result '99'."]
                }
            },
            {
                type: 'Text',
                name: 'RIGHTB',
                syntax: 'RIGHTB(string, [bytes])',
                example: '=RIGHTB("Order", 1)',
                desc: 'Returns the right portion of a string up to a certain number of bytes.',
                data: {
                    A1: "ABC",
                    target: 'B1',
                    formula: '=RIGHTB(A1, 1)',
                    result: "C",
                    highlight: ['A1'],
                    steps: ["Take 1 byte from right.", "Result 'C'."]
                }
            },
            {
                type: 'Text',
                name: 'ROMAN',
                syntax: 'ROMAN(number, [form])',
                example: '=ROMAN(499)',
                desc: 'Formats a number in Roman numerals.',
                data: {
                    A1: 14,
                    target: 'B1',
                    formula: '=ROMAN(A1)',
                    result: "XIV",
                    highlight: ['A1'],
                    steps: ["Number 14.", "10=X, 4=IV.", "Combine.", "Result 'XIV'."]
                }
            },
            {
                type: 'Text',
                name: 'SEARCH',
                syntax: 'SEARCH(search_for, text, [start])',
                example: '=SEARCH("Market", "Stock Market")',
                desc: 'Returns the position at which a string is first found within text (case-insensitive).',
                data: {
                    A1: "Stock market",
                    target: 'B1',
                    formula: '=SEARCH("Market", A1)',
                    result: 7,
                    highlight: ['A1'],
                    steps: ["Find 'Market'.", "Ignore case.", "Found at pos 7.", "Result 7."]
                }
            },
            {
                type: 'Text',
                name: 'SEARCHB',
                syntax: 'SEARCHB(search_for, text, [start])',
                example: '=SEARCHB("m", "market")',
                desc: 'Returns position of string counting double-character as 2.',
                data: {
                    A1: "market",
                    target: 'B1',
                    formula: '=SEARCHB("m", A1)',
                    result: 1,
                    highlight: ['A1'],
                    steps: ["Find 'm'.", "Byte index 1.", "Result 1."]
                }
            },
            {
                type: 'Text',
                name: 'SPLIT',
                syntax: 'SPLIT(text, delimiter)',
                example: '=SPLIT("Hello,World", ",")',
                desc: 'Divides text around a specified character or string.',
                data: {
                    A1: "John,Doe",
                    target: 'B1',
                    formula: '=SPLIT(A1, ",")',
                    result: "John",
                    highlight: ['A1'],
                    steps: ["Read 'John,Doe'.", "Found ',' separator.", "Split into B1, C1.", "Result spills."]
                }
            },
            {
                type: 'Text',
                name: 'SUBSTITUTE',
                syntax: 'SUBSTITUTE(text, old, new, [occurrence])',
                example: '=SUBSTITUTE("Good morning", "morning", "night")',
                desc: 'Replaces existing text with new text in a string.',
                data: {
                    A1: "1-800-GO-FED",
                    target: 'B1',
                    formula: '=SUBSTITUTE(A1, "-", " ")',
                    result: "1 800 GO FED",
                    highlight: ['A1'],
                    steps: ["Find all '-'.", "Replace with space.", "Result updated string."]
                }
            },
            {
                type: 'Text',
                name: 'T',
                syntax: 'T(value)',
                example: '=T(value)',
                desc: 'Returns string arguments as text.',
                data: {
                    A1: 123,
                    target: 'B1',
                    formula: '=T(A1)',
                    result: "",
                    highlight: ['A1'],
                    steps: ["Check type of A1.", "It is number.", "Return empty string.", "Only returns text."]
                }
            },
            {
                type: 'Text',
                name: 'TEXT',
                syntax: 'TEXT(number, format)',
                example: '=TEXT(1234.5, "$0.00")',
                desc: 'Converts a number into text according to a specified format.',
                data: {
                    A1: 0.5,
                    target: 'B1',
                    formula: '=TEXT(A1, "0%")',
                    result: "50%",
                    highlight: ['A1'],
                    steps: ["Read 0.5.", "Apply '0%' format.", "Convert to string.", "Result '50%'."]
                }
            },
            {
                type: 'Text',
                name: 'TRIM',
                syntax: 'TRIM(text)',
                example: '=TRIM("  Hello  ")',
                desc: 'Removes leading and trailing spaces in a specified string.',
                data: {
                    A1: "  Hello  ",
                    target: 'B1',
                    formula: '=TRIM(A1)',
                    result: "Hello",
                    highlight: ['A1'],
                    steps: ["Read string.", "Strip start spaces.", "Strip end spaces.", "Result 'Hello'."]
                }
            },
            {
                type: 'Text',
                name: 'UNICHAR',
                syntax: 'UNICHAR(number)',
                example: '=UNICHAR(65)',
                desc: 'Returns the Unicode character for a number.',
                data: {
                    A1: 9731,
                    target: 'B1',
                    formula: '=UNICHAR(A1)',
                    result: "☃",
                    highlight: ['A1'],
                    steps: ["Code point 9731.", "Look up Unicode.", "Snowman char.", "Result '☃'."]
                }
            },
            {
                type: 'Text',
                name: 'UNICODE',
                syntax: 'UNICODE(text)',
                example: '=UNICODE("A")',
                desc: 'Returns the decimal Unicode value of the first character of the text.',
                data: {
                    A1: "☃",
                    target: 'B1',
                    formula: '=UNICODE(A1)',
                    result: 9731,
                    highlight: ['A1'],
                    steps: ["Read char '☃'.", "Get Unicode value.", "Result 9731."]
                }
            },
            {
                type: 'Text',
                name: 'UPPER',
                syntax: 'UPPER(text)',
                example: '=UPPER("hello")',
                desc: 'Converts a specified string to uppercase.',
                data: {
                    A1: "hello",
                    target: 'B1',
                    formula: '=UPPER(A1)',
                    result: "HELLO",
                    highlight: ['A1'],
                    steps: ["Read 'hello'.", "Convert char codes.", "Result 'HELLO'."]
                }
            },
            {
                type: 'Text',
                name: 'VALUE',
                syntax: 'VALUE(text)',
                example: '=VALUE("$1,000")',
                desc: 'Converts a string in any of the date, time or number formats that Google Sheets understands into a number.',
                data: {
                    A1: "$123",
                    target: 'B1',
                    formula: '=VALUE(A1)',
                    result: 123,
                    highlight: ['A1'],
                    steps: ["Parse string.", "Remove currency.", "Convert to number.", "Result 123."]
                }
            },
            {
                type: 'Date',
                name: 'DATE',
                syntax: 'DATE(year, month, day)',
                example: '=DATE(2023, 12, 25)',
                desc: 'Converts a provided year, month, and day into a date.',
                data: {
                    A1: 2023, A2: 12, A3: 25,
                    target: 'B1',
                    formula: '=DATE(A1, A2, A3)',
                    result: "12/25/2023",
                    highlight: ['A1', 'A2', 'A3'],
                    steps: ["Take Year 2023.", "Take Month 12.", "Take Day 25.", "Result '12/25/2023'."]
                }
            },
            {
                type: 'Date',
                name: 'DATEDIF',
                syntax: 'DATEDIF(start, end, unit)',
                example: '=DATEDIF("2023-01-01", "2023-12-31", "D")',
                desc: 'Calculates the number of days, months, or years between two dates.',
                data: {
                    A1: "1/1/2023", B1: "1/1/2024",
                    target: 'C1',
                    formula: '=DATEDIF(A1, B1, "Y")',
                    result: 1,
                    highlight: ['A1', 'B1'],
                    steps: ["Start: 1/1/2023.", "End: 1/1/2024.", "Diff in Years.", "Result 1."]
                }
            },
            {
                type: 'Date',
                name: 'DATEVALUE',
                syntax: 'DATEVALUE(date_string)',
                example: '=DATEVALUE("1/1/2024")',
                desc: 'Converts a provided date string in a known format to a date value.',
                data: {
                    A1: "25-Dec-2023",
                    target: 'B1',
                    formula: '=DATEVALUE(A1)',
                    result: 45285,
                    highlight: ['A1'],
                    steps: ["Read '25-Dec-2023'.", "Convert to serial number.", "Result 45285."]
                }
            },
            {
                type: 'Date',
                name: 'DAY',
                syntax: 'DAY(date)',
                example: '=DAY("2023-10-15")',
                desc: 'Returns the day of the month that a specific date falls on.',
                data: {
                    A1: "10/15/2023",
                    target: 'B1',
                    formula: '=DAY(A1)',
                    result: 15,
                    highlight: ['A1'],
                    steps: ["Read date.", "Extract day part.", "Result 15."]
                }
            },
            {
                type: 'Date',
                name: 'DAYS',
                syntax: 'DAYS(end_date, start_date)',
                example: '=DAYS("2024-01-01", "2023-12-01")',
                desc: 'Returns the number of days between two dates.',
                data: {
                    A1: "1/1/2024", B1: "12/1/2023",
                    target: 'C1',
                    formula: '=DAYS(A1, B1)',
                    result: 31,
                    highlight: ['A1', 'B1'],
                    steps: ["End - Start.", "31 days diff.", "Result 31."]
                }
            },
            {
                type: 'Date',
                name: 'DAYS360',
                syntax: 'DAYS360(start_date, end_date, [method])',
                example: '=DAYS360("1/1/2023", "1/1/2024")',
                desc: 'Returns the difference between two days based on the 360 day year.',
                data: {
                    A1: "1/1/2023", B1: "1/1/2024",
                    target: 'C1',
                    formula: '=DAYS360(A1, B1)',
                    result: 360,
                    highlight: ['A1', 'B1'],
                    steps: ["Assume 30-day months.", "12 * 30 = 360.", "Result 360."]
                }
            },
            {
                type: 'Date',
                name: 'EDATE',
                syntax: 'EDATE(start_date, months)',
                example: '=EDATE("2023-01-15", 1)',
                desc: 'Returns a date a specified number of months before or after another date.',
                data: {
                    A1: "1/15/2023",
                    target: 'B1',
                    formula: '=EDATE(A1, 1)',
                    result: "2/15/2023",
                    highlight: ['A1'],
                    steps: ["Start 1/15.", "Add 1 month.", "Result 2/15/2023."]
                }
            },
            {
                type: 'Date',
                name: 'EOMONTH',
                syntax: 'EOMONTH(start_date, months)',
                example: '=EOMONTH("2023-02-15", 0)',
                desc: 'Returns a date representing the last day of a month.',
                data: {
                    A1: "2/15/2023",
                    target: 'B1',
                    formula: '=EOMONTH(A1, 0)',
                    result: "2/28/2023",
                    highlight: ['A1'],
                    steps: ["Current month Feb.", "Find last day.", "Result 2/28/2023."]
                }
            },
            {
                type: 'Date',
                name: 'EPOCHTODATE',
                syntax: 'EPOCHTODATE(timestamp)',
                example: '=EPOCHTODATE(1700000000)',
                desc: 'Converts a Unix epoch timestamp to a datetime in UTC.',
                data: {
                    A1: 1700000000,
                    target: 'B1',
                    formula: '=EPOCHTODATE(A1)',
                    result: "11/14/2023",
                    highlight: ['A1'],
                    steps: ["Read timestamp.", "Convert to date.", "Result 11/14/2023."]
                }
            },
            {
                type: 'Date',
                name: 'HOUR',
                syntax: 'HOUR(time)',
                example: '=HOUR("10:30 PM")',
                desc: 'Returns the hour component of a specific time, in numeric format.',
                data: {
                    A1: "10:30 PM",
                    target: 'B1',
                    formula: '=HOUR(A1)',
                    result: 22,
                    highlight: ['A1'],
                    steps: ["Read time.", "Extract hour (24h).", "Result 22."]
                }
            },
            {
                type: 'Date',
                name: 'ISOWEEKNUM',
                syntax: 'ISOWEEKNUM(date)',
                example: '=ISOWEEKNUM("2024-01-01")',
                desc: 'Returns the number of the ISO week of the year.',
                data: {
                    A1: "1/1/2024",
                    target: 'B1',
                    formula: '=ISOWEEKNUM(A1)',
                    result: 1,
                    highlight: ['A1'],
                    steps: ["Date 1/1/2024.", "Calculate ISO week.", "Result 1."]
                }
            },
            {
                type: 'Date',
                name: 'MINUTE',
                syntax: 'MINUTE(time)',
                example: '=MINUTE("10:45")',
                desc: 'Returns the minute component of a specific time.',
                data: {
                    A1: "10:45",
                    target: 'B1',
                    formula: '=MINUTE(A1)',
                    result: 45,
                    highlight: ['A1'],
                    steps: ["Read time.", "Extract minute.", "Result 45."]
                }
            },
            {
                type: 'Date',
                name: 'MONTH',
                syntax: 'MONTH(date)',
                example: '=MONTH("2023-03-15")',
                desc: 'Returns the month of the year a specific date falls in.',
                data: {
                    A1: "3/15/2023",
                    target: 'B1',
                    formula: '=MONTH(A1)',
                    result: 3,
                    highlight: ['A1'],
                    steps: ["Read date.", "Extract month.", "Result 3."]
                }
            },
            {
                type: 'Date',
                name: 'NETWORKDAYS',
                syntax: 'NETWORKDAYS(start, end, [holidays])',
                example: '=NETWORKDAYS("2024-01-01", "2024-01-10")',
                desc: 'Returns the number of net working days between two provided days.',
                data: {
                    A1: "1/1/24 (Mon)", B1: "1/8/24 (Mon)",
                    target: 'C1',
                    formula: '=NETWORKDAYS(A1, B1)',
                    result: 6,
                    highlight: ['A1', 'B1'],
                    steps: ["Count Mon-Fri.", "Excl weekends.", "Days: 1,2,3,4,5,8.", "Result 6."]
                }
            },
            {
                type: 'Date',
                name: 'NETWORKDAYS.INTL',
                syntax: 'NETWORKDAYS.INTL(start, end, [wknd])',
                example: '=NETWORKDAYS.INTL(A1, B1, 1)',
                desc: 'Returns net working days excluding specified weekend days.',
                data: {
                    A1: "1/1/24", B1: "1/8/24",
                    target: 'C1',
                    formula: '=NETWORKDAYS.INTL(A1,B1,11)',
                    result: 7,
                    highlight: ['A1', 'B1'],
                    steps: ["Sunday only weekend.", "Count days.", "Result 7."]
                }
            },
            {
                type: 'Date',
                name: 'NOW',
                syntax: 'NOW()',
                example: '=NOW()',
                desc: 'Returns the current date and time as a date value.',
                data: {
                    target: 'A1',
                    formula: '=NOW()',
                    result: new Date().toLocaleString(),
                    steps: ["Get system time.", "Format date+time.", "Display result."]
                }
            },
            {
                type: 'Date',
                name: 'SECOND',
                syntax: 'SECOND(time)',
                example: '=SECOND("10:45:30")',
                desc: 'Returns the second component of a specific time.',
                data: {
                    A1: "10:45:30",
                    target: 'B1',
                    formula: '=SECOND(A1)',
                    result: 30,
                    highlight: ['A1'],
                    steps: ["Read time.", "Extract seconds.", "Result 30."]
                }
            },
            {
                type: 'Date',
                name: 'TIME',
                syntax: 'TIME(hour, minute, second)',
                example: '=TIME(14, 30, 0)',
                desc: 'Converts a provided hour, minute, and second into a time.',
                data: {
                    A1: 14, A2: 30, A3: 0,
                    target: 'B1',
                    formula: '=TIME(A1, A2, A3)',
                    result: "2:30 PM",
                    highlight: ['A1', 'A2', 'A3'],
                    steps: ["Hour 14.", "Minute 30.", "Result 2:30 PM."]
                }
            },
            {
                type: 'Date',
                name: 'TIMEVALUE',
                syntax: 'TIMEVALUE(time_string)',
                example: '=TIMEVALUE("2:30 PM")',
                desc: 'Returns the fraction of a 24-hour day the time represents.',
                data: {
                    A1: "6:00 AM",
                    target: 'B1',
                    formula: '=TIMEVALUE(A1)',
                    result: 0.25,
                    highlight: ['A1'],
                    steps: ["6 hours / 24.", "Result 0.25."]
                }
            },
            {
                type: 'Date',
                name: 'TODAY',
                syntax: 'TODAY()',
                example: '=TODAY()',
                desc: 'Returns the current date as a date value.',
                data: {
                    target: 'B1',
                    formula: '=TODAY()',
                    result: new Date().toLocaleDateString(),
                    steps: ["Select cell.", "Type =TODAY().", "No arguments needed.", "Current date appears."]
                }
            },
            {
                type: 'Date',
                name: 'WEEKDAY',
                syntax: 'WEEKDAY(date, [type])',
                example: '=WEEKDAY("2023-10-15")',
                desc: 'Returns a number representing the day of the week of the date provided.',
                data: {
                    A1: "10/15/23 (Sun)",
                    target: 'B1',
                    formula: '=WEEKDAY(A1)',
                    result: 1,
                    highlight: ['A1'],
                    steps: ["Read date.", "Identify Sunday.", "Default (1=Sun).", "Result 1."]
                }
            },
            {
                type: 'Date',
                name: 'WEEKNUM',
                syntax: 'WEEKNUM(date, [type])',
                example: '=WEEKNUM("2023-10-15")',
                desc: 'Returns a number representing the week of the year.',
                data: {
                    A1: "1/8/2023",
                    target: 'B1',
                    formula: '=WEEKNUM(A1)',
                    result: 2,
                    highlight: ['A1'],
                    steps: ["Date 1/8.", "Week 2 of year.", "Result 2."]
                }
            },
            {
                type: 'Date',
                name: 'WORKDAY',
                syntax: 'WORKDAY(start, days, [holidays])',
                example: '=WORKDAY("2024-01-01", 5)',
                desc: 'Calculates the end date after a specified number of working days.',
                data: {
                    A1: "1/1/24 (Mon)",
                    target: 'B1',
                    formula: '=WORKDAY(A1, 5)',
                    result: "1/8/2024",
                    highlight: ['A1'],
                    steps: ["Start Mon.", "Add 5 work days.", "Skip Sat/Sun.", "Result Mon 1/8."]
                }
            },
            {
                type: 'Date',
                name: 'WORKDAY.INTL',
                syntax: 'WORKDAY.INTL(start, days, [wknd])',
                example: '=WORKDAY.INTL(A1, 5, 1)',
                desc: 'Calculates the date after a specified number of workdays excluding specified weekend days.',
                data: {
                    A1: "1/1/24",
                    target: 'B1',
                    formula: '=WORKDAY.INTL(A1, 5, 11)',
                    result: "1/6/2024",
                    highlight: ['A1'],
                    steps: ["Add 5 days.", "Sun only weekend.", "Result 1/6/2024."]
                }
            },
            {
                type: 'Date',
                name: 'YEAR',
                syntax: 'YEAR(date)',
                example: '=YEAR("2023-10-15")',
                desc: 'Returns the year specified by a given date.',
                data: {
                    A1: "10/15/2023",
                    target: 'B1',
                    formula: '=YEAR(A1)',
                    result: 2023,
                    highlight: ['A1'],
                    steps: ["Read date.", "Extract year.", "Result 2023."]
                }
            },
            {
                type: 'Date',
                name: 'YEARFRAC',
                syntax: 'YEARFRAC(start, end, [basis])',
                example: '=YEARFRAC("1/1/23", "7/1/23")',
                desc: 'Returns the number of years, including fractional years, between two dates.',
                data: {
                    A1: "1/1/2023", B1: "7/1/2023",
                    target: 'C1',
                    formula: '=YEARFRAC(A1, B1)',
                    result: 0.5,
                    highlight: ['A1', 'B1'],
                    steps: ["Diff ~6 months.", "Half a year.", "Result 0.5."]
                }
            },

            // --- NEW ADDITIONS ---
            {
                type: 'Lookup',
                name: 'VLOOKUP',
                syntax: 'VLOOKUP(key, range, index, [sorted])',
                example: '=VLOOKUP(102, A2:B4, 2, FALSE)',
                desc: 'Vertical lookup. Searches down the first column of a range for a key and returns the value of a specified cell in the row found.',
                data: {
                    A1: "ID", B1: "Name",
                    A2: "101", B2: "Alice",
                    A3: "102", B3: "Bob",
                    A4: "103", B4: "Charlie",
                    C1: "Search:", C2: "102",
                    target: 'D2',
                    formula: '=VLOOKUP(C2, A2:B4, 2, 0)',
                    result: "Bob",
                    highlight: ['C2', 'A2', 'A3', 'A4', 'B2', 'B3', 'B4'],
                    steps: [
                        "Look for value in C2 (102).",
                        "Search in column A.",
                        "Match found at row 3.",
                        "Return value from col 2 (Name)."
                    ]
                }
            },
            {
                type: 'Lookup',
                name: 'XLOOKUP',
                syntax: 'XLOOKUP(key, lookup_rg, result_rg, ...)',
                example: '=XLOOKUP(103, A:A, B:B)',
                desc: 'Modern replacement for VLOOKUP. Returns values in the result range based on the position where a match was found.',
                data: {
                    A1: "ID", B1: "Dept",
                    A2: "101", B2: "HR",
                    A3: "103", B3: "IT",
                    C1: "ID:", C2: "103",
                    target: 'D2',
                    formula: '=XLOOKUP(C2, A2:A3, B2:B3)',
                    result: "IT",
                    highlight: ['C2', 'A2', 'A3', 'B2', 'B3'],
                    steps: ["Find 103 in A2:A3.", "Locate position (2nd item).", "Get 2nd item from B2:B3.", "Result is 'IT'."]
                }
            },
            {
                type: 'Statistical',
                name: 'COUNTIF',
                syntax: 'COUNTIF(range, criterion)',
                example: '=COUNTIF(A1:A5, "Apple")',
                desc: 'Returns a conditional count across a range.',
                data: {
                    A1: "Apple", A2: "Banana", A3: "Apple", A4: "Orange",
                    target: 'B1',
                    formula: '=COUNTIF(A1:A4, "Apple")',
                    result: 2,
                    highlight: ['A1', 'A3'],
                    steps: ["Scan range A1:A4.", "Check for 'Apple'.", "Count matches.", "Found 2 instances."]
                }
            },
            {
                type: 'Filter',
                name: 'UNIQUE',
                syntax: 'UNIQUE(range)',
                example: '=UNIQUE(A1:A10)',
                desc: 'Returns unique rows in the provided source range, discarding duplicates. Rows are returned in the order in which they first appear in the source range. Learn more',
                data: {
                    A1: "Red", A2: "Blue", A3: "Red", A4: "Green",
                    target: 'B1',
                    formula: '=UNIQUE(A1:A4)',
                    result: "Red",
                    highlight: ['A1', 'A2', 'A3', 'A4'],
                    steps: ["Analyze range A1:A4.", "Identify duplicates.", "Filter list.", "Returns clean list (spills)."]
                }
            },
            {
                type: 'Filter',
                name: 'FILTER',
                syntax: 'FILTER(range, condition1, [condition2])',
                example: '=FILTER(A1:A5, B1:B5>100)',
                desc: 'Returns a filtered version of the source range, returning only rows or columns which meet the specified conditions.',
                data: {
                    A1: "A", B1: 50,
                    A2: "B", B2: 150,
                    A3: "C", B3: 200,
                    target: 'C1',
                    formula: '=FILTER(A1:A3, B1:B3>100)',
                    result: "{B; C}",
                    highlight: ['A1', 'A2', 'A3', 'B1', 'B2', 'B3'],
                    steps: ["Check B1 (50) > 100? No.", "Check B2 (150) > 100? Yes.", "Check B3 (200) > 100? Yes.", "Returns {B; C}."]
                }
            },
            {
                type: 'Filter',
                name: 'SORT',
                syntax: 'SORT(range, sort_column, is_ascending, [sort_column2], [is_ascending2])',
                example: '=SORT(A1:B5, 1, TRUE)',
                desc: 'Sorts the rows of a given array or range by the values in one or more columns.',
                data: {
                    A1: 3, B1: "C",
                    A2: 1, B2: "A",
                    A3: 2, B3: "B",
                    target: 'C1',
                    formula: '=SORT(A1:B3, 1, TRUE)',
                    result: "{1; 2; 3}",
                    highlight: ['A1', 'A2', 'A3', 'B1', 'B2', 'B3'],
                    steps: ["Select range A1:B3.", "Sort by Col 1 (Ascending).", "Reorder rows: 2, 3, 1 -> 1, 2, 3.", "Spills result."]
                }
            },
            {
                type: 'Filter',
                name: 'SORTN',
                syntax: 'SORTN(range, [n], [ties_mode], [sort_col, asc], ...)',
                example: '=SORTN(A1:A5, 2, 0, 1, TRUE)',
                desc: 'Returns the first n items in a data set after performing a sort.',
                data: {
                    A1: 10,
                    A2: 5,
                    A3: 20,
                    A4: 8,
                    target: 'B1',
                    formula: '=SORTN(A1:A4, 2, 0)',
                    result: "{5; 8}",
                    highlight: ['A1', 'A2', 'A3', 'A4'],
                    steps: ["Sort range: 5, 8, 10, 20.", "Take top 2 items.", "Result {5; 8}.", "Spills result."]
                }
            },
            {
                type: 'Google',
                name: 'SPARKLINE',
                syntax: 'SPARKLINE(data, [options])',
                example: '=SPARKLINE(A1:E1)',
                desc: 'Creates a miniature chart contained within a single cell.',
                data: {
                    A1: 10, B1: 30, C1: 15, D1: 50,
                    target: 'E1',
                    formula: '=SPARKLINE(A1:D1)',
                    result: "📈",
                    highlight: ['A1', 'B1', 'C1', 'D1'],
                    steps: ["Select data range.", "Generate SVG chart.", "Embed in cell E1.", "Visual trend created."]
                }
            },
            {
                type: 'Google',
                name: 'GOOGLEFINANCE',
                syntax: 'GOOGLEFINANCE(ticker, [attr])',
                example: '=GOOGLEFINANCE("GOOG", "price")',
                desc: 'Fetches current or historical securities information from Google Finance.',
                data: {
                    target: 'B2',
                    formula: '=GOOGLEFINANCE("GOOG")',
                    result: "$175.50",
                    steps: ["Connect to Finance API.", "Query ticker 'GOOG'.", "Fetch current price.", "Display real-time value."]
                }
            },


            {
                type: 'Array',
                name: 'ARRAY_CONSTRAIN',
                syntax: 'ARRAY_CONSTRAIN(input, rows, cols)',
                example: '=ARRAY_CONSTRAIN(A1:B3, 2, 1)',
                desc: 'Constrains an array result to a specified size.',
                data: {
                    A1: "XR", B1: "YR",
                    A2: "XG", B2: "YG",
                    A3: "XB", B3: "YB",
                    target: 'D1',
                    formula: '=ARRAY_CONSTRAIN(A1:B3, 2, 1)',
                    result: "XR",
                    highlight: ['A1', 'A2', 'B1', 'B2', 'B3'], // broad Highlight
                    steps: ["Select source range.", "Limit to 2 rows.", "Limit to 1 column.", "Result is constrained."]
                }
            },
            {
                type: 'Array',
                name: 'BYCOL',
                syntax: 'BYCOL(array, LAMBDA)',
                example: '=BYCOL(A1:C1, LAMBDA(c, MAX(c)))',
                desc: 'Groups an array by columns by application of a LAMBDA function to each column.',
                data: {
                    A1: 10, B1: 50, C1: 30,
                    target: 'A3',
                    formula: '=BYCOL(A1:C1, LAMBDA(c, MAX(c)))',
                    result: "10...",
                    highlight: ['A1', 'B1', 'C1'],
                    steps: ["Scan col A, B, C.", "Apply MAX to each.", "Result: 10, 50, 30.", "Spills across row."]
                }
            },
            {
                type: 'Array',
                name: 'BYROW',
                syntax: 'BYROW(array, LAMBDA)',
                example: '=BYROW(A1:B2, LAMBDA(r, SUM(r)))',
                desc: 'Groups an array by rows by application of a LAMBDA function to each row.',
                data: {
                    A1: 1, B1: 2,
                    A2: 3, B2: 4,
                    target: 'D1',
                    formula: '=BYROW(A1:B2, LAMBDA(r, SUM(r)))',
                    result: "3...",
                    highlight: ['A1', 'B1', 'A2', 'B2'],
                    steps: ["Row 1 Sum: 1+2=3.", "Row 2 Sum: 3+4=7.", "Return array {3;7}.", "Spills Down."]
                }
            },
            {
                type: 'Array',
                name: 'CHOOSECOLS',
                syntax: 'CHOOSECOLS(array, col1, [col2])',
                example: '=CHOOSECOLS(A1:C3, 1, 3)',
                desc: 'Creates a new array from the selected columns in the existing range.',
                data: {
                    A1: "A", B1: "B", C1: "C",
                    A2: "D", B2: "E", C2: "F",
                    target: 'A4',
                    formula: '=CHOOSECOLS(A1:C2, 1, 3)',
                    result: "A...",
                    highlight: ['A1', 'A2', 'C1', 'C2'],
                    steps: ["Select col 1 (A,D).", "Select col 3 (C,F).", "Combine.", "Result spills."]
                }
            },
            {
                type: 'Array',
                name: 'CHOOSEROWS',
                syntax: 'CHOOSEROWS(array, row1, [row2])',
                example: '=CHOOSEROWS(A1:C3, 1, 3)',
                desc: 'Creates a new array from the selected rows in the existing range.',
                data: {
                    A1: "X", A2: "Y", A3: "Z",
                    target: 'C1',
                    formula: '=CHOOSEROWS(A1:A3, 1, 3)',
                    result: "X...",
                    highlight: ['A1', 'A3'],
                    steps: ["Select row 1 (X).", "Select row 3 (Z).", "Combine.", "Result spills."]
                }
            },
            {
                type: 'Array',
                name: 'FLATTEN',
                syntax: 'FLATTEN(range1, [range2])',
                example: '=FLATTEN(A1:B2)',
                desc: 'Flattens all the values from one or more ranges into a single column.',
                data: {
                    A1: 1, B1: 2,
                    A2: 3, B2: 4,
                    target: 'C1',
                    formula: '=FLATTEN(A1:B2)',
                    result: "1...",
                    highlight: ['A1', 'B1', 'A2', 'B2'],
                    steps: ["Read Row 1: 1, 2.", "Read Row 2: 3, 4.", "Stack vertically.", "Result: 1,2,3,4."]
                }
            },
            {
                type: 'Array',
                name: 'FREQUENCY',
                syntax: 'FREQUENCY(data, classes)',
                example: '=FREQUENCY(A1:A5, B1:B2)',
                desc: 'Calculates the frequency distribution of a one-column array into specified classes.',
                data: {
                    A1: 10, A2: 25, A3: 8, A4: 30, B1: 20,
                    target: 'C1',
                    formula: '=FREQUENCY(A1:A4, B1)',
                    result: "2...",
                    highlight: ['A1', 'A2', 'A3', 'A4', 'B1'],
                    steps: ["Bin <= 20: 10, 8 (2).", "Bin > 20: 25, 30 (2).", "Return {2; 2}.", "Spills result."]
                }
            },
            {
                type: 'Array',
                name: 'GROWTH',
                syntax: 'GROWTH(y, [x], [new_x], [b])',
                example: '=GROWTH(B1:B3, A1:A3, 4)',
                desc: 'Fits an ideal exponential growth trend and/or predicts further values.',
                data: {
                    A1: 1, B1: 2, A2: 2, B2: 4, A3: 3, B3: 8,
                    target: 'C1',
                    formula: '=GROWTH(B1:B3, A1:A3, 4)',
                    result: 16,
                    highlight: ['A1', 'B1', 'A2', 'B2', 'A3', 'B3'],
                    steps: ["Analyze exponential trend.", "Predict for x=4.", "Pattern is 2^x.", "Result is 16."]
                }
            },
            {
                type: 'Array',
                name: 'HSTACK',
                syntax: 'HSTACK(range1, [range2])',
                example: '=HSTACK(A1:A2, B1:B2)',
                desc: 'Appends ranges horizontally and in sequence to return a larger array.',
                data: {
                    A1: "A", A2: "B",
                    B1: "1", B2: "2",
                    target: 'C1',
                    formula: '=HSTACK(A1:A2, B1:B2)',
                    result: "A 1...",
                    highlight: ['A1', 'A2', 'B1', 'B2'],
                    steps: ["Take range A1:A2.", "Take range B1:B2.", "Stack side-by-side.", "Result spills: A,1 / B,2."]
                }
            },
            {
                type: 'Array',
                name: 'LINEST',
                syntax: 'LINEST(y, [x], [calc_b], [verbose])',
                example: '=LINEST(B1:B3, A1:A3)',
                desc: 'Calculates various parameters about the ideal linear trend using least-squares.',
                data: {
                    A1: 1, B1: 2, A2: 2, B2: 4, A3: 3, B3: 6,
                    target: 'C1',
                    formula: '=LINEST(B1:B3, A1:A3)',
                    result: "2 (m)...",
                    highlight: ['A1', 'B1', 'A2', 'B2', 'A3', 'B3'],
                    steps: ["Analyze linear data.", "Calculate slope (m) and intercept (b).", "y = 2x + 0.", "Returns slope 2."]
                }
            },
            {
                type: 'Array',
                name: 'LOGEST',
                syntax: 'LOGEST(y, [x], [b], [verbose])',
                example: '=LOGEST(B1:B3, A1:A3)',
                desc: 'Calculates various parameters about the best fit ideal exponential growth curve.',
                data: {
                    A1: 1, B1: 2, A2: 2, B2: 4, A3: 3, B3: 8,
                    target: 'C1',
                    formula: '=LOGEST(B1:B3, A1:A3)',
                    result: "2 (b)...",
                    highlight: ['A1', 'B1', 'A2', 'B2', 'A3', 'B3'],
                    steps: ["Analyze exponential data.", "Calculate curve parameters.", "Base is 2.", "Returns base."]
                }
            },
            {
                type: 'Array',
                name: 'MAKEARRAY',
                syntax: 'MAKEARRAY(rows, cols, LAMBDA)',
                example: '=MAKEARRAY(2, 2, LAMBDA(r,c, r+c))',
                desc: 'Returns an array of specified dimensions with values calculated by LAMBDA.',
                data: {
                    target: 'A1',
                    formula: '=MAKEARRAY(2,2,LAMBDA(r,c,r+c))',
                    result: "2,3...",
                    highlight: [],
                    steps: ["Gen 2x2 grid.", "Calc r1+c1=2.", "Calc r1+c2=3.", "Fill and spill."]
                }
            },
            {
                type: 'Array',
                name: 'MAP',
                syntax: 'MAP(array1, LAMBDA)',
                example: '=MAP(A1:A3, LAMBDA(x, x*10))',
                desc: 'Maps each value in the given arrays to a new value by application of a LAMBDA.',
                data: {
                    A1: 1, A2: 2, A3: 3,
                    target: 'B1',
                    formula: '=MAP(A1:A3, LAMBDA(x, x*10))',
                    result: "10...",
                    highlight: ['A1', 'A2', 'A3'],
                    steps: ["Takes 1, 2, 3.", "Multiply each by 10.", "Result {10; 20; 30}.", "Spills down."]
                }
            },
            {
                type: 'Array',
                name: 'MDETERM',
                syntax: 'MDETERM(square_matrix)',
                example: '=MDETERM(A1:B2)',
                desc: 'Returns the matrix determinant of a square matrix.',
                data: {
                    A1: 4, B1: 3,
                    A2: 3, B2: 2,
                    target: 'C1',
                    formula: '=MDETERM(A1:B2)',
                    result: -1,
                    highlight: ['A1', 'B1', 'A2', 'B2'],
                    steps: ["Matrix [[4,3],[3,2]].", "Det = (4*2)-(3*3).", "8 - 9 = -1.", "Result is -1."]
                }
            },
            {
                type: 'Array',
                name: 'MINVERSE',
                syntax: 'MINVERSE(square_matrix)',
                example: '=MINVERSE(A1:B2)',
                desc: 'Returns the multiplicative inverse of a square matrix.',
                data: {
                    A1: 4, B1: 7,
                    A2: 2, B2: 6,
                    target: 'D1',
                    formula: '=MINVERSE(A1:B2)',
                    result: "0.6...",
                    highlight: ['A1', 'B1', 'A2', 'B2'],
                    steps: ["Calc inverse matrix.", "Result is array.", "[[0.6, -0.7]...", "Spills result."]
                }
            },
            {
                type: 'Array',
                name: 'MMULT',
                syntax: 'MMULT(matrix1, matrix2)',
                example: '=MMULT(A1:B1, C1:C2)',
                desc: 'Calculates the matrix product of two matrices.',
                data: {
                    A1: 1, B1: 2,
                    C1: 3,
                    C2: 4,
                    target: 'D1',
                    formula: '=MMULT(A1:B1, C1:C2)',
                    result: 11,
                    highlight: ['A1', 'B1', 'C1', 'C2'],
                    steps: ["Row [1,2] dot Col [3;4].", "(1*3) + (2*4).", "3 + 8 = 11.", "Result is 11."]
                }
            },
            {
                type: 'Array',
                name: 'REDUCE',
                syntax: 'REDUCE(init, array, LAMBDA)',
                example: '=REDUCE(0, A1:A3, LAMBDA(acc,v, acc+v))',
                desc: 'Reduces an array to an accumulated result via LAMBDA.',
                data: {
                    A1: 10, A2: 20, A3: 30,
                    target: 'B1',
                    formula: '=REDUCE(0,A1:A3,LAMBDA(a,v,a+v))',
                    result: 60,
                    highlight: ['A1', 'A2', 'A3'],
                    steps: ["Start with 0.", "Add 10 (10).", "Add 20 (30).", "Add 30 (60)."]
                }
            },
            {
                type: 'Array',
                name: 'SCAN',
                syntax: 'SCAN(init, array, LAMBDA)',
                example: '=SCAN(0, A1:A3, LAMBDA(acc,v, acc+v))',
                desc: 'Scans an array and produces intermediate accumulated values.',
                data: {
                    A1: 1, A2: 1, A3: 1,
                    target: 'B1',
                    formula: '=SCAN(0,A1:A3,LAMBDA(a,v,a+v))',
                    result: "1...",
                    highlight: ['A1', 'A2', 'A3'],
                    steps: ["Step 1: 0+1=1.", "Step 2: 1+1=2.", "Step 3: 2+1=3.", "Returns {1;2;3}."]
                }
            },
            {
                type: 'Array',
                name: 'SUMPRODUCT',
                syntax: 'SUMPRODUCT(array1, [array2])',
                example: '=SUMPRODUCT(A1:A2, B1:B2)',
                desc: 'Calculates the sum of the products of corresponding entries.',
                data: {
                    A1: 2, B1: 10,
                    A2: 3, B2: 20,
                    target: 'C1',
                    formula: '=SUMPRODUCT(A1:A2, B1:B2)',
                    result: 80,
                    highlight: ['A1', 'A2', 'B1', 'B2'],
                    steps: ["(2*10) = 20.", "(3*20) = 60.", "Sum 20 + 60.", "Result is 80."]
                }
            },
            {
                type: 'Array',
                name: 'SUMX2MY2',
                syntax: 'SUMX2MY2(array_x, array_y)',
                example: '=SUMX2MY2(A1:A2, B1:B2)',
                desc: 'Calculates the sum of the differences of the squares of values.',
                data: {
                    A1: 5, B1: 3, // 25-9=16
                    A2: 4, B2: 2, // 16-4=12
                    target: 'C1',
                    formula: '=SUMX2MY2(A1:A2, B1:B2)',
                    result: 28,
                    highlight: ['A1', 'A2', 'B1', 'B2'],
                    steps: ["5^2-3^2 = 16.", "4^2-2^2 = 12.", "Sum 16+12.", "Result is 28."]
                }
            },
            {
                type: 'Array',
                name: 'SUMX2PY2',
                syntax: 'SUMX2PY2(array_x, array_y)',
                example: '=SUMX2PY2(A1, B1)',
                desc: 'Calculates the sum of the sums of the squares of values.',
                data: {
                    A1: 3, B1: 4,
                    target: 'C1',
                    formula: '=SUMX2PY2(A1, B1)',
                    result: 25,
                    highlight: ['A1', 'B1'],
                    steps: ["3^2 = 9.", "4^2 = 16.", "Sum 9+16.", "Result is 25."]
                }
            },
            {
                type: 'Array',
                name: 'SUMXMY2',
                syntax: 'SUMXMY2(array_x, array_y)',
                example: '=SUMXMY2(A1, B1)',
                desc: 'Calculates the sum of the squares of differences of values.',
                data: {
                    A1: 10, B1: 6,
                    target: 'C1',
                    formula: '=SUMXMY2(A1, B1)',
                    result: 16,
                    highlight: ['A1', 'B1'],
                    steps: ["(10-6) = 4.", "4^2 = 16.", "Sum squares.", "Result is 16."]
                }
            },
            {
                type: 'Array',
                name: 'TOCOL',
                syntax: 'TOCOL(range, [ignore], [scan])',
                example: '=TOCOL(A1:B2)',
                desc: 'Transforms an array or range of cells into a single column.',
                data: {
                    A1: 1, B1: 2,
                    A2: 3, B2: 4,
                    target: 'C1',
                    formula: '=TOCOL(A1:B2)',
                    result: "1...",
                    highlight: ['A1', 'B1', 'A2', 'B2'],
                    steps: ["Take ranges.", "Stack all in one column.", "Output: 1; 2; 3; 4.", "Spills down."]
                }
            },
            {
                type: 'Array',
                name: 'TOROW',
                syntax: 'TOROW(range, [ignore], [scan])',
                example: '=TOROW(A1:B2)',
                desc: 'Transforms an array or range of cells into a single row.',
                data: {
                    A1: 1, B1: 2,
                    A2: 3, B2: 4,
                    target: 'C1',
                    formula: '=TOROW(A1:B2)',
                    result: "1...",
                    highlight: ['A1', 'B1', 'A2', 'B2'],
                    steps: ["Take ranges.", "Align all in one row.", "Output: 1, 2, 3, 4.", "Spills across."]
                }
            },
            {
                type: 'Array',
                name: 'TRANSPOSE',
                syntax: 'TRANSPOSE(range)',
                example: '=TRANSPOSE(A1:B2)',
                desc: 'Transposes the rows and columns of an array or range of cells.',
                data: {
                    A1: "A", B1: "B",
                    A2: "C", B2: "D",
                    target: 'D1',
                    formula: '=TRANSPOSE(A1:B2)',
                    result: "A C...",
                    highlight: ['A1', 'B1', 'A2', 'B2'],
                    steps: ["Swap rows/cols.", "Row 1 becomes Col 1.", "A, B -> A; B.", "Spills result."]
                }
            },
            {
                type: 'Array',
                name: 'TREND',
                syntax: 'TREND(known_y, [known_x], [new_x])',
                example: '=TREND(B1:B3, A1:A3)',
                desc: 'Fits an ideal linear trend using the least squares method.',
                data: {
                    A1: 1, B1: 10, A2: 2, B2: 20, A3: 3, B3: 30,
                    target: 'C1',
                    formula: '=TREND(B1:B3, A1:A3)',
                    result: "10...",
                    highlight: ['A1', 'A2', 'A3', 'B1', 'B2', 'B3'],
                    steps: ["Fit linear line.", "Data is perfectly linear.", "Returns array {10; 20; 30}.", "Spills result."]
                }
            },
            {
                type: 'Array',
                name: 'VSTACK',
                syntax: 'VSTACK(range1, [range2])',
                example: '=VSTACK(A1:A2, B1:B2)',
                desc: 'Appends ranges vertically and in sequence to return a larger array.',
                data: {
                    A1: "Top1", A2: "Top2",
                    B1: "Bot1", B2: "Bot2",
                    target: 'C1',
                    formula: '=VSTACK(A1:A2, B1:B2)',
                    result: "Top1...",
                    highlight: ['A1', 'A2', 'B1', 'B2'],
                    steps: ["Take A1:A2.", "Take B1:B2.", "Stack vertically.", "Result: 4 rows."]
                }
            },
            {
                type: 'Array',
                name: 'WRAPCOLS',
                syntax: 'WRAPCOLS(range, wrap_count)',
                example: '=WRAPCOLS(A1:A4, 2)',
                desc: 'Wraps the provided row/column of cells by columns after a specified number of elements.',
                data: {
                    A1: 1, A2: 2, A3: 3, A4: 4,
                    target: 'B1',
                    formula: '=WRAPCOLS(A1:A4, 2)',
                    result: "1 3...",
                    highlight: ['A1', 'A2', 'A3', 'A4'],
                    steps: ["Take stream: 1,2,3,4.", "Fill col 1 with 2 items (1,2).", "Fill col 2 (3,4).", "Result spills."]
                }
            },
            {
                type: 'Array',
                name: 'WRAPROWS',
                syntax: 'WRAPROWS(range, wrap_count)',
                example: '=WRAPROWS(A1:A4, 2)',
                desc: 'Wraps the provided row/column of cells by rows after a specified number of elements.',
                data: {
                    A1: 1, A2: 2, A3: 3, A4: 4,
                    target: 'B1',
                    formula: '=WRAPROWS(A1:A4, 2)',
                    result: "1 2...",
                    highlight: ['A1', 'A2', 'A3', 'A4'],
                    steps: ["Take stream: 1,2,3,4.", "Fill row 1 with 2 items (1,2).", "Fill row 2 (3,4).", "Result spills."]
                }
            },
            {
                type: 'Web',
                name: 'IMAGE',
                syntax: 'IMAGE(url, [mode])',
                example: '=IMAGE("https://example.com/pic.png")',
                desc: 'Inserts an image into a cell.',
                data: {
                    A1: "img.png",
                    target: 'B2',
                    formula: '=IMAGE("pic.png")',
                    result: "🖼️",
                    steps: ["Fetch image from URL.", "Render in cell B2.", "Resize to fit cell.", "Image displayed."]
                }
            },

            {
                type: 'Lookup',
                name: 'INDEX',
                syntax: 'INDEX(reference, [row], [col])',
                example: '=INDEX(A1:C5, 2, 3)',
                desc: 'Returns the content of a cell, specified by row and column offset.',
                data: {
                    A1: "A", B1: "B",
                    A2: "C", B2: "D",
                    target: 'D1',
                    formula: '=INDEX(A1:B2, 2, 2)',
                    result: "D",
                    highlight: ['A1', 'B1', 'A2', 'B2'],
                    steps: ["Look at range A1:B2.", "Go to Row 2.", "Go to Column 2.", "Found value 'D'."]
                }
            },
            {
                type: 'Lookup',
                name: 'MATCH',
                syntax: 'MATCH(key, range, [type])',
                example: '=MATCH("Apple", A:A, 0)',
                desc: 'Returns the relative position of an item in a range that matches a specified value.',
                data: {
                    A1: "Cat",
                    A2: "Dog",
                    A3: "Bird",
                    target: 'B1',
                    formula: '=MATCH("Dog", A1:A3, 0)',
                    result: 2,
                    highlight: ['A1', 'A2', 'A3'],
                    steps: ["Search A1:A3.", "Find 'Dog'.", "It is at position 2.", "Return 2."]
                }
            },

            // --- ENGINEERING ---
            {
                type: 'Engineering',
                name: 'BIN2DEC',
                syntax: 'BIN2DEC(binary_number)',
                example: '=BIN2DEC(101)',
                desc: 'Converts a signed binary number to decimal format.',
                data: {
                    A1: 101,
                    target: 'B1',
                    formula: '=BIN2DEC(A1)',
                    result: 5,
                    highlight: ['A1'],
                    steps: ["Read binary 101.", "1*4 + 0*2 + 1*1.", "Sum is 5.", "Result 5."]
                }
            },
            {
                type: 'Engineering',
                name: 'BIN2HEX',
                syntax: 'BIN2HEX(binary_number, [digits])',
                example: '=BIN2HEX(1111)',
                desc: 'Converts a signed binary number to signed hexadecimal format.',
                data: {
                    A1: 1111,
                    target: 'B1',
                    formula: '=BIN2HEX(A1)',
                    result: "F",
                    highlight: ['A1'],
                    steps: ["Read binary 1111.", "Decimal is 15.", "Hex is F.", "Result 'F'."]
                }
            },
            {
                type: 'Engineering',
                name: 'BIN2OCT',
                syntax: 'BIN2OCT(binary_number, [digits])',
                example: '=BIN2OCT(1001)',
                desc: 'Converts a signed binary number to signed octal format.',
                data: {
                    A1: 1001,
                    target: 'B1',
                    formula: '=BIN2OCT(A1)',
                    result: 11,
                    highlight: ['A1'],
                    steps: ["Read binary 1001.", "Decimal is 9.", "Octal is 11.", "Result 11."]
                }
            },
            {
                type: 'Engineering',
                name: 'BITAND',
                syntax: 'BITAND(value1, value2)',
                example: '=BITAND(13, 25)',
                desc: 'Bitwise boolean AND of two numbers.',
                data: {
                    A1: 6, // 110
                    B1: 3, // 011
                    target: 'C1',
                    formula: '=BITAND(A1, B1)',
                    result: 2,
                    highlight: ['A1', 'B1'],
                    steps: ["6 is 110.", "3 is 011.", "AND is 010 (2).", "Result 2."]
                }
            },
            {
                type: 'Engineering',
                name: 'BITLSHIFT',
                syntax: 'BITLSHIFT(value, shift)',
                example: '=BITLSHIFT(4, 2)',
                desc: 'Shifts the bits of the input a certain number of places to the left.',
                data: {
                    A1: 4, // 100
                    target: 'B1',
                    formula: '=BITLSHIFT(A1, 2)',
                    result: 16,
                    highlight: ['A1'],
                    steps: ["4 is 100.", "Shift left 2.", "10000 is 16.", "Result 16."]
                }
            },
            {
                type: 'Engineering',
                name: 'BITOR',
                syntax: 'BITOR(value1, value2)',
                example: '=BITOR(13, 25)',
                desc: 'Bitwise boolean OR of 2 numbers.',
                data: {
                    A1: 6, // 110
                    B1: 3, // 011
                    target: 'C1',
                    formula: '=BITOR(A1, B1)',
                    result: 7,
                    highlight: ['A1', 'B1'],
                    steps: ["6 is 110.", "3 is 011.", "OR is 111 (7).", "Result 7."]
                }
            },
            {
                type: 'Engineering',
                name: 'BITRSHIFT',
                syntax: 'BITRSHIFT(value, shift)',
                example: '=BITRSHIFT(16, 2)',
                desc: 'Shifts the bits of the input a certain number of places to the right.',
                data: {
                    A1: 16, // 10000
                    target: 'B1',
                    formula: '=BITRSHIFT(A1, 2)',
                    result: 4,
                    highlight: ['A1'],
                    steps: ["16 is 10000.", "Shift right 2.", "100 is 4.", "Result 4."]
                }
            },
            {
                type: 'Engineering',
                name: 'BITXOR',
                syntax: 'BITXOR(value1, value2)',
                example: '=BITXOR(13, 25)',
                desc: 'Bitwise XOR (exclusive OR) of 2 numbers.',
                data: {
                    A1: 6, // 110
                    B1: 3, // 011
                    target: 'C1',
                    formula: '=BITXOR(A1, B1)',
                    result: 5,
                    highlight: ['A1', 'B1'],
                    steps: ["6 is 110.", "3 is 011.", "XOR is 101 (5).", "Result 5."]
                }
            },
            {
                type: 'Engineering',
                name: 'COMPLEX',
                syntax: 'COMPLEX(real, imaginary, [suffix])',
                example: '=COMPLEX(3, 4)',
                desc: 'Creates a complex number given real and imaginary coefficients.',
                data: {
                    A1: 3, B1: 4,
                    target: 'C1',
                    formula: '=COMPLEX(A1, B1)',
                    result: "3+4i",
                    highlight: ['A1', 'B1'],
                    steps: ["Real part: 3.", "Imag part: 4.", "Combine.", "Result '3+4i'."]
                }
            },
            {
                type: 'Engineering',
                name: 'DEC2BIN',
                syntax: 'DEC2BIN(number, [digits])',
                example: '=DEC2BIN(10)',
                desc: 'Converts a decimal number to signed binary format.',
                data: {
                    A1: 9,
                    target: 'B1',
                    formula: '=DEC2BIN(A1)',
                    result: "1001",
                    highlight: ['A1'],
                    steps: ["Read decimal 9.", "Convert to binary.", "Result '1001'."]
                }
            },
            {
                type: 'Engineering',
                name: 'DEC2HEX',
                syntax: 'DEC2HEX(number, [digits])',
                example: '=DEC2HEX(100)',
                desc: 'Converts a decimal number to signed hexadecimal format.',
                data: {
                    A1: 31,
                    target: 'B1',
                    formula: '=DEC2HEX(A1)',
                    result: "1F",
                    highlight: ['A1'],
                    steps: ["Read decimal 31.", "Convert to hex.", "Result '1F'."]
                }
            },
            {
                type: 'Engineering',
                name: 'DEC2OCT',
                syntax: 'DEC2OCT(number, [digits])',
                example: '=DEC2OCT(100)',
                desc: 'Converts a decimal number to signed octal format.',
                data: {
                    A1: 9,
                    target: 'B1',
                    formula: '=DEC2OCT(A1)',
                    result: 11,
                    highlight: ['A1'],
                    steps: ["Read decimal 9.", "Convert to octal.", "Result 11."]
                }
            },
            {
                type: 'Engineering',
                name: 'DELTA',
                syntax: 'DELTA(number1, [number2])',
                example: '=DELTA(5, 4)',
                desc: 'Compare two numeric values, returning 1 if they are equal.',
                data: {
                    A1: 5, B1: 5,
                    target: 'C1',
                    formula: '=DELTA(A1, B1)',
                    result: 1,
                    highlight: ['A1', 'B1'],
                    steps: ["Compare 5 and 5.", "Equal? Yes.", "Return 1."]
                }
            },
            {
                type: 'Engineering',
                name: 'ERF',
                syntax: 'ERF(lower, [upper])',
                example: '=ERF(1)',
                desc: 'Returns the integral of the Gauss error function.',
                data: {
                    A1: 1,
                    target: 'B1',
                    formula: '=ERF(A1)',
                    result: 0.8427,
                    highlight: ['A1'],
                    steps: ["Calculate Error Func.", "Input 1.", "Result ~0.8427."]
                }
            },
            {
                type: 'Engineering',
                name: 'ERF.PRECISE',
                syntax: 'ERF.PRECISE(lower)',
                example: '=ERF.PRECISE(1)',
                desc: 'Returns the integral of the Gauss error function.',
                data: {
                    A1: 1,
                    target: 'B1',
                    formula: '=ERF.PRECISE(A1)',
                    result: 0.8427,
                    highlight: ['A1'],
                    steps: ["Same as ERF.", "Input 1.", "Result ~0.8427."]
                }
            },
            {
                type: 'Engineering',
                name: 'GESTEP',
                syntax: 'GESTEP(value, [step])',
                example: '=GESTEP(5, 3)',
                desc: 'Returns 1 if the rate is strictly greater than or equal to the provided step value.',
                data: {
                    A1: 5, B1: 3,
                    target: 'C1',
                    formula: '=GESTEP(A1, B1)',
                    result: 1,
                    highlight: ['A1', 'B1'],
                    steps: ["Is 5 >= 3?", "Yes.", "Return 1."]
                }
            },
            {
                type: 'Engineering',
                name: 'HEX2BIN',
                syntax: 'HEX2BIN(hex_number, [digits])',
                example: '=HEX2BIN("F")',
                desc: 'Converts a signed hexadecimal number to signed binary format.',
                data: {
                    A1: "F",
                    target: 'B1',
                    formula: '=HEX2BIN(A1)',
                    result: "1111",
                    highlight: ['A1'],
                    steps: ["Read Hex 'F'.", "Convert to binary.", "Result '1111'."]
                }
            },
            {
                type: 'Engineering',
                name: 'HEX2DEC',
                syntax: 'HEX2DEC(hex_number)',
                example: '=HEX2DEC("FF")',
                desc: 'Converts a signed hexadecimal number to decimal format.',
                data: {
                    A1: "1F",
                    target: 'B1',
                    formula: '=HEX2DEC(A1)',
                    result: 31,
                    highlight: ['A1'],
                    steps: ["Read Hex '1F'.", "1*16 + 15.", "Result 31."]
                }
            },
            {
                type: 'Engineering',
                name: 'HEX2OCT',
                syntax: 'HEX2OCT(hex_number, [digits])',
                example: '=HEX2OCT("F")',
                desc: 'Converts a signed hexadecimal number to signed octal format.',
                data: {
                    A1: "1F",
                    target: 'B1',
                    formula: '=HEX2OCT(A1)',
                    result: 37,
                    highlight: ['A1'],
                    steps: ["Read Hex '1F'.", "Convert to Octal.", "Result 37."]
                }
            },
            {
                type: 'Engineering',
                name: 'IMABS',
                syntax: 'IMABS(number)',
                example: '=IMABS("3+4i")',
                desc: 'Returns absolute value of a complex number.',
                data: {
                    A1: "3+4i",
                    target: 'B1',
                    formula: '=IMABS(A1)',
                    result: 5,
                    highlight: ['A1'],
                    steps: ["Sqrt(3^2 + 4^2).", "Sqrt(25).", "Result 5."]
                }
            },
            {
                type: 'Engineering',
                name: 'IMAGINARY',
                syntax: 'IMAGINARY(number)',
                example: '=IMAGINARY("3+4i")',
                desc: 'Returns the imaginary coefficient of a complex number.',
                data: {
                    A1: "3+4i",
                    target: 'B1',
                    formula: '=IMAGINARY(A1)',
                    result: 4,
                    highlight: ['A1'],
                    steps: ["Read '3+4i'.", "Extract imaginary part.", "Result 4."]
                }
            },
            {
                type: 'Engineering',
                name: 'IMARGUMENT',
                syntax: 'IMARGUMENT(number)',
                example: '=IMARGUMENT("1+1i")',
                desc: 'Returns the angle (theta) of the given complex number in radians.',
                data: {
                    A1: "1+1i",
                    target: 'B1',
                    formula: '=IMARGUMENT(A1)',
                    result: "0.785...",
                    highlight: ['A1'],
                    steps: ["Cartesian to Polar.", "Atan2(1,1).", "Result PI/4."]
                }
            },
            {
                type: 'Engineering',
                name: 'IMCONJUGATE',
                syntax: 'IMCONJUGATE(number)',
                example: '=IMCONJUGATE("3+4i")',
                desc: 'Returns the complex conjugate of a number.',
                data: {
                    A1: "3+4i",
                    target: 'B1',
                    formula: '=IMCONJUGATE(A1)',
                    result: "3-4i",
                    highlight: ['A1'],
                    steps: ["Flip sign of imaginary.", "3+4i -> 3-4i.", "Result '3-4i'."]
                }
            },
            {
                type: 'Engineering',
                name: 'IMCOS',
                syntax: 'IMCOS(number)',
                example: '=IMCOS("1+i")',
                desc: 'Returns the cosine of the given complex number.',
                data: {
                    A1: "0+i",
                    target: 'B1',
                    formula: '=IMCOS(A1)',
                    result: "1.543...",
                    highlight: ['A1'],
                    steps: ["Cos(i) = Cosh(1).", "Calc value.", "Result ~1.543."]
                }
            },
            {
                type: 'Engineering',
                name: 'IMDIV',
                syntax: 'IMDIV(dividend, divisor)',
                example: '=IMDIV("3+4i", "2+2i")',
                desc: 'Returns one complex number divided by another.',
                data: {
                    A1: "2+2i", B1: "1+1i",
                    target: 'C1',
                    formula: '=IMDIV(A1, B1)',
                    result: "2",
                    highlight: ['A1', 'B1'],
                    steps: ["(2+2i) / (1+1i).", "Factor out 2.", "Result 2."]
                }
            },
            {
                type: 'Engineering',
                name: 'IMPRODUCT',
                syntax: 'IMPRODUCT(factor1, factor2)',
                example: '=IMPRODUCT("1+i", "2+i")',
                desc: 'Returns the result of multiplying complex numbers.',
                data: {
                    A1: "1+i", B1: "1-i",
                    target: 'C1',
                    formula: '=IMPRODUCT(A1, B1)',
                    result: "2",
                    highlight: ['A1', 'B1'],
                    steps: ["(1+i)*(1-i).", "1 - i^2.", "1 - (-1) = 2.", "Result 2."]
                }
            },
            {
                type: 'Engineering',
                name: 'IMREAL',
                syntax: 'IMREAL(number)',
                example: '=IMREAL("3+4i")',
                desc: 'Returns the real coefficient of a complex number.',
                data: {
                    A1: "3+4i",
                    target: 'B1',
                    formula: '=IMREAL(A1)',
                    result: 3,
                    highlight: ['A1'],
                    steps: ["Read '3+4i'.", "Extract real part.", "Result 3."]
                }
            },
            {
                type: 'Engineering',
                name: 'IMSUB',
                syntax: 'IMSUB(num1, num2)',
                example: '=IMSUB("3+4i", "1+1i")',
                desc: 'Returns the difference between two complex numbers.',
                data: {
                    A1: "3+4i", B1: "1+2i",
                    target: 'C1',
                    formula: '=IMSUB(A1, B1)',
                    result: "2+2i",
                    highlight: ['A1', 'B1'],
                    steps: ["(3-1) + (4-2)i.", "2 + 2i.", "Result '2+2i'."]
                }
            },
            {
                type: 'Engineering',
                name: 'IMSUM',
                syntax: 'IMSUM(value1, value2)',
                example: '=IMSUM("3+4i", "1+2i")',
                desc: 'Returns the sum of a series of complex numbers.',
                data: {
                    A1: "3+4i", B1: "1+2i",
                    target: 'C1',
                    formula: '=IMSUM(A1, B1)',
                    result: "4+6i",
                    highlight: ['A1', 'B1'],
                    steps: ["(3+1) + (4+2)i.", "4 + 6i.", "Result '4+6i'."]
                }
            },
            {
                type: 'Engineering',
                name: 'OCT2BIN',
                syntax: 'OCT2BIN(octal_number, [digits])',
                example: '=OCT2BIN(10)',
                desc: 'Converts a signed octal number to signed binary format.',
                data: {
                    A1: 7,
                    target: 'B1',
                    formula: '=OCT2BIN(A1)',
                    result: "111",
                    highlight: ['A1'],
                    steps: ["Read Octal 7.", "Convert to binary.", "Result '111'."]
                }
            },
            {
                type: 'Engineering',
                name: 'OCT2DEC',
                syntax: 'OCT2DEC(octal_number)',
                example: '=OCT2DEC(10)',
                desc: 'Converts a signed octal number to decimal format.',
                data: {
                    A1: 10,
                    target: 'B1',
                    formula: '=OCT2DEC(A1)',
                    result: 8,
                    highlight: ['A1'],
                    steps: ["Read Octal 10.", "1*8 + 0.", "Result 8."]
                }
            },
            {
                type: 'Engineering',
                name: 'OCT2HEX',
                syntax: 'OCT2HEX(octal_number, [digits])',
                example: '=OCT2HEX(10)',
                desc: 'Converts a signed octal number to signed hexadecimal format.',
                data: {
                    A1: 12,
                    target: 'B1',
                    formula: '=OCT2HEX(A1)',
                    result: "A",
                    highlight: ['A1'],
                    steps: ["Read Octal 12.", "Decimal is 10.", "Hex is A.", "Result 'A'."]
                }
            },
            {
                type: 'Math',
                name: 'ABS',
                syntax: 'ABS(value)',
                example: '=ABS(-5)',
                desc: 'Returns the absolute value of a number.',
                data: { A1: -10, target: 'B1', formula: '=ABS(A1)', result: 10, highlight: ['A1'], steps: ["Take -10.", "Make positive.", "Result 10."] }
            },
            {
                type: 'Math',
                name: 'ACOS',
                syntax: 'ACOS(value)',
                example: '=ACOS(0.5)',
                desc: 'Returns the inverse cosine of a value, in radians.',
                data: { A1: 0.5, target: 'B1', formula: '=ACOS(A1)', result: 1.047, highlight: ['A1'], steps: ["Calc arccos(0.5).", "Result ~1.047 rad."] }
            },
            {
                type: 'Math',
                name: 'ACOSH',
                syntax: 'ACOSH(value)',
                example: '=ACOSH(2)',
                desc: 'Returns the inverse hyperbolic cosine of a number.',
                data: { A1: 10, target: 'B1', formula: '=ACOSH(A1)', result: 2.99, highlight: ['A1'], steps: ["Calc acosh(10).", "Result ~2.99."] }
            },
            {
                type: 'Math',
                name: 'ACOT',
                syntax: 'ACOT(value)',
                example: '=ACOT(1)',
                desc: 'Returns the inverse cotangent of a value, in radians.',
                data: { A1: 1, target: 'B1', formula: '=ACOT(A1)', result: 0.785, highlight: ['A1'], steps: ["Calc acot(1).", "Result ~0.785 rad."] }
            },
            {
                type: 'Math',
                name: 'ACOTH',
                syntax: 'ACOTH(value)',
                example: '=ACOTH(2)',
                desc: 'Returns the inverse hyperbolic cotangent of a value.',
                data: { A1: 2, target: 'B1', formula: '=ACOTH(A1)', result: 0.549, highlight: ['A1'], steps: ["Calc acoth(2).", "Result ~0.549."] }
            },
            {
                type: 'Math',
                name: 'ASIN',
                syntax: 'ASIN(value)',
                example: '=ASIN(0.5)',
                desc: 'Returns the inverse sine of a value, in radians.',
                data: { A1: 0.5, target: 'B1', formula: '=ASIN(A1)', result: 0.523, highlight: ['A1'], steps: ["Calc arcsin(0.5).", "Result ~0.523 rad."] }
            },
            {
                type: 'Math',
                name: 'ASINH',
                syntax: 'ASINH(value)',
                example: '=ASINH(2)',
                desc: 'Returns the inverse hyperbolic sine of a number.',
                data: { A1: 2, target: 'B1', formula: '=ASINH(A1)', result: 1.44, highlight: ['A1'], steps: ["Calc asinh(2).", "Result ~1.44."] }
            },
            {
                type: 'Math',
                name: 'ATAN',
                syntax: 'ATAN(value)',
                example: '=ATAN(1)',
                desc: 'Returns the inverse tangent of a value, in radians.',
                data: { A1: 1, target: 'B1', formula: '=ATAN(A1)', result: 0.785, highlight: ['A1'], steps: ["Calc arctan(1).", "Result ~0.785 rad."] }
            },
            {
                type: 'Math',
                name: 'ATAN2',
                syntax: 'ATAN2(x, y)',
                example: '=ATAN2(1, 1)',
                desc: 'Returns the angle between the x-axis and a line segment from origin to (x,y).',
                data: { A1: 1, A2: 1, target: 'B1', formula: '=ATAN2(A1, A2)', result: 0.785, highlight: ['A1', 'A2'], steps: ["Point (1,1).", "Calc angle.", "Result ~0.785 rad."] }
            },
            {
                type: 'Math',
                name: 'ATANH',
                syntax: 'ATANH(value)',
                example: '=ATANH(0.5)',
                desc: 'Returns the inverse hyperbolic tangent of a number.',
                data: { A1: 0.5, target: 'B1', formula: '=ATANH(A1)', result: 0.549, highlight: ['A1'], steps: ["Calc atanh(0.5).", "Result ~0.549."] }
            },
            {
                type: 'Math',
                name: 'BASE',
                syntax: 'BASE(value, base, [min_length])',
                example: '=BASE(7, 2)',
                desc: 'Converts a number into a text representation in another base.',
                data: { A1: 7, target: 'B1', formula: '=BASE(A1, 2)', result: "111", highlight: ['A1'], steps: ["Convert 7 to base 2.", "Result '111'."] }
            },
            {
                type: 'Math',
                name: 'CEILING',
                syntax: 'CEILING(value, [factor])',
                example: '=CEILING(2.5, 1)',
                desc: 'Rounds a number up to the nearest integer multiple of specified significance.',
                data: { A1: 2.3, target: 'B1', formula: '=CEILING(A1, 1)', result: 3, highlight: ['A1'], steps: ["Round 2.3 up to multiple of 1.", "Result 3."] }
            },
            {
                type: 'Math',
                name: 'CEILING.MATH',
                syntax: 'CEILING.MATH(number, [significance], [mode])',
                example: '=CEILING.MATH(-2.5, 1)',
                desc: 'Rounds a number up to the nearest integer multiple, with negative number control.',
                data: { A1: -2.3, target: 'B1', formula: '=CEILING.MATH(A1, 1)', result: -2, highlight: ['A1'], steps: ["Round -2.3 up (towards 0).", "Result -2."] }
            },
            {
                type: 'Math',
                name: 'CEILING.PRECISE',
                syntax: 'CEILING.PRECISE(number, [significance])',
                example: '=CEILING.PRECISE(2.5, 1)',
                desc: 'Rounds a number up to the nearest integer multiple of specified significance.',
                data: { A1: 2.3, target: 'B1', formula: '=CEILING.PRECISE(A1, 1)', result: 3, highlight: ['A1'], steps: ["Round 2.3 up.", "Result 3."] }
            },
            {
                type: 'Math',
                name: 'COMBIN',
                syntax: 'COMBIN(n, k)',
                example: '=COMBIN(5, 2)',
                desc: 'Returns number of ways to choose k objects from a pool of n.',
                data: { A1: 5, B1: 2, target: 'C1', formula: '=COMBIN(A1, B1)', result: 10, highlight: ['A1', 'B1'], steps: ["5 choose 2.", "5! / (2! * 3!).", "Result 10."] }
            },
            {
                type: 'Math',
                name: 'COMBINA',
                syntax: 'COMBINA(n, k)',
                example: '=COMBINA(5, 2)',
                desc: 'Returns ways to choose k objects from n, allowing repetitions.',
                data: { A1: 3, B1: 2, target: 'C1', formula: '=COMBINA(A1, B1)', result: 6, highlight: ['A1', 'B1'], steps: ["3 choose 2 (w/ rep).", "Result 6."] }
            },
            {
                type: 'Math',
                name: 'COS',
                syntax: 'COS(angle)',
                example: '=COS(PI())',
                desc: 'Returns the cosine of an angle provided in radians.',
                data: { A1: 3.14159, target: 'B1', formula: '=COS(A1)', result: -1, highlight: ['A1'], steps: ["Calc cosine(PI).", "Result -1."] }
            },
            {
                type: 'Math',
                name: 'COSH',
                syntax: 'COSH(value)',
                example: '=COSH(1)',
                desc: 'Returns the hyperbolic cosine of any real number.',
                data: { A1: 0, target: 'B1', formula: '=COSH(A1)', result: 1, highlight: ['A1'], steps: ["Calc cosh(0).", "Result 1."] }
            },
            {
                type: 'Math',
                name: 'COT',
                syntax: 'COT(angle)',
                example: '=COT(1)',
                desc: 'Cotangent of an angle provided in radians.',
                data: { A1: 1, target: 'B1', formula: '=COT(A1)', result: 0.642, highlight: ['A1'], steps: ["Calc cot(1).", "Result ~0.642."] }
            },
            {
                type: 'Math',
                name: 'COTH',
                syntax: 'COTH(value)',
                example: '=COTH(2)',
                desc: 'Returns the hyperbolic cotangent of any real number.',
                data: { A1: 1, target: 'B1', formula: '=COTH(A1)', result: 1.31, highlight: ['A1'], steps: ["Calc coth(1).", "Result ~1.31."] }
            },
            {
                type: 'Math',
                name: 'COUNTBLANK',
                syntax: 'COUNTBLANK(range)',
                example: '=COUNTBLANK(A1:A5)',
                desc: 'Returns the number of empty cells in a given range.',
                data: { A1: 1, A2: "", A3: 2, target: 'B1', formula: '=COUNTBLANK(A1:A3)', result: 1, highlight: ['A1', 'A2', 'A3'], steps: ["Check range A1:A3.", "Count empty cells.", "A2 is empty.", "Result 1."] }
            },
            {
                type: 'Math',
                name: 'COUNTIF',
                syntax: 'COUNTIF(range, criterion)',
                example: '=COUNTIF(A1:A5, ">10")',
                desc: 'Returns a conditional count across a range.',
                data: { A1: 5, A2: 15, A3: 20, target: 'B1', formula: '=COUNTIF(A1:A3, ">10")', result: 2, highlight: ['A1', 'A2', 'A3'], steps: ["Check range > 10.", "A2(15), A3(20).", "Result 2."] }
            },
            {
                type: 'Math',
                name: 'COUNTIFS',
                syntax: 'COUNTIFS(range1, crit1, [range2, crit2])',
                example: '=COUNTIFS(A1:A5, ">10", B1:B5, "<20")',
                desc: 'Returns the count of a range depending on multiple criteria.',
                data: { A1: 15, B1: 5, A2: 15, B2: 25, target: 'C1', formula: '=COUNTIFS(A1:A2, 15, B1:B2, "<10")', result: 1, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["A=15 and B<10.", "Row 1 matches.", "Row 2 B2>=10.", "Result 1."] }
            },
            {
                type: 'Math',
                name: 'COUNTUNIQUE',
                syntax: 'COUNTUNIQUE(value1, [value2, ...])',
                example: '=COUNTUNIQUE(A1:A10)',
                desc: 'Counts the number of unique values in a list.',
                data: { A1: "A", A2: "B", A3: "A", target: 'B1', formula: '=COUNTUNIQUE(A1:A3)', result: 2, highlight: ['A1', 'A2', 'A3'], steps: ["Check uniques.", "A, B.", "Result 2."] }
            },
            {
                type: 'Math',
                name: 'CSC',
                syntax: 'CSC(angle)',
                example: '=CSC(1)',
                desc: 'Returns the cosecant of an angle provided in radians.',
                data: { A1: 1, target: 'B1', formula: '=CSC(A1)', result: 1.18, highlight: ['A1'], steps: ["Calc csc(1).", "Result ~1.18."] }
            },
            {
                type: 'Math',
                name: 'CSCH',
                syntax: 'CSCH(value)',
                example: '=CSCH(1)',
                desc: 'Returns the hyperbolic cosecant of any real number.',
                data: { A1: 1, target: 'B1', formula: '=CSCH(A1)', result: 0.85, highlight: ['A1'], steps: ["Calc csch(1).", "Result ~0.85."] }
            },
            {
                type: 'Math',
                name: 'DECIMAL',
                syntax: 'DECIMAL(value, base)',
                example: '=DECIMAL("111", 2)',
                desc: 'Converts text representation of a number in another base to decimal.',
                data: { A1: "111", target: 'B1', formula: '=DECIMAL(A1, 2)', result: 7, highlight: ['A1'], steps: ["Read binary 111.", "Convert to decimal.", "Result 7."] }
            },
            {
                type: 'Math',
                name: 'DEGREES',
                syntax: 'DEGREES(angle)',
                example: '=DEGREES(PI())',
                desc: 'Converts an angle value in radians to degrees.',
                data: { A1: 3.14159, target: 'B1', formula: '=DEGREES(A1)', result: 180, highlight: ['A1'], steps: ["Convert PI rads.", "Result 180 deg."] }
            },
            {
                type: 'Math',
                name: 'ERFC',
                syntax: 'ERFC(z)',
                example: '=ERFC(1)',
                desc: 'Returns the complementary Gauss error function of a value.',
                data: { A1: 1, target: 'B1', formula: '=ERFC(A1)', result: 0.157, highlight: ['A1'], steps: ["Calc erfc(1).", "Result ~0.157."] }
            },
            {
                type: 'Math',
                name: 'ERFC.PRECISE',
                syntax: 'ERFC.PRECISE(z)',
                example: '=ERFC.PRECISE(1)',
                desc: 'Returns the complementary Gauss error function of a value.',
                data: { A1: 1, target: 'B1', formula: '=ERFC.PRECISE(A1)', result: 0.157, highlight: ['A1'], steps: ["Calc erfc(1).", "Result ~0.157."] }
            },
            {
                type: 'Math',
                name: 'EVEN',
                syntax: 'EVEN(value)',
                example: '=EVEN(3)',
                desc: 'Rounds a number up to the nearest even integer.',
                data: { A1: 3, target: 'B1', formula: '=EVEN(A1)', result: 4, highlight: ['A1'], steps: ["Round 3 up to even.", "Result 4."] }
            },
            {
                type: 'Math',
                name: 'EXP',
                syntax: 'EXP(exponent)',
                example: '=EXP(1)',
                desc: 'Returns Euler\'s number, e (~2.718) raised to a power.',
                data: { A1: 1, target: 'B1', formula: '=EXP(A1)', result: 2.718, highlight: ['A1'], steps: ["Calc e^1.", "Result ~2.718."] }
            },
            {
                type: 'Math',
                name: 'FACT',
                syntax: 'FACT(value)',
                example: '=FACT(3)',
                desc: 'Returns the factorial of a number.',
                data: { A1: 3, target: 'B1', formula: '=FACT(A1)', result: 6, highlight: ['A1'], steps: ["Calc 3!", "3*2*1.", "Result 6."] }
            },
            {
                type: 'Math',
                name: 'FACTDOUBLE',
                syntax: 'FACTDOUBLE(value)',
                example: '=FACTDOUBLE(6)',
                desc: 'Returns the double factorial of a number.',
                data: { A1: 6, target: 'B1', formula: '=FACTDOUBLE(A1)', result: 48, highlight: ['A1'], steps: ["Calc 6!!", "6*4*2.", "Result 48."] }
            },
            {
                type: 'Math',
                name: 'FLOOR',
                syntax: 'FLOOR(value, [factor])',
                example: '=FLOOR(2.5, 1)',
                desc: 'Rounds a number down to the nearest integer multiple of specified significance.',
                data: { A1: 2.9, target: 'B1', formula: '=FLOOR(A1, 1)', result: 2, highlight: ['A1'], steps: ["Round 2.9 down.", "Result 2."] }
            },
            {
                type: 'Math',
                name: 'FLOOR.MATH',
                syntax: 'FLOOR.MATH(number, [significance], [mode])',
                example: '=FLOOR.MATH(-2.5, 1)',
                desc: 'Rounds a number down to the nearest integer multiple, with negative control.',
                data: { A1: -2.3, target: 'B1', formula: '=FLOOR.MATH(A1)', result: -3, highlight: ['A1'], steps: ["Round -2.3 down.", "Result -3."] }
            },
            {
                type: 'Math',
                name: 'FLOOR.PRECISE',
                syntax: 'FLOOR.PRECISE(number, [significance])',
                example: '=FLOOR.PRECISE(2.5, 1)',
                desc: 'Rounds a number down to the nearest integer multiple.',
                data: { A1: 2.9, target: 'B1', formula: '=FLOOR.PRECISE(A1)', result: 2, highlight: ['A1'], steps: ["Round 2.9 down.", "Result 2."] }
            },
            {
                type: 'Math',
                name: 'GAMMALN',
                syntax: 'GAMMALN(value)',
                example: '=GAMMALN(4)',
                desc: 'Returns the logarithm of a specified Gamma function.',
                data: { A1: 4, target: 'B1', formula: '=GAMMALN(A1)', result: 1.79, highlight: ['A1'], steps: ["Calc ln(Gamma(4)).", "ln(6) ~ 1.79.", "Result 1.79."] }
            },
            {
                type: 'Math',
                name: 'GAMMALN.PRECISE',
                syntax: 'GAMMALN.PRECISE(value)',
                example: '=GAMMALN.PRECISE(4)',
                desc: 'Returns the logarithm of a specified Gamma function.',
                data: { A1: 4, target: 'B1', formula: '=GAMMALN.PRECISE(A1)', result: 1.79, highlight: ['A1'], steps: ["Calc ln(Gamma(4)).", "Result 1.79."] }
            },
            {
                type: 'Math',
                name: 'GCD',
                syntax: 'GCD(value1, value2)',
                example: '=GCD(12, 16)',
                desc: 'Returns the greatest common divisor of one or more integers.',
                data: { A1: 12, B1: 16, target: 'C1', formula: '=GCD(A1, B1)', result: 4, highlight: ['A1', 'B1'], steps: ["Find GCD(12, 16).", "Factors 1,2,3,4,6,12.", "Result 4."] }
            },
            {
                type: 'Math',
                name: 'IMLN',
                syntax: 'IMLN(complex_value)',
                example: '=IMLN("1+i")',
                desc: 'Returns the logarithm of a complex number.',
                data: { A1: "1+i", target: 'B1', formula: '=IMLN(A1)', result: "0.34+0.78i", highlight: ['A1'], steps: ["Calc ln(1+i).", "Result '0.34+0.78i'."] }
            },
            {
                type: 'Math',
                name: 'IMPOWER',
                syntax: 'IMPOWER(complex_base, exponent)',
                example: '=IMPOWER("2+2i", 2)',
                desc: 'Returns a complex number raised to a power.',
                data: { A1: "2+2i", target: 'B1', formula: '=IMPOWER(A1, 2)', result: "0+8i", highlight: ['A1'], steps: ["(2+2i)^2.", "4 + 8i - 4.", "Result '0+8i'."] }
            },
            {
                type: 'Math',
                name: 'IMSQRT',
                syntax: 'IMSQRT(complex_number)',
                example: '=IMSQRT("1+i")',
                desc: 'Computes the square root of a complex number.',
                data: { A1: "1+i", target: 'B1', formula: '=IMSQRT(A1)', result: "1.09+0.45i", highlight: ['A1'], steps: ["Sqrt(1+i).", "Result '1.09+0.45i'."] }
            },
            {
                type: 'Math',
                name: 'INT',
                syntax: 'INT(value)',
                example: '=INT(2.9)',
                desc: 'Rounds a number down to the nearest integer.',
                data: { A1: 2.9, target: 'B1', formula: '=INT(A1)', result: 2, highlight: ['A1'], steps: ["Integer part of 2.9.", "Result 2."] }
            },
            {
                type: 'Math',
                name: 'ISEVEN',
                syntax: 'ISEVEN(value)',
                example: '=ISEVEN(2)',
                desc: 'Checks whether the provided value is even.',
                data: { A1: 4, target: 'B1', formula: '=ISEVEN(A1)', result: "TRUE", highlight: ['A1'], steps: ["Is 4 even?", "Yes.", "Result TRUE."] }
            },
            {
                type: 'Math',
                name: 'ISO.CEILING',
                syntax: 'ISO.CEILING(number, [significance])',
                example: '=ISO.CEILING(2.3)',
                desc: 'Rounds a number up to the nearest integer multiple.',
                data: { A1: 2.3, target: 'B1', formula: '=ISO.CEILING(A1)', result: 3, highlight: ['A1'], steps: ["Round 2.3 up.", "Result 3."] }
            },
            {
                type: 'Math',
                name: 'ISODD',
                syntax: 'ISODD(value)',
                example: '=ISODD(3)',
                desc: 'Checks whether the provided value is odd.',
                data: { A1: 4, target: 'B1', formula: '=ISODD(A1)', result: "FALSE", highlight: ['A1'], steps: ["Is 4 odd?", "No.", "Result FALSE."] }
            },
            {
                type: 'Math',
                name: 'LCM',
                syntax: 'LCM(value1, value2)',
                example: '=LCM(12, 16)',
                desc: 'Returns the least common multiple of one or more integers.',
                data: { A1: 4, B1: 6, target: 'C1', formula: '=LCM(A1, B1)', result: 12, highlight: ['A1', 'B1'], steps: ["Find LCM(4, 6).", "Multiples 6,12...", "Result 12."] }
            },
            {
                type: 'Math',
                name: 'LN',
                syntax: 'LN(value)',
                example: '=LN(2.718)',
                desc: 'Returns the logarithm of a number, base e (Euler\'s number).',
                data: { A1: 2.718, target: 'B1', formula: '=LN(A1)', result: 1, highlight: ['A1'], steps: ["Calc ln(e).", "Result ~1."] }
            },
            {
                type: 'Math',
                name: 'LOG',
                syntax: 'LOG(value, base)',
                example: '=LOG(100, 10)',
                desc: 'Returns the logarithm of a number given a base.',
                data: { A1: 100, B1: 10, target: 'C1', formula: '=LOG(A1, B1)', result: 2, highlight: ['A1', 'B1'], steps: ["Log base 10 of 100.", "10^2 = 100.", "Result 2."] }
            },
            {
                type: 'Math',
                name: 'LOG10',
                syntax: 'LOG10(value)',
                example: '=LOG10(100)',
                desc: 'Returns the logarithm of a number, base 10.',
                data: { A1: 1000, target: 'B1', formula: '=LOG10(A1)', result: 3, highlight: ['A1'], steps: ["Log10(1000).", "10^3 = 1000.", "Result 3."] }
            },
            {
                type: 'Math',
                name: 'MOD',
                syntax: 'MOD(dividend, divisor)',
                example: '=MOD(10, 3)',
                desc: 'Returns the remainder after a division operation.',
                data: { A1: 10, B1: 3, target: 'C1', formula: '=MOD(A1, B1)', result: 1, highlight: ['A1', 'B1'], steps: ["10 / 3 = 3 R 1.", "Remainder is 1.", "Result 1."] }
            },
            {
                type: 'Math',
                name: 'MROUND',
                syntax: 'MROUND(value, factor)',
                example: '=MROUND(10, 3)',
                desc: 'Rounds one number to the nearest integer multiple of another.',
                data: { A1: 10, B1: 3, target: 'C1', formula: '=MROUND(A1, B1)', result: 9, highlight: ['A1', 'B1'], steps: ["Nearest multiple of 3.", "9 or 12? 9 is closer.", "Result 9."] }
            },
            {
                type: 'Math',
                name: 'MULTINOMIAL',
                syntax: 'MULTINOMIAL(val1, val2)',
                example: '=MULTINOMIAL(2, 3)',
                desc: 'Returns factorial of sum divided by product of factorials.',
                data: { A1: 2, B1: 3, target: 'C1', formula: '=MULTINOMIAL(A1, B1)', result: 10, highlight: ['A1', 'B1'], steps: ["(2+3)! / (2! * 3!)", "120 / 12.", "Result 10."] }
            },
            {
                type: 'Math',
                name: 'MUNIT',
                syntax: 'MUNIT(dimension)',
                example: '=MUNIT(3)',
                desc: 'Returns a unit matrix of size dimension x dimension.',
                data: { A1: 2, target: 'B1', formula: '=MUNIT(A1)', result: "1 0...", highlight: ['A1'], steps: ["Create 2x2 Identity.", "[1,0; 0,1].", "Spills result."] }
            },
            {
                type: 'Math',
                name: 'ODD',
                syntax: 'ODD(value)',
                example: '=ODD(2)',
                desc: 'Rounds a number up to the nearest odd integer.',
                data: { A1: 2, target: 'B1', formula: '=ODD(A1)', result: 3, highlight: ['A1'], steps: ["Round 2 up to odd.", "Result 3."] }
            },
            {
                type: 'Math',
                name: 'PI',
                syntax: 'PI()',
                example: '=PI()',
                desc: 'Returns the value of Pi to 14 decimal places.',
                data: { target: 'A1', formula: '=PI()', result: 3.14159, steps: ["Return constant PI.", "Result ~3.14159."] }
            },
            {
                type: 'Math',
                name: 'POWER',
                syntax: 'POWER(base, exponent)',
                example: '=POWER(2, 3)',
                desc: 'Returns a number raised to a power.',
                data: { A1: 2, B1: 3, target: 'C1', formula: '=POWER(A1, B1)', result: 8, highlight: ['A1', 'B1'], steps: ["2 raised to 3.", "2*2*2.", "Result 8."] }
            },
            {
                type: 'Math',
                name: 'PRODUCT',
                syntax: 'PRODUCT(factor1, [factor2])',
                example: '=PRODUCT(A1:A3)',
                desc: 'Returns the result of multiplying a series of numbers together.',
                data: { A1: 2, A2: 3, A3: 4, target: 'B1', formula: '=PRODUCT(A1:A3)', result: 24, highlight: ['A1', 'A2', 'A3'], steps: ["Multiply A1:A3.", "2 * 3 * 4.", "Result 24."] }
            },
            {
                type: 'Math',
                name: 'QUOTIENT',
                syntax: 'QUOTIENT(dividend, divisor)',
                example: '=QUOTIENT(10, 3)',
                desc: 'Returns one number divided by another (integer portion).',
                data: { A1: 10, B1: 3, target: 'C1', formula: '=QUOTIENT(A1, B1)', result: 3, highlight: ['A1', 'B1'], steps: ["10 / 3.", "Integer part.", "Result 3."] }
            },
            {
                type: 'Math',
                name: 'RADIANS',
                syntax: 'RADIANS(angle)',
                example: '=RADIANS(180)',
                desc: 'Converts an angle value in degrees to radians.',
                data: { A1: 180, target: 'B1', formula: '=RADIANS(A1)', result: 3.14, highlight: ['A1'], steps: ["180 deg to rad.", "Result PI (3.14)."] }
            },
            {
                type: 'Math',
                name: 'RAND',
                syntax: 'RAND()',
                example: '=RAND()',
                desc: 'Returns a random number between 0 inclusive and 1 exclusive.',
                data: { target: 'A1', formula: '=RAND()', result: 0.543, steps: ["Generate random num.", "Between 0 and 1.", "Result ~0.543."] }
            },
            {
                type: 'Math',
                name: 'RANDARRAY',
                syntax: 'RANDARRAY(rows, columns)',
                example: '=RANDARRAY(2, 2)',
                desc: 'Generates an array of random numbers between 0 and 1.',
                data: { A1: 2, B1: 2, target: 'C1', formula: '=RANDARRAY(A1, B1)', result: "0.2...", highlight: ['A1', 'B1'], steps: ["2x2 random matrix.", "Fill values.", "Spills result."] }
            },
            {
                type: 'Math',
                name: 'RANDBETWEEN',
                syntax: 'RANDBETWEEN(low, high)',
                example: '=RANDBETWEEN(1, 10)',
                desc: 'Returns a uniformly random integer between two values, inclusive.',
                data: { A1: 1, B1: 10, target: 'C1', formula: '=RANDBETWEEN(A1, B1)', result: 7, highlight: ['A1', 'B1'], steps: ["Rand int [1, 10].", "Result 7."] }
            },
            {
                type: 'Math',
                name: 'ROUND',
                syntax: 'ROUND(value, [places])',
                example: '=ROUND(2.55, 1)',
                desc: 'Rounds a number to a certain number of decimal places.',
                data: { A1: 2.55, target: 'B1', formula: '=ROUND(A1, 1)', result: 2.6, highlight: ['A1'], steps: ["Round 2.55 to 1 dec.", "Result 2.6."] }
            },
            {
                type: 'Math',
                name: 'ROUNDDOWN',
                syntax: 'ROUNDDOWN(value, [places])',
                example: '=ROUNDDOWN(2.58, 1)',
                desc: 'Rounds a number down to a certain number of decimal places.',
                data: { A1: 2.58, target: 'B1', formula: '=ROUNDDOWN(A1, 1)', result: 2.5, highlight: ['A1'], steps: ["Truncate to 1 dec.", "Result 2.5."] }
            },
            {
                type: 'Math',
                name: 'ROUNDUP',
                syntax: 'ROUNDUP(value, [places])',
                example: '=ROUNDUP(2.52, 1)',
                desc: 'Rounds a number up to a certain number of decimal places.',
                data: { A1: 2.52, target: 'B1', formula: '=ROUNDUP(A1, 1)', result: 2.6, highlight: ['A1'], steps: ["Round 2.52 up.", "Result 2.6."] }
            },
            {
                type: 'Math',
                name: 'SEC',
                syntax: 'SEC(angle)',
                example: '=SEC(1)',
                desc: 'Returns the secant of an angle, measured in radians.',
                data: { A1: 1, target: 'B1', formula: '=SEC(A1)', result: 1.85, highlight: ['A1'], steps: ["Calc sec(1).", "1/cos(1).", "Result ~1.85."] }
            },
            {
                type: 'Math',
                name: 'SECH',
                syntax: 'SECH(value)',
                example: '=SECH(1)',
                desc: 'Returns the hyperbolic secant of an angle.',
                data: { A1: 1, target: 'B1', formula: '=SECH(A1)', result: 0.65, highlight: ['A1'], steps: ["Calc sech(1).", "1/cosh(1).", "Result ~0.65."] }
            },
            {
                type: 'Math',
                name: 'SEQUENCE',
                syntax: 'SEQUENCE(rows, [cols], [start], [step])',
                example: '=SEQUENCE(2, 2)',
                desc: 'Returns an array of sequential numbers.',
                data: { A1: 2, B1: 2, target: 'C1', formula: '=SEQUENCE(A1, B1)', result: "1, 2...", highlight: ['A1', 'B1'], steps: ["Gen 2x2 sequence.", "1, 2, 3, 4.", "Spills result."] }
            },
            {
                type: 'Math',
                name: 'SERIESSUM',
                syntax: 'SERIESSUM(x, n, m, a)',
                example: '=SERIESSUM(2, 0, 1, {1, -1})',
                desc: 'Returns the sum of a power series.',
                data: { A1: 2, target: 'B1', formula: '=SERIESSUM(2, 0, 1, {1,-1})', result: -1, highlight: ['A1'], steps: ["1*2^0 + (-1)*2^1.", "1 - 2 = -1.", "Result -1."] }
            },
            {
                type: 'Math',
                name: 'SIGN',
                syntax: 'SIGN(value)',
                example: '=SIGN(-10)',
                desc: 'Returns -1 if negative, 1 if positive, and 0 if zero.',
                data: { A1: -10, target: 'B1', formula: '=SIGN(A1)', result: -1, highlight: ['A1'], steps: ["Is -10 neg?", "Yes.", "Result -1."] }
            },
            {
                type: 'Math',
                name: 'SIN',
                syntax: 'SIN(angle)',
                example: '=SIN(PI()/2)',
                desc: 'Returns the sine of an angle provided in radians.',
                data: { A1: 1.57, target: 'B1', formula: '=SIN(A1)', result: 1, highlight: ['A1'], steps: ["Calc sin(PI/2).", "Result ~1."] }
            },
            {
                type: 'Math',
                name: 'SINH',
                syntax: 'SINH(value)',
                example: '=SINH(1)',
                desc: 'Returns the hyperbolic sine of any real number.',
                data: { A1: 1, target: 'B1', formula: '=SINH(A1)', result: 1.175, highlight: ['A1'], steps: ["Calc sinh(1).", "Result ~1.175."] }
            },
            {
                type: 'Math',
                name: 'SQRT',
                syntax: 'SQRT(value)',
                example: '=SQRT(9)',
                desc: 'Returns the positive square root of a positive number.',
                data: { A1: 9, target: 'B1', formula: '=SQRT(A1)', result: 3, highlight: ['A1'], steps: ["Sqrt of 9.", "3 * 3 = 9.", "Result 3."] }
            },
            {
                type: 'Math',
                name: 'SQRTPI',
                syntax: 'SQRTPI(value)',
                example: '=SQRTPI(2)',
                desc: 'Returns the positive square root of (value * PI).',
                data: { A1: 2, target: 'B1', formula: '=SQRTPI(A1)', result: 2.5, highlight: ['A1'], steps: ["Sqrt(2 * PI).", "Sqrt(6.28).", "Result ~2.5."] }
            },
            {
                type: 'Math',
                name: 'SUBTOTAL',
                syntax: 'SUBTOTAL(func_code, range)',
                example: '=SUBTOTAL(9, A1:A5)',
                desc: 'Returns a subtotal using a specified aggregation function.',
                data: { A1: 10, A2: 20, target: 'B1', formula: '=SUBTOTAL(9, A1:A2)', result: 30, highlight: ['A1', 'A2'], steps: ["Code 9 is SUM.", "Sum A1:A2.", "Result 30."] }
            },
            {
                type: 'Math',
                name: 'SUM',
                syntax: 'SUM(value1, [value2...])',
                example: '=SUM(A1:A5)',
                desc: 'Returns the sum of a series of numbers and/or cells.',
                data: { A1: 10, A2: 20, target: 'B1', formula: '=SUM(A1:A2)', result: 30, highlight: ['A1', 'A2'], steps: ["Add values.", "10 + 20.", "Result 30."] }
            },
            {
                type: 'Math',
                name: 'SUMIF',
                syntax: 'SUMIF(range, criterion, [sum_range])',
                example: '=SUMIF(A1:A5, ">10")',
                desc: 'Returns a conditional sum across a range.',
                data: { A1: 5, A2: 15, A3: 20, target: 'B1', formula: '=SUMIF(A1:A3, ">10")', result: 35, highlight: ['A1', 'A2', 'A3'], steps: ["Sum if > 10.", "15 + 20.", "Result 35."] }
            },
            {
                type: 'Math',
                name: 'SUMIFS',
                syntax: 'SUMIFS(sum_range, crit_range1, crit1...)',
                example: '=SUMIFS(A1:A5, B1:B5, ">10")',
                desc: 'Returns the sum of a range depending on multiple criteria.',
                data: { A1: 10, B1: 5, A2: 20, B2: 15, target: 'C1', formula: '=SUMIFS(A1:A2, B1:B2, ">10")', result: 20, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Sum Col A if B > 10.", "Row 2 matches.", "Result 20."] }
            },
            {
                type: 'Math',
                name: 'SUMSQ',
                syntax: 'SUMSQ(value1, [value2...])',
                example: '=SUMSQ(3, 4)',
                desc: 'Returns the sum of the squares of a series of numbers.',
                data: { A1: 3, A2: 4, target: 'B1', formula: '=SUMSQ(A1:A2)', result: 25, highlight: ['A1', 'A2'], steps: ["3^2 + 4^2.", "9 + 16.", "Result 25."] }
            },
            {
                type: 'Math',
                name: 'TAN',
                syntax: 'TAN(angle)',
                example: '=TAN(0.785)',
                desc: 'Returns the tangent of an angle provided in radians.',
                data: { A1: 0.785, target: 'B1', formula: '=TAN(A1)', result: 1, highlight: ['A1'], steps: ["Calc tan(PI/4).", "Result ~1."] }
            },
            {
                type: 'Math',
                name: 'TANH',
                syntax: 'TANH(value)',
                example: '=TANH(1)',
                desc: 'Returns the hyperbolic tangent of any real number.',
                data: { A1: 1, target: 'B1', formula: '=TANH(A1)', result: 0.76, highlight: ['A1'], steps: ["Calc tanh(1).", "Result ~0.76."] }
            },
            {
                type: 'Math',
                name: 'TRUNC',
                syntax: 'TRUNC(value, [places])',
                example: '=TRUNC(2.58, 1)',
                desc: 'Truncates a number to a certain number of significant digits.',
                data: { A1: 2.58, target: 'B1', formula: '=TRUNC(A1, 1)', result: 2.5, highlight: ['A1'], steps: ["Cut off after 1st dec.", "Result 2.5."] }
            },
            {
                type: 'Operator',
                name: 'ADD',
                syntax: 'ADD(value1, value2)',
                example: '=ADD(2, 3)',
                desc: 'Returns the sum of two numbers. Equivalent to `+`.',
                data: { A1: 2, B1: 3, target: 'C1', formula: '=ADD(A1, B1)', result: 5, highlight: ['A1', 'B1'], steps: ["2 + 3.", "Result 5."] }
            },
            {
                type: 'Operator',
                name: 'CONCAT',
                syntax: 'CONCAT(value1, value2)',
                example: '=CONCAT("Hello", "World")',
                desc: 'Returns the concatenation of two values. Equivalent to `&`.',
                data: { A1: "Hi", B1: "Ya", target: 'C1', formula: '=CONCAT(A1, B1)', result: "HiYa", highlight: ['A1', 'B1'], steps: ["Join 'Hi' and 'Ya'.", "Result 'HiYa'."] }
            },
            {
                type: 'Operator',
                name: 'DIVIDE',
                syntax: 'DIVIDE(dividend, divisor)',
                example: '=DIVIDE(4, 2)',
                desc: 'Returns one number divided by another. Equivalent to `/`.',
                data: { A1: 10, B1: 2, target: 'C1', formula: '=DIVIDE(A1, B1)', result: 5, highlight: ['A1', 'B1'], steps: ["10 / 2.", "Result 5."] }
            },
            {
                type: 'Operator',
                name: 'EQ',
                syntax: 'EQ(val1, val2)',
                example: '=EQ(1, 1)',
                desc: 'Returns TRUE if two values are equal. Equivalent to `=`.',
                data: { A1: 5, B1: 5, target: 'C1', formula: '=EQ(A1, B1)', result: "TRUE", highlight: ['A1', 'B1'], steps: ["Is 5 == 5?", "Yes.", "Result TRUE."] }
            },
            {
                type: 'Operator',
                name: 'GT',
                syntax: 'GT(val1, val2)',
                example: '=GT(2, 1)',
                desc: 'Returns TRUE if first argument is strictly greater than second. Equivalent to `>`.',
                data: { A1: 5, B1: 2, target: 'C1', formula: '=GT(A1, B1)', result: "TRUE", highlight: ['A1', 'B1'], steps: ["Is 5 > 2?", "Yes.", "Result TRUE."] }
            },
            {
                type: 'Operator',
                name: 'GTE',
                syntax: 'GTE(val1, val2)',
                example: '=GTE(2, 2)',
                desc: 'Returns TRUE if first argument is greater than or equal to second. Equivalent to `>=`.',
                data: { A1: 5, B1: 5, target: 'C1', formula: '=GTE(A1, B1)', result: "TRUE", highlight: ['A1', 'B1'], steps: ["Is 5 >= 5?", "Yes.", "Result TRUE."] }
            },
            {
                type: 'Operator',
                name: 'ISBETWEEN',
                syntax: 'ISBETWEEN(val, low, high, [l_inc], [u_inc])',
                example: '=ISBETWEEN(5, 1, 10)',
                desc: 'Checks whether a number is between two other numbers.',
                data: { A1: 5, target: 'B1', formula: '=ISBETWEEN(A1, 1, 10)', result: "TRUE", highlight: ['A1'], steps: ["Is 1 <= 5 <= 10?", "Yes.", "Result TRUE."] }
            },
            {
                type: 'Operator',
                name: 'LT',
                syntax: 'LT(val1, val2)',
                example: '=LT(1, 2)',
                desc: 'Returns TRUE if first argument is strictly less than second. Equivalent to `<`.',
                data: { A1: 1, B1: 5, target: 'C1', formula: '=LT(A1, B1)', result: "TRUE", highlight: ['A1', 'B1'], steps: ["Is 1 < 5?", "Yes.", "Result TRUE."] }
            },
            {
                type: 'Operator',
                name: 'LTE',
                syntax: 'LTE(val1, val2)',
                example: '=LTE(2, 2)',
                desc: 'Returns TRUE if first argument is less than or equal to second. Equivalent to `<=`.',
                data: { A1: 5, B1: 5, target: 'C1', formula: '=LTE(A1, B1)', result: "TRUE", highlight: ['A1', 'B1'], steps: ["Is 5 <= 5?", "Yes.", "Result TRUE."] }
            },
            {
                type: 'Operator',
                name: 'MINUS',
                syntax: 'MINUS(val1, val2)',
                example: '=MINUS(5, 2)',
                desc: 'Returns the difference of two numbers. Equivalent to `-`.',
                data: { A1: 10, B1: 3, target: 'C1', formula: '=MINUS(A1, B1)', result: 7, highlight: ['A1', 'B1'], steps: ["10 - 3.", "Result 7."] }
            },
            {
                type: 'Operator',
                name: 'MULTIPLY',
                syntax: 'MULTIPLY(factor1, factor2)',
                example: '=MULTIPLY(2, 3)',
                desc: 'Returns the product of two numbers. Equivalent to `*`.',
                data: { A1: 4, B1: 2, target: 'C1', formula: '=MULTIPLY(A1, B1)', result: 8, highlight: ['A1', 'B1'], steps: ["4 * 2.", "Result 8."] }
            },
            {
                type: 'Operator',
                name: 'NE',
                syntax: 'NE(val1, val2)',
                example: '=NE(1, 2)',
                desc: 'Returns TRUE if two values are not equal. Equivalent to `<>`.',
                data: { A1: 1, B1: 2, target: 'C1', formula: '=NE(A1, B1)', result: "TRUE", highlight: ['A1', 'B1'], steps: ["Is 1 != 2?", "Yes.", "Result TRUE."] }
            },
            {
                type: 'Operator',
                name: 'POW',
                syntax: 'POW(base, exponent)',
                example: '=POW(2, 3)',
                desc: 'Returns a number raised to a power. Equivalent to `^`.',
                data: { A1: 2, B1: 3, target: 'C1', formula: '=POW(A1, B1)', result: 8, highlight: ['A1', 'B1'], steps: ["2^3.", "Result 8."] }
            },
            {
                type: 'Operator',
                name: 'UMINUS',
                syntax: 'UMINUS(value)',
                example: '=UMINUS(2)',
                desc: 'Returns a number with the sign reversed.',
                data: { A1: 5, target: 'B1', formula: '=UMINUS(A1)', result: -5, highlight: ['A1'], steps: ["Negate 5.", "Result -5."] }
            },
            {
                type: 'Operator',
                name: 'UNARY_PERCENT',
                syntax: 'UNARY_PERCENT(percent)',
                example: '=UNARY_PERCENT(100)',
                desc: 'Returns a value interpreted as a percentage.',
                data: { A1: 50, target: 'B1', formula: '=UNARY_PERCENT(A1)', result: 0.5, highlight: ['A1'], steps: ["50%.", "50/100.", "Result 0.5."] }
            },
            {
                type: 'Operator',
                name: 'UPLUS',
                syntax: 'UPLUS(value)',
                example: '=UPLUS(5)',
                desc: 'Returns a specified number, unchanged.',
                data: { A1: 5, target: 'B1', formula: '=UPLUS(A1)', result: 5, highlight: ['A1'], steps: ["Identity.", "Result 5."] }
            },
            {
                type: 'Statistical',
                name: 'AVEDEV',
                syntax: 'AVEDEV(val1, [val2, ...])',
                example: '=AVEDEV(2, 4, 8)',
                desc: 'Calculates the average of the magnitudes of deviations of data from a dataset\'s mean.',
                data: { A1: 2, A2: 4, A3: 8, target: 'B1', formula: '=AVEDEV(A1:A3)', result: 2, highlight: ['A1', 'A2', 'A3'], steps: ["Mean is 4.66.", "Deviations: |2-4.66|, ...", "Avg dev ~2."] }
            },
            {
                type: 'Statistical',
                name: 'AVERAGE',
                syntax: 'AVERAGE(val1, [val2, ...])',
                example: '=AVERAGE(2, 4, 8)',
                desc: 'Returns the numerical average value in a dataset, ignoring text.',
                data: { A1: 2, A2: 4, A3: 8, target: 'B1', formula: '=AVERAGE(A1:A3)', result: 4.67, highlight: ['A1', 'A2', 'A3'], steps: ["Sum: 14.", "Count: 3.", "14/3 ~ 4.67."] }
            },
            {
                type: 'Statistical',
                name: 'AVERAGE.WEIGHTED',
                syntax: 'AVERAGE.WEIGHTED(vals, weights)',
                example: '=AVERAGE.WEIGHTED(A1:A2, B1:B2)',
                desc: 'Finds the weighted average of a set of values.',
                data: { A1: 10, A2: 20, B1: 1, B2: 3, target: 'C1', formula: '=AVERAGE.WEIGHTED(A1:A2, B1:B2)', result: 17.5, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["(10*1 + 20*3) / (1+3).", "70 / 4.", "Result 17.5."] }
            },
            {
                type: 'Statistical',
                name: 'AVERAGEA',
                syntax: 'AVERAGEA(val1, [val2, ...])',
                example: '=AVERAGEA(2, "4")',
                desc: 'Returns the numerical average value in a dataset.',
                data: { A1: 2, A2: "Text", target: 'B1', formula: '=AVERAGEA(A1:A2)', result: 1, highlight: ['A1', 'A2'], steps: ["Text counts as 0.", "(2+0)/2.", "Result 1."] }
            },
            {
                type: 'Statistical',
                name: 'AVERAGEIF',
                syntax: 'AVERAGEIF(range, criterion, [avg_range])',
                example: '=AVERAGEIF(A1:A3, ">3")',
                desc: 'Returns the average of a range depending on criteria.',
                data: { A1: 2, A2: 4, A3: 8, target: 'B1', formula: '=AVERAGEIF(A1:A3, ">3")', result: 6, highlight: ['A1', 'A2', 'A3'], steps: ["Match >3: 4, 8.", "Avg(4, 8).", "Result 6."] }
            },
            {
                type: 'Statistical',
                name: 'AVERAGEIFS',
                syntax: 'AVERAGEIFS(avg_rng, crit_rng1, crit1, ...)',
                example: '=AVERAGEIFS(A1:A3, A1:A3, ">3")',
                desc: 'Returns the average of a range depending on multiple criteria.',
                data: { A1: 2, A2: 4, A3: 8, target: 'B1', formula: '=AVERAGEIFS(A1:A3, A1:A3, ">3")', result: 6, highlight: ['A1', 'A2', 'A3'], steps: ["Match >3: 4, 8.", "Avg(4, 8).", "Result 6."] }
            },
            {
                type: 'Statistical',
                name: 'BETA.DIST',
                syntax: 'BETA.DIST(val, alpha, beta, cum, [A], [B])',
                example: '=BETA.DIST(0.5, 2, 2, TRUE)',
                desc: 'Returns the probability of a given value as defined by the beta distribution.',
                data: { A1: 0.5, target: 'B1', formula: '=BETA.DIST(A1, 2, 2, TRUE)', result: 0.5, highlight: ['A1'], steps: ["Beta Dist calc.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'BETA.INV',
                syntax: 'BETA.INV(prob, alpha, beta, [A], [B])',
                example: '=BETA.INV(0.5, 2, 2)',
                desc: 'Returns the value of the inverse beta distribution function.',
                data: { A1: 0.5, target: 'B1', formula: '=BETA.INV(A1, 2, 2)', result: 0.5, highlight: ['A1'], steps: ["Inv Beta Dist.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'BETADIST',
                syntax: 'BETADIST(val, alpha, beta, [A], [B])',
                example: '=BETADIST(0.5, 2, 2)',
                desc: 'See BETA.DIST.',
                data: { A1: 0.5, target: 'B1', formula: '=BETADIST(A1, 2, 2)', result: 0.5, highlight: ['A1'], steps: ["Legacy func.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'BETAINV',
                syntax: 'BETAINV(prob, alpha, beta, [A], [B])',
                example: '=BETAINV(0.5, 2, 2)',
                desc: 'See BETA.INV.',
                data: { A1: 0.5, target: 'B1', formula: '=BETAINV(A1, 2, 2)', result: 0.5, highlight: ['A1'], steps: ["Legacy func.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'BINOM.DIST',
                syntax: 'BINOM.DIST(succ, trials, prob, cum)',
                example: '=BINOM.DIST(6, 10, 0.5, FALSE)',
                desc: 'Calculates the probability of drawing a certain number of successes.',
                data: { A1: 6, target: 'B1', formula: '=BINOM.DIST(A1, 10, 0.5, FALSE)', result: 0.205, highlight: ['A1'], steps: ["Prob of 6 heads in 10 flips.", "Result ~0.205."] }
            },
            {
                type: 'Statistical',
                name: 'BINOM.INV',
                syntax: 'BINOM.INV(trials, prob, target_prob)',
                example: '=BINOM.INV(10, 0.5, 0.75)',
                desc: 'Returns the inverse of the binomial distribution.',
                data: { A1: 10, target: 'B1', formula: '=BINOM.INV(A1, 0.5, 0.75)', result: 6, highlight: ['A1'], steps: ["Min heads for 75% cum prob.", "Result 6."] }
            },
            {
                type: 'Statistical',
                name: 'BINOMDIST',
                syntax: 'BINOMDIST(succ, trials, prob, cum)',
                example: '=BINOMDIST(6, 10, 0.5, FALSE)',
                desc: 'See BINOM.DIST.',
                data: { A1: 6, target: 'B1', formula: '=BINOMDIST(A1, 10, 0.5, FALSE)', result: 0.205, highlight: ['A1'], steps: ["Legacy func.", "Result ~0.205."] }
            },
            {
                type: 'Statistical',
                name: 'CHIDIST',
                syntax: 'CHIDIST(x, deg_freedom)',
                example: '=CHIDIST(2, 2)',
                desc: 'Calculates the right-tailed chi-squared distribution.',
                data: { A1: 2, target: 'B1', formula: '=CHIDIST(A1, 2)', result: 0.368, highlight: ['A1'], steps: ["Chi-Sq RT Dist.", "Result ~0.368."] }
            },
            {
                type: 'Statistical',
                name: 'CHIINV',
                syntax: 'CHIINV(prob, deg_freedom)',
                example: '=CHIINV(0.368, 2)',
                desc: 'Calculates the inverse of the right-tailed chi-squared distribution.',
                data: { A1: 0.368, target: 'B1', formula: '=CHIINV(A1, 2)', result: 2, highlight: ['A1'], steps: ["Inv Chi-Sq.", "Result ~2."] }
            },
            {
                type: 'Statistical',
                name: 'CHISQ.DIST',
                syntax: 'CHISQ.DIST(x, deg_freedom, cum)',
                example: '=CHISQ.DIST(2, 2, TRUE)',
                desc: 'Calculates the left-tailed chi-squared distribution.',
                data: { A1: 2, target: 'B1', formula: '=CHISQ.DIST(A1, 2, TRUE)', result: 0.632, highlight: ['A1'], steps: ["Chi-Sq Dist.", "Result ~0.632."] }
            },
            {
                type: 'Statistical',
                name: 'CHISQ.DIST.RT',
                syntax: 'CHISQ.DIST.RT(x, deg_freedom)',
                example: '=CHISQ.DIST.RT(2, 2)',
                desc: 'Calculates the right-tailed chi-squared distribution.',
                data: { A1: 2, target: 'B1', formula: '=CHISQ.DIST.RT(A1, 2)', result: 0.368, highlight: ['A1'], steps: ["Chi-Sq RT.", "Result ~0.368."] }
            },
            {
                type: 'Statistical',
                name: 'CHISQ.INV',
                syntax: 'CHISQ.INV(prob, deg_freedom)',
                example: '=CHISQ.INV(0.632, 2)',
                desc: 'Calculates the inverse of the left-tailed chi-squared distribution.',
                data: { A1: 0.632, target: 'B1', formula: '=CHISQ.INV(A1, 2)', result: 2, highlight: ['A1'], steps: ["Inv Chi-Sq.", "Result ~2."] }
            },
            {
                type: 'Statistical',
                name: 'CHISQ.INV.RT',
                syntax: 'CHISQ.INV.RT(prob, deg_freedom)',
                example: '=CHISQ.INV.RT(0.368, 2)',
                desc: 'Calculates the inverse of the right-tailed chi-squared distribution.',
                data: { A1: 0.368, target: 'B1', formula: '=CHISQ.INV.RT(A1, 2)', result: 2, highlight: ['A1'], steps: ["Inv Chi-Sq RT.", "Result ~2."] }
            },
            {
                type: 'Statistical',
                name: 'CHISQ.TEST',
                syntax: 'CHISQ.TEST(obs, exp)',
                example: '=CHISQ.TEST(A1:A2, B1:B2)',
                desc: 'Returns the probability associated with a Pearson’s chi-squared test.',
                data: { A1: 10, A2: 10, B1: 5, B2: 15, target: 'C1', formula: '=CHISQ.TEST(A1:A2, B1:B2)', result: 0.011, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Chi-Sq Test.", "Result ~0.011."] }
            },
            {
                type: 'Statistical',
                name: 'CHITEST',
                syntax: 'CHITEST(obs, exp)',
                example: '=CHITEST(A1:A2, B1:B2)',
                desc: 'See CHISQ.TEST.',
                data: { A1: 10, A2: 10, B1: 5, B2: 15, target: 'C1', formula: '=CHITEST(A1:A2, B1:B2)', result: 0.011, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Legacy Test.", "Result ~0.011."] }
            },
            {
                type: 'Statistical',
                name: 'CONFIDENCE',
                syntax: 'CONFIDENCE(alpha, std_dev, size)',
                example: '=CONFIDENCE(0.05, 1, 100)',
                desc: 'See CONFIDENCE.NORM.',
                data: { A1: 0.05, target: 'B1', formula: '=CONFIDENCE(A1, 1, 100)', result: 0.196, highlight: ['A1'], steps: ["Legacy Conf.", "Result ~0.196."] }
            },
            {
                type: 'Statistical',
                name: 'CONFIDENCE.NORM',
                syntax: 'CONFIDENCE.NORM(alpha, std_dev, size)',
                example: '=CONFIDENCE.NORM(0.05, 1, 100)',
                desc: 'Calculates the width of half the confidence interval for a normal distribution.',
                data: { A1: 0.05, target: 'B1', formula: '=CONFIDENCE.NORM(A1, 1, 100)', result: 0.196, highlight: ['A1'], steps: ["Conf Interval.", "Result ~0.196."] }
            },
            {
                type: 'Statistical',
                name: 'CONFIDENCE.T',
                syntax: 'CONFIDENCE.T(alpha, std_dev, size)',
                example: '=CONFIDENCE.T(0.05, 1, 100)',
                desc: 'Calculates the width of half the confidence interval for a Student’s t-distribution.',
                data: { A1: 0.05, target: 'B1', formula: '=CONFIDENCE.T(A1, 1, 100)', result: 0.198, highlight: ['A1'], steps: ["T Conf Interval.", "Result ~0.198."] }
            },
            {
                type: 'Statistical',
                name: 'CORREL',
                syntax: 'CORREL(y, x)',
                example: '=CORREL(A1:A2, B1:B2)',
                desc: 'Calculates r, the Pearson product-moment correlation coefficient.',
                data: { A1: 1, A2: 2, B1: 2, B2: 4, target: 'C1', formula: '=CORREL(A1:A2, B1:B2)', result: 1, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Perfect correlation.", "Result 1."] }
            },
            {
                type: 'Statistical',
                name: 'COUNT',
                syntax: 'COUNT(val1, [val2, ...])',
                example: '=COUNT(1, "a", 2)',
                desc: 'Returns a count of the number of numeric values in a dataset.',
                data: { A1: 1, A2: "Text", A3: 2, target: 'B1', formula: '=COUNT(A1:A3)', result: 2, highlight: ['A1', 'A2', 'A3'], steps: ["Count numbers.", "1 and 2.", "Result 2."] }
            },
            {
                type: 'Statistical',
                name: 'COUNTA',
                syntax: 'COUNTA(val1, [val2, ...])',
                example: '=COUNTA(1, "a", "")',
                desc: 'Returns a count of the number of values in a dataset.',
                data: { A1: 1, A2: "Text", A3: "", target: 'B1', formula: '=COUNTA(A1:A3)', result: 2, highlight: ['A1', 'A2', 'A3'], steps: ["Count non-empty.", "1 and Text.", "Result 2."] }
            },
            {
                type: 'Statistical',
                name: 'COVAR',
                syntax: 'COVAR(y, x)',
                example: '=COVAR(A1:A2, B1:B2)',
                desc: 'Calculates the covariance of a dataset.',
                data: { A1: 1, A2: 2, B1: 2, B2: 4, target: 'C1', formula: '=COVAR(A1:A2, B1:B2)', result: 0.25, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Covariance calc.", "Result 0.25."] }
            },
            {
                type: 'Statistical',
                name: 'COVARIANCE.P',
                syntax: 'COVARIANCE.P(y, x)',
                example: '=COVARIANCE.P(A1:A2, B1:B2)',
                desc: 'See COVAR.',
                data: { A1: 1, A2: 2, B1: 2, B2: 4, target: 'C1', formula: '=COVARIANCE.P(A1:A2, B1:B2)', result: 0.25, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Pop Covariance.", "Result 0.25."] }
            },
            {
                type: 'Statistical',
                name: 'COVARIANCE.S',
                syntax: 'COVARIANCE.S(y, x)',
                example: '=COVARIANCE.S(A1:A2, B1:B2)',
                desc: 'Calculates the sample covariance of a dataset.',
                data: { A1: 1, A2: 2, B1: 2, B2: 4, target: 'C1', formula: '=COVARIANCE.S(A1:A2, B1:B2)', result: 0.5, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Sample Covariance.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'CRITBINOM',
                syntax: 'CRITBINOM(trials, prob, target_prob)',
                example: '=CRITBINOM(10, 0.5, 0.75)',
                desc: 'Calculates the smallest value for which the cumulative binomial distribution is >= criteria.',
                data: { A1: 10, target: 'B1', formula: '=CRITBINOM(A1, 0.5, 0.75)', result: 6, highlight: ['A1'], steps: ["Legacy Inv Binom.", "Result 6."] }
            },
            {
                type: 'Statistical',
                name: 'DEVSQ',
                syntax: 'DEVSQ(val1, val2)',
                example: '=DEVSQ(2, 4, 8)',
                desc: 'Calculates the sum of squares of deviations based on a sample.',
                data: { A1: 2, A2: 4, A3: 8, target: 'B1', formula: '=DEVSQ(A1:A3)', result: 18.67, highlight: ['A1', 'A2', 'A3'], steps: ["Sum squared devs.", "Result ~18.67."] }
            },
            {
                type: 'Statistical',
                name: 'EXPON.DIST',
                syntax: 'EXPON.DIST(x, lambda, cum)',
                example: '=EXPON.DIST(1, 1, TRUE)',
                desc: 'Returns the value of the exponential distribution function.',
                data: { A1: 1, target: 'B1', formula: '=EXPON.DIST(A1, 1, TRUE)', result: 0.632, highlight: ['A1'], steps: ["Expon Dist.", "Result ~0.632."] }
            },
            {
                type: 'Statistical',
                name: 'EXPONDIST',
                syntax: 'EXPONDIST(x, lambda, cum)',
                example: '=EXPONDIST(1, 1, TRUE)',
                desc: 'See EXPON.DIST.',
                data: { A1: 1, target: 'B1', formula: '=EXPONDIST(A1, 1, TRUE)', result: 0.632, highlight: ['A1'], steps: ["Legacy func.", "Result ~0.632."] }
            },
            {
                type: 'Statistical',
                name: 'F.DIST',
                syntax: 'F.DIST(x, deg1, deg2, cum)',
                example: '=F.DIST(1, 2, 2, TRUE)',
                desc: 'Calculates the left-tailed F probability distribution.',
                data: { A1: 1, target: 'B1', formula: '=F.DIST(A1, 2, 2, TRUE)', result: 0.5, highlight: ['A1'], steps: ["F-Dist.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'F.DIST.RT',
                syntax: 'F.DIST.RT(x, deg1, deg2)',
                example: '=F.DIST.RT(1, 2, 2)',
                desc: 'Calculates the right-tailed F probability distribution.',
                data: { A1: 1, target: 'B1', formula: '=F.DIST.RT(A1, 2, 2)', result: 0.5, highlight: ['A1'], steps: ["F-Dist RT.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'F.INV',
                syntax: 'F.INV(prob, deg1, deg2)',
                example: '=F.INV(0.5, 2, 2)',
                desc: 'Calculates the inverse of the left-tailed F probability distribution.',
                data: { A1: 0.5, target: 'B1', formula: '=F.INV(A1, 2, 2)', result: 1, highlight: ['A1'], steps: ["Inv F-Dist.", "Result 1."] }
            },
            {
                type: 'Statistical',
                name: 'F.INV.RT',
                syntax: 'F.INV.RT(prob, deg1, deg2)',
                example: '=F.INV.RT(0.5, 2, 2)',
                desc: 'Calculates the inverse of the right-tailed F probability distribution.',
                data: { A1: 0.5, target: 'B1', formula: '=F.INV.RT(A1, 2, 2)', result: 1, highlight: ['A1'], steps: ["Inv F-Dist RT.", "Result 1."] }
            },
            {
                type: 'Statistical',
                name: 'F.TEST',
                syntax: 'F.TEST(range1, range2)',
                example: '=F.TEST(A1:A2, B1:B2)',
                desc: 'Returns the probability associated with an F-test for equality of variances.',
                data: { A1: 1, A2: 2, B1: 2, B2: 4, target: 'C1', formula: '=F.TEST(A1:A2, B1:B2)', result: 0.5, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["F-Test.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'FDIST',
                syntax: 'FDIST(x, deg1, deg2)',
                example: '=FDIST(1, 2, 2)',
                desc: 'See F.DIST.RT.',
                data: { A1: 1, target: 'B1', formula: '=FDIST(A1, 2, 2)', result: 0.5, highlight: ['A1'], steps: ["Legacy F-Dist.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'FINV',
                syntax: 'FINV(prob, deg1, deg2)',
                example: '=FINV(0.5, 2, 2)',
                desc: 'See F.INV.RT.',
                data: { A1: 0.5, target: 'B1', formula: '=FINV(A1, 2, 2)', result: 1, highlight: ['A1'], steps: ["Legacy Inv F.", "Result 1."] }
            },
            {
                type: 'Statistical',
                name: 'FISHER',
                syntax: 'FISHER(val)',
                example: '=FISHER(0.5)',
                desc: 'Returns the Fisher transformation of a specified value.',
                data: { A1: 0.5, target: 'B1', formula: '=FISHER(A1)', result: 0.549, highlight: ['A1'], steps: ["Fisher transform.", "Result ~0.549."] }
            },
            {
                type: 'Statistical',
                name: 'FISHERINV',
                syntax: 'FISHERINV(val)',
                example: '=FISHERINV(0.549)',
                desc: 'Returns the inverse Fisher transformation of a specified value.',
                data: { A1: 0.549, target: 'B1', formula: '=FISHERINV(A1)', result: 0.5, highlight: ['A1'], steps: ["Inv Fisher.", "Result ~0.5."] }
            },
            {
                type: 'Statistical',
                name: 'FORECAST',
                syntax: 'FORECAST(x, y, x_vals)',
                example: '=FORECAST(3, A1:A2, B1:B2)',
                desc: 'Calculates the expected y-value for a specified x based on linear regression.',
                data: { A1: 1, A2: 3, B1: 1, B2: 2, target: 'C1', formula: '=FORECAST(3, A1:A2, B1:B2)', result: 5, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Linear trend.", "Result 5."] }
            },
            {
                type: 'Statistical',
                name: 'FORECAST.LINEAR',
                syntax: 'FORECAST.LINEAR(x, y, x_vals)',
                example: '=FORECAST.LINEAR(3, A1:A2, B1:B2)',
                desc: 'See FORECAST.',
                data: { A1: 1, A2: 3, B1: 1, B2: 2, target: 'C1', formula: '=FORECAST.LINEAR(3, A1:A2, B1:B2)', result: 5, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Linear trend.", "Result 5."] }
            },
            {
                type: 'Statistical',
                name: 'FTEST',
                syntax: 'FTEST(range1, range2)',
                example: '=FTEST(A1:A2, B1:B2)',
                desc: 'See F.TEST.',
                data: { A1: 1, A2: 2, B1: 2, B2: 4, target: 'C1', formula: '=FTEST(A1:A2, B1:B2)', result: 0.5, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Legacy F-Test.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'GAMMA',
                syntax: 'GAMMA(val)',
                example: '=GAMMA(5)',
                desc: 'Returns the Gamma function evaluated at the specified value.',
                data: { A1: 5, target: 'B1', formula: '=GAMMA(A1)', result: 24, highlight: ['A1'], steps: ["Gamma(5) = 4!", "Result 24."] }
            },
            {
                type: 'Statistical',
                name: 'GAMMA.DIST',
                syntax: 'GAMMA.DIST(x, alpha, beta, cum)',
                example: '=GAMMA.DIST(10, 9, 2, TRUE)',
                desc: 'Calculates the gamma distribution.',
                data: { A1: 10, target: 'B1', formula: '=GAMMA.DIST(A1, 9, 2, TRUE)', result: 0.068, highlight: ['A1'], steps: ["Gamma Dist.", "Result ~0.068."] }
            },
            {
                type: 'Statistical',
                name: 'GAMMA.INV',
                syntax: 'GAMMA.INV(prob, alpha, beta)',
                example: '=GAMMA.INV(0.068, 9, 2)',
                desc: 'Returns the inverse gamma cumulative distribution function.',
                data: { A1: 0.068, target: 'B1', formula: '=GAMMA.INV(A1, 9, 2)', result: 10, highlight: ['A1'], steps: ["Inv Gamma.", "Result ~10."] }
            },
            {
                type: 'Statistical',
                name: 'GAMMADIST',
                syntax: 'GAMMADIST(x, alpha, beta, cum)',
                example: '=GAMMADIST(10, 9, 2, TRUE)',
                desc: 'See GAMMA.DIST.',
                data: { A1: 10, target: 'B1', formula: '=GAMMADIST(A1, 9, 2, TRUE)', result: 0.068, highlight: ['A1'], steps: ["Legacy Gamma.", "Result ~0.068."] }
            },
            {
                type: 'Statistical',
                name: 'GAMMAINV',
                syntax: 'GAMMAINV(prob, alpha, beta)',
                example: '=GAMMAINV(0.068, 9, 2)',
                desc: 'See GAMMA.INV.',
                data: { A1: 0.068, target: 'B1', formula: '=GAMMAINV(A1, 9, 2)', result: 10, highlight: ['A1'], steps: ["Legacy Inv Gamma.", "Result ~10."] }
            },
            {
                type: 'Statistical',
                name: 'GAUSS',
                syntax: 'GAUSS(z)',
                example: '=GAUSS(2)',
                desc: 'Returns the probability that a random variable will be between the mean and z standard deviations.',
                data: { A1: 2, target: 'B1', formula: '=GAUSS(A1)', result: 0.477, highlight: ['A1'], steps: ["Gauss Dist.", "Result ~0.477."] }
            },
            {
                type: 'Statistical',
                name: 'GEOMEAN',
                syntax: 'GEOMEAN(val1, [val2, ...])',
                example: '=GEOMEAN(4, 9)',
                desc: 'Calculates the geometric mean of a dataset.',
                data: { A1: 4, B1: 9, target: 'C1', formula: '=GEOMEAN(A1, B1)', result: 6, highlight: ['A1', 'B1'], steps: ["Sqrt(4*9).", "Result 6."] }
            },
            {
                type: 'Statistical',
                name: 'HARMEAN',
                syntax: 'HARMEAN(val1, [val2, ...])',
                example: '=HARMEAN(4, 9)',
                desc: 'Calculates the harmonic mean of a dataset.',
                data: { A1: 4, B1: 9, target: 'C1', formula: '=HARMEAN(A1, B1)', result: 5.54, highlight: ['A1', 'B1'], steps: ["Harmonic Mean.", "Result ~5.54."] }
            },
            {
                type: 'Statistical',
                name: 'HYPGEOM.DIST',
                syntax: 'HYPGEOM.DIST(succ, draws, M, N)',
                example: '=HYPGEOM.DIST(1, 4, 8, 20)',
                desc: 'Calculates the probability of drawing a certain number of successes...',
                data: { A1: 1, target: 'B1', formula: '=HYPGEOM.DIST(A1, 4, 8, 20)', result: 0.363, highlight: ['A1'], steps: ["Hypergeom Dist.", "Result ~0.363."] }
            },
            {
                type: 'Statistical',
                name: 'HYPGEOMDIST',
                syntax: 'HYPGEOMDIST(succ, draws, M, N)',
                example: '=HYPGEOMDIST(1, 4, 8, 20)',
                desc: 'See HYPGEOM.DIST.',
                data: { A1: 1, target: 'B1', formula: '=HYPGEOMDIST(A1, 4, 8, 20)', result: 0.363, highlight: ['A1'], steps: ["Legacy func.", "Result ~0.363."] }
            },
            {
                type: 'Statistical',
                name: 'INTERCEPT',
                syntax: 'INTERCEPT(y, x)',
                example: '=INTERCEPT(A1:A3, B1:B3)',
                desc: 'Calculates the y-intercept of the linear regression line.',
                data: { A1: 2, A2: 3, B1: 1, B2: 2, target: 'C1', formula: '=INTERCEPT(A1:A2, B1:B2)', result: 1, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Linear Intercept.", "Result 1."] }
            },
            {
                type: 'Statistical',
                name: 'KURT',
                syntax: 'KURT(val1, [val2...])',
                example: '=KURT(1, 2, 3, 4)',
                desc: 'Calculates the kurtosis of a dataset.',
                data: { A1: 1, A2: 2, A3: 3, A4: 4, target: 'B1', formula: '=KURT(A1:A4)', result: -1.2, highlight: ['A1', 'A2', 'A3', 'A4'], steps: ["Kurtosis.", "Result -1.2."] }
            },
            {
                type: 'Statistical',
                name: 'LARGE',
                syntax: 'LARGE(data, n)',
                example: '=LARGE(A1:A3, 2)',
                desc: 'Returns the nth largest element from a data set.',
                data: { A1: 10, A2: 50, A3: 20, target: 'B1', formula: '=LARGE(A1:A3, 2)', result: 20, highlight: ['A1', 'A2', 'A3'], steps: ["Sort: 50, 20, 10.", "2nd is 20."] }
            },
            {
                type: 'Statistical',
                name: 'LOGINV',
                syntax: 'LOGINV(prob, mean, std_dev)',
                example: '=LOGINV(0.5, 0, 1)',
                desc: 'Returns the value of the inverse log-normal cumulative distribution.',
                data: { A1: 0.5, target: 'B1', formula: '=LOGINV(A1, 0, 1)', result: 1, highlight: ['A1'], steps: ["Inv LogNorm.", "Result 1."] }
            },
            {
                type: 'Statistical',
                name: 'LOGNORM.DIST',
                syntax: 'LOGNORM.DIST(x, mean, std, cum)',
                example: '=LOGNORM.DIST(1, 0, 1, TRUE)',
                desc: 'Returns the value of the log-normal cumulative distribution.',
                data: { A1: 1, target: 'B1', formula: '=LOGNORM.DIST(A1, 0, 1, TRUE)', result: 0.5, highlight: ['A1'], steps: ["LogNorm Dist.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'LOGNORM.INV',
                syntax: 'LOGNORM.INV(prob, mean, std)',
                example: '=LOGNORM.INV(0.5, 0, 1)',
                desc: 'See LOGINV.',
                data: { A1: 0.5, target: 'B1', formula: '=LOGNORM.INV(A1, 0, 1)', result: 1, highlight: ['A1'], steps: ["Inv LogNorm.", "Result 1."] }
            },
            {
                type: 'Statistical',
                name: 'LOGNORMDIST',
                syntax: 'LOGNORMDIST(x, mean, std)',
                example: '=LOGNORMDIST(1, 0, 1)',
                desc: 'Returns the value of the log-normal cumulative distribution.',
                data: { A1: 1, target: 'B1', formula: '=LOGNORMDIST(A1, 0, 1)', result: 0.5, highlight: ['A1'], steps: ["Legacy func.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'MARGINOFERROR',
                syntax: 'MARGINOFERROR(range, conf)',
                example: '=MARGINOFERROR(A1:A10, 0.95)',
                desc: 'Calculates the amount of random sampling error.',
                data: { A1: 10, A2: 20, target: 'B1', formula: '=MARGINOFERROR(A1:A2, 0.95)', result: 13.8, highlight: ['A1', 'A2'], steps: ["Margin Error.", "Result ~13.8."] }
            },
            {
                type: 'Statistical',
                name: 'MAX',
                syntax: 'MAX(val1, [val2, ...])',
                example: '=MAX(1, 5, 2)',
                desc: 'Returns the maximum value in a numeric dataset.',
                data: { A1: 1, A2: 5, A3: 2, target: 'B1', formula: '=MAX(A1:A3)', result: 5, highlight: ['A1', 'A2', 'A3'], steps: ["Check 1, 5, 2.", "Max is 5."] }
            },
            {
                type: 'Statistical',
                name: 'MAXA',
                syntax: 'MAXA(val1, [val2, ...])',
                example: '=MAXA(1, "5", 2)',
                desc: 'Returns the maximum numeric value in a dataset.',
                data: { A1: 1, A2: 5, A3: 2, target: 'B1', formula: '=MAXA(A1:A3)', result: 5, highlight: ['A1', 'A2', 'A3'], steps: ["Max is 5."] }
            },
            {
                type: 'Statistical',
                name: 'MAXIFS',
                syntax: 'MAXIFS(range, crit_rng, crit...)',
                example: '=MAXIFS(A1:A3, A1:A3, ">3")',
                desc: 'Returns the maximum value in a range of cells, filtered by criteria.',
                data: { A1: 10, A2: 5, A3: 20, target: 'B1', formula: '=MAXIFS(A1:A3, A1:A3, ">8")', result: 20, highlight: ['A1', 'A2', 'A3'], steps: ["Filter >8: 10, 20.", "Max is 20."] }
            },
            {
                type: 'Statistical',
                name: 'MEDIAN',
                syntax: 'MEDIAN(val1, [val2, ...])',
                example: '=MEDIAN(1, 5, 2)',
                desc: 'Returns the median value in a numeric dataset.',
                data: { A1: 1, A2: 5, A3: 2, target: 'B1', formula: '=MEDIAN(A1:A3)', result: 2, highlight: ['A1', 'A2', 'A3'], steps: ["Sort: 1, 2, 5.", "Mid is 2."] }
            },
            {
                type: 'Statistical',
                name: 'MIN',
                syntax: 'MIN(val1, [val2, ...])',
                example: '=MIN(1, 5, 2)',
                desc: 'Returns the minimum value in a numeric dataset.',
                data: { A1: 1, A2: 5, A3: 2, target: 'B1', formula: '=MIN(A1:A3)', result: 1, highlight: ['A1', 'A2', 'A3'], steps: ["Check 1, 5, 2.", "Min is 1."] }
            },
            {
                type: 'Statistical',
                name: 'MINA',
                syntax: 'MINA(val1, [val2, ...])',
                example: '=MINA(1, 5, 2)',
                desc: 'Returns the minimum numeric value in a dataset.',
                data: { A1: 1, A2: 5, A3: 2, target: 'B1', formula: '=MINA(A1:A3)', result: 1, highlight: ['A1', 'A2', 'A3'], steps: ["Min is 1."] }
            },
            {
                type: 'Statistical',
                name: 'MINIFS',
                syntax: 'MINIFS(range, crit_rng, crit...)',
                example: '=MINIFS(A1:A3, A1:A3, ">3")',
                desc: 'Returns the minimum value in a range of cells, filtered by criteria.',
                data: { A1: 1, A2: 5, A3: 20, target: 'B1', formula: '=MINIFS(A1:A3, A1:A3, ">3")', result: 5, highlight: ['A1', 'A2', 'A3'], steps: ["Filter >3: 5, 20.", "Min is 5."] }
            },
            {
                type: 'Statistical',
                name: 'MODE',
                syntax: 'MODE(val1, [val2, ...])',
                example: '=MODE(1, 2, 2, 3)',
                desc: 'Returns the most commonly occurring value in a dataset.',
                data: { A1: 1, A2: 2, A3: 2, A4: 3, target: 'B1', formula: '=MODE(A1:A4)', result: 2, highlight: ['A1', 'A2', 'A3', 'A4'], steps: ["Count freq.", "2 appears twice.", "Result 2."] }
            },
            {
                type: 'Statistical',
                name: 'MODE.MULT',
                syntax: 'MODE.MULT(val1, [val2...])',
                example: '=MODE.MULT(1, 2, 2, 3, 3)',
                desc: 'Returns the most commonly occurring values.',
                data: { A1: 1, A2: 2, A3: 2, A4: 3, target: 'B1', formula: '=MODE.MULT(A1:A4)', result: 2, highlight: ['A1', 'A2', 'A3', 'A4'], steps: ["2 & 3 modes.", "Returns 2 (first)."] }
            },
            {
                type: 'Statistical',
                name: 'MODE.SNGL',
                syntax: 'MODE.SNGL(val1, [val2...])',
                example: '=MODE.SNGL(1, 2, 2, 3)',
                desc: 'See MODE.',
                data: { A1: 1, A2: 2, A3: 2, A4: 3, target: 'B1', formula: '=MODE.SNGL(A1:A4)', result: 2, highlight: ['A1', 'A2', 'A3', 'A4'], steps: ["Single mode.", "Result 2."] }
            },
            {
                type: 'Statistical',
                name: 'NEGBINOM.DIST',
                syntax: 'NEGBINOM.DIST(fail, succ, prob)',
                example: '=NEGBINOM.DIST(10, 5, 0.25)',
                desc: 'Calculates the probability of drawing a certain number of failures...',
                data: { A1: 10, target: 'B1', formula: '=NEGBINOM.DIST(A1, 5, 0.25)', result: 0.055, highlight: ['A1'], steps: ["Neg Binom.", "Result ~0.055."] }
            },
            {
                type: 'Statistical',
                name: 'NEGBINOMDIST',
                syntax: 'NEGBINOMDIST(fail, succ, prob)',
                example: '=NEGBINOMDIST(10, 5, 0.25)',
                desc: 'See NEGBINOM.DIST.',
                data: { A1: 10, target: 'B1', formula: '=NEGBINOMDIST(A1, 5, 0.25)', result: 0.055, highlight: ['A1'], steps: ["Legacy func.", "Result ~0.055."] }
            },
            {
                type: 'Statistical',
                name: 'NORM.DIST',
                syntax: 'NORM.DIST(x, mean, std, cum)',
                example: '=NORM.DIST(0, 0, 1, TRUE)',
                desc: 'Returns the value of the normal distribution function.',
                data: { A1: 0, target: 'B1', formula: '=NORM.DIST(A1, 0, 1, TRUE)', result: 0.5, highlight: ['A1'], steps: ["Norm Dist.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'NORM.INV',
                syntax: 'NORM.INV(prob, mean, std)',
                example: '=NORM.INV(0.5, 0, 1)',
                desc: 'Returns the value of the inverse normal distribution.',
                data: { A1: 0.5, target: 'B1', formula: '=NORM.INV(A1, 0, 1)', result: 0, highlight: ['A1'], steps: ["Inv Norm.", "Result 0."] }
            },
            {
                type: 'Statistical',
                name: 'NORM.S.DIST',
                syntax: 'NORM.S.DIST(z)',
                example: '=NORM.S.DIST(0)',
                desc: 'Returns the standard normal cumulative distribution.',
                data: { A1: 0, target: 'B1', formula: '=NORM.S.DIST(A1)', result: 0.5, highlight: ['A1'], steps: ["Std Norm Dist.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'NORM.S.INV',
                syntax: 'NORM.S.INV(prob)',
                example: '=NORM.S.INV(0.5)',
                desc: 'Returns the inverse standard normal distribution.',
                data: { A1: 0.5, target: 'B1', formula: '=NORM.S.INV(A1)', result: 0, highlight: ['A1'], steps: ["Inv Std Norm.", "Result 0."] }
            },
            {
                type: 'Statistical',
                name: 'NORMDIST',
                syntax: 'NORMDIST(x, mean, std, cum)',
                example: '=NORMDIST(0, 0, 1, TRUE)',
                desc: 'See NORM.DIST.',
                data: { A1: 0, target: 'B1', formula: '=NORMDIST(A1, 0, 1, TRUE)', result: 0.5, highlight: ['A1'], steps: ["Legacy func.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'NORMINV',
                syntax: 'NORMINV(prob, mean, std)',
                example: '=NORMINV(0.5, 0, 1)',
                desc: 'See NORM.INV.',
                data: { A1: 0.5, target: 'B1', formula: '=NORMINV(A1, 0, 1)', result: 0, highlight: ['A1'], steps: ["Legacy func.", "Result 0."] }
            },
            {
                type: 'Statistical',
                name: 'NORMSDIST',
                syntax: 'NORMSDIST(z)',
                example: '=NORMSDIST(0)',
                desc: 'See NORM.S.DIST.',
                data: { A1: 0, target: 'B1', formula: '=NORMSDIST(A1)', result: 0.5, highlight: ['A1'], steps: ["Legacy func.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'NORMSINV',
                syntax: 'NORMSINV(prob)',
                example: '=NORMSINV(0.5)',
                desc: 'See NORM.S.INV.',
                data: { A1: 0.5, target: 'B1', formula: '=NORMSINV(A1)', result: 0, highlight: ['A1'], steps: ["Legacy func.", "Result 0."] }
            },
            {
                type: 'Statistical',
                name: 'PEARSON',
                syntax: 'PEARSON(y, x)',
                example: '=PEARSON(A1:A2, B1:B2)',
                desc: 'Calculates r, the Pearson product-moment correlation coefficient.',
                data: { A1: 1, A2: 2, B1: 2, B2: 4, target: 'C1', formula: '=PEARSON(A1:A2, B1:B2)', result: 1, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Pearson calc.", "Result 1."] }
            },
            {
                type: 'Statistical',
                name: 'PERCENTILE',
                syntax: 'PERCENTILE(data, k)',
                example: '=PERCENTILE(A1:A3, 0.5)',
                desc: 'Returns the value at a given percentile of a dataset.',
                data: { A1: 1, A2: 5, A3: 9, target: 'B1', formula: '=PERCENTILE(A1:A3, 0.5)', result: 5, highlight: ['A1', 'A2', 'A3'], steps: ["Median is 50%.", "Result 5."] }
            },
            {
                type: 'Statistical',
                name: 'PERCENTILE.EXC',
                syntax: 'PERCENTILE.EXC(data, k)',
                example: '=PERCENTILE.EXC(A1:A3, 0.5)',
                desc: 'Returns the value at a given percentile, exclusive of 0 and 1.',
                data: { A1: 1, A2: 5, A3: 9, target: 'B1', formula: '=PERCENTILE.EXC(A1:A3, 0.5)', result: 5, highlight: ['A1', 'A2', 'A3'], steps: ["Median (exc).", "Result 5."] }
            },
            {
                type: 'Statistical',
                name: 'PERCENTILE.INC',
                syntax: 'PERCENTILE.INC(data, k)',
                example: '=PERCENTILE.INC(A1:A3, 0.5)',
                desc: 'See PERCENTILE.',
                data: { A1: 1, A2: 5, A3: 9, target: 'B1', formula: '=PERCENTILE.INC(A1:A3, 0.5)', result: 5, highlight: ['A1', 'A2', 'A3'], steps: ["Median (inc).", "Result 5."] }
            },
            {
                type: 'Statistical',
                name: 'PERCENTRANK',
                syntax: 'PERCENTRANK(data, x, [sig])',
                example: '=PERCENTRANK(A1:A3, 5)',
                desc: 'Returns the percentage rank of a specified value in a dataset.',
                data: { A1: 1, A2: 5, A3: 9, target: 'B1', formula: '=PERCENTRANK(A1:A3, 5)', result: 0.5, highlight: ['A1', 'A2', 'A3'], steps: ["Rank of 5.", "Result 50%."] }
            },
            {
                type: 'Statistical',
                name: 'PERCENTRANK.EXC',
                syntax: 'PERCENTRANK.EXC(data, x, [sig])',
                example: '=PERCENTRANK.EXC(A1:A3, 5)',
                desc: 'Returns the percentage rank (0 to 1 exclusive) of a specified value.',
                data: { A1: 1, A2: 5, A3: 9, target: 'B1', formula: '=PERCENTRANK.EXC(A1:A3, 5)', result: 0.5, highlight: ['A1', 'A2', 'A3'], steps: ["Rank Exc.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'PERCENTRANK.INC',
                syntax: 'PERCENTRANK.INC(data, x, [sig])',
                example: '=PERCENTRANK.INC(A1:A3, 5)',
                desc: 'Returns the percentage rank (0 to 1 inclusive) of a specified value.',
                data: { A1: 1, A2: 5, A3: 9, target: 'B1', formula: '=PERCENTRANK.INC(A1:A3, 5)', result: 0.5, highlight: ['A1', 'A2', 'A3'], steps: ["Rank Inc.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'PERMUTATIONA',
                syntax: 'PERMUTATIONA(n, k)',
                example: '=PERMUTATIONA(3, 2)',
                desc: 'Returns number of permutations for selecting objects (with replacement).',
                data: { A1: 3, B1: 2, target: 'C1', formula: '=PERMUTATIONA(3, 2)', result: 9, highlight: ['A1', 'B1'], steps: ["3^2.", "Result 9."] }
            },
            {
                type: 'Statistical',
                name: 'PERMUT',
                syntax: 'PERMUT(n, k)',
                example: '=PERMUT(3, 2)',
                desc: 'Returns number of ways to choose objects from a pool (ordered).',
                data: { A1: 3, B1: 2, target: 'C1', formula: '=PERMUT(3, 2)', result: 6, highlight: ['A1', 'B1'], steps: ["3! / (3-2)!.", "Result 6."] }
            },
            {
                type: 'Statistical',
                name: 'PHI',
                syntax: 'PHI(x)',
                example: '=PHI(0)',
                desc: 'Returns the value of the normal distribution with mean 0 and std dev 1.',
                data: { A1: 0, target: 'B1', formula: '=PHI(0)', result: 0.3989, highlight: ['A1'], steps: ["Std Norm PDF.", "Result ~0.3989."] }
            },
            {
                type: 'Statistical',
                name: 'POISSON',
                syntax: 'POISSON(x, mean, cum)',
                example: '=POISSON(2, 5, TRUE)',
                desc: 'See POISSON.DIST.',
                data: { A1: 2, target: 'B1', formula: '=POISSON(2, 5, TRUE)', result: 0.124, highlight: ['A1'], steps: ["Legacy func.", "Result ~0.124."] }
            },
            {
                type: 'Statistical',
                name: 'POISSON.DIST',
                syntax: 'POISSON.DIST(x, mean, cum)',
                example: '=POISSON.DIST(2, 5, TRUE)',
                desc: 'Returns the value of the Poisson distribution function.',
                data: { A1: 2, target: 'B1', formula: '=POISSON.DIST(2, 5, TRUE)', result: 0.124, highlight: ['A1'], steps: ["Poisson Dist.", "Result ~0.124."] }
            },
            {
                type: 'Statistical',
                name: 'PROB',
                syntax: 'PROB(vals, probs, low, [high])',
                example: '=PROB(A1:A2, B1:B2, 1, 2)',
                desc: 'Calculates probability that a value falls between two limits.',
                data: { A1: 1, A2: 2, B1: 0.5, B2: 0.5, target: 'C1', formula: '=PROB(A1:A2, B1:B2, 1, 2)', result: 1, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Sum probs.", "0.5 + 0.5.", "Result 1."] }
            },
            {
                type: 'Statistical',
                name: 'QUARTILE',
                syntax: 'QUARTILE(data, q)',
                example: '=QUARTILE(A1:A4, 2)',
                desc: 'Returns the quartile of a dataset.',
                data: { A1: 1, A2: 2, A3: 3, A4: 4, target: 'B1', formula: '=QUARTILE(A1:A4, 2)', result: 2.5, highlight: ['A1', 'A2', 'A3', 'A4'], steps: ["Median.", "Result 2.5."] }
            },
            {
                type: 'Statistical',
                name: 'QUARTILE.EXC',
                syntax: 'QUARTILE.EXC(data, q)',
                example: '=QUARTILE.EXC(A1:A4, 2)',
                desc: 'Returns quartile of a dataset, exclusive of 0 and 4.',
                data: { A1: 1, A2: 2, A3: 3, A4: 4, target: 'B1', formula: '=QUARTILE.EXC(A1:A4, 2)', result: 2.5, highlight: ['A1', 'A2', 'A3', 'A4'], steps: ["Median (exc).", "Result 2.5."] }
            },
            {
                type: 'Statistical',
                name: 'QUARTILE.INC',
                syntax: 'QUARTILE.INC(data, q)',
                example: '=QUARTILE.INC(A1:A4, 2)',
                desc: 'See QUARTILE.',
                data: { A1: 1, A2: 2, A3: 3, A4: 4, target: 'B1', formula: '=QUARTILE.INC(A1:A4, 2)', result: 2.5, highlight: ['A1', 'A2', 'A3', 'A4'], steps: ["Median (inc).", "Result 2.5."] }
            },
            {
                type: 'Statistical',
                name: 'RANK',
                syntax: 'RANK(val, data, [order])',
                example: '=RANK(5, A1:A3)',
                desc: 'Returns the rank of a specified value in a dataset.',
                data: { A1: 1, A2: 5, A3: 9, target: 'B1', formula: '=RANK(5, A1:A3)', result: 2, highlight: ['A1', 'A2', 'A3'], steps: ["9 is #1.", "5 is #2.", "Result 2."] }
            },
            {
                type: 'Statistical',
                name: 'RANK.AVG',
                syntax: 'RANK.AVG(val, data, [order])',
                example: '=RANK.AVG(5, A1:A4)',
                desc: 'Returns average rank if values are equal.',
                data: { A1: 5, A2: 5, A3: 9, A4: 1, target: 'B1', formula: '=RANK.AVG(5, A1:A4)', result: 2.5, highlight: ['A1', 'A2', 'A3', 'A4'], steps: ["5s are #2 & #3.", "Avg is 2.5."] }
            },
            {
                type: 'Statistical',
                name: 'RANK.EQ',
                syntax: 'RANK.EQ(val, data, [order])',
                example: '=RANK.EQ(5, A1:A4)',
                desc: 'Returns top rank if values are equal.',
                data: { A1: 5, A2: 5, A3: 9, A4: 1, target: 'B1', formula: '=RANK.EQ(5, A1:A4)', result: 2, highlight: ['A1', 'A2', 'A3', 'A4'], steps: ["5s start at #2.", "Result 2."] }
            },
            {
                type: 'Statistical',
                name: 'RSQ',
                syntax: 'RSQ(y, x)',
                example: '=RSQ(A1:A3, B1:B3)',
                desc: 'Calculates the square of r, the Pearson correlation coefficient.',
                data: { A1: 1, A2: 2, A3: 3, B1: 2, B2: 4, B3: 6, target: 'C1', formula: '=RSQ(A1:A3, B1:B3)', result: 1, highlight: ['A1', 'A2', 'A3', 'B1', 'B2', 'B3'], steps: ["Perfect correlation.", "r=1, r^2=1.", "Result 1."] }
            },
            {
                type: 'Statistical',
                name: 'SKEW',
                syntax: 'SKEW(val1, [val2...])',
                example: '=SKEW(1, 2, 3, 10)',
                desc: 'Calculates the skewness of a dataset.',
                data: { A1: 1, A2: 2, A3: 3, A4: 10, target: 'B1', formula: '=SKEW(A1:A4)', result: 1.9, highlight: ['A1', 'A2', 'A3', 'A4'], steps: ["Pos skew.", "Result ~1.9."] }
            },
            {
                type: 'Statistical',
                name: 'SKEW.P',
                syntax: 'SKEW.P(val1, [val2...])',
                example: '=SKEW.P(1, 2, 3, 10)',
                desc: 'Calculates the skewness of a population.',
                data: { A1: 1, A2: 2, A3: 3, A4: 10, target: 'B1', formula: '=SKEW.P(A1:A4)', result: 1.6, highlight: ['A1', 'A2', 'A3', 'A4'], steps: ["Pop Skew.", "Result ~1.6."] }
            },
            {
                type: 'Statistical',
                name: 'SLOPE',
                syntax: 'SLOPE(y, x)',
                example: '=SLOPE(A1:A3, B1:B3)',
                desc: 'Calculates the slope of the linear regression line.',
                data: { A1: 2, A2: 4, A3: 6, B1: 1, B2: 2, B3: 3, target: 'C1', formula: '=SLOPE(A1:A3, B1:B3)', result: 2, highlight: ['A1', 'A2', 'A3', 'B1', 'B2', 'B3'], steps: ["Linear Slope.", "Rise/Run = 2.", "Result 2."] }
            },
            {
                type: 'Statistical',
                name: 'SMALL',
                syntax: 'SMALL(data, n)',
                example: '=SMALL(A1:A3, 2)',
                desc: 'Returns the nth smallest element from a data set.',
                data: { A1: 10, A2: 50, A3: 20, target: 'B1', formula: '=SMALL(A1:A3, 2)', result: 20, highlight: ['A1', 'A2', 'A3'], steps: ["Sort: 10, 20, 50.", "2nd is 20."] }
            },
            {
                type: 'Statistical',
                name: 'STANDARDIZE',
                syntax: 'STANDARDIZE(x, mean, std)',
                example: '=STANDARDIZE(5, 2, 1)',
                desc: 'Calculates the normalized equivalent of a random variable (Z-score).',
                data: { A1: 5, target: 'B1', formula: '=STANDARDIZE(A1, 2, 1)', result: 3, highlight: ['A1'], steps: ["(5-2)/1.", "Result 3."] }
            },
            {
                type: 'Statistical',
                name: 'STDEV',
                syntax: 'STDEV(val1, [val2...])',
                example: '=STDEV(1, 5)',
                desc: 'Calculates the standard deviation based on a sample.',
                data: { A1: 1, A2: 5, target: 'B1', formula: '=STDEV(A1:A2)', result: 2.83, highlight: ['A1', 'A2'], steps: ["Sample Std Dev.", "Result ~2.83."] }
            },
            {
                type: 'Statistical',
                name: 'STDEV.P',
                syntax: 'STDEV.P(val1, [val2...])',
                example: '=STDEV.P(1, 5)',
                desc: 'See STDEVP.',
                data: { A1: 1, A2: 5, target: 'B1', formula: '=STDEV.P(A1:A2)', result: 2, highlight: ['A1', 'A2'], steps: ["Pop Std Dev.", "Result 2."] }
            },
            {
                type: 'Statistical',
                name: 'STDEV.S',
                syntax: 'STDEV.S(val1, [val2...])',
                example: '=STDEV.S(1, 5)',
                desc: 'See STDEV.',
                data: { A1: 1, A2: 5, target: 'B1', formula: '=STDEV.S(A1:A2)', result: 2.83, highlight: ['A1', 'A2'], steps: ["Sample Std Dev.", "Result ~2.83."] }
            },
            {
                type: 'Statistical',
                name: 'STDEVA',
                syntax: 'STDEVA(val1, [val2...])',
                example: '=STDEVA(1, "5")',
                desc: 'Calculates std dev based on a sample, setting text to 0.',
                data: { A1: 1, A2: "Text", target: 'B1', formula: '=STDEVA(A1:A2)', result: 0.71, highlight: ['A1', 'A2'], steps: ["Text is 0.", "Sample SD(1,0).", "Result ~0.71."] }
            },
            {
                type: 'Statistical',
                name: 'STDEVP',
                syntax: 'STDEVP(val1, [val2...])',
                example: '=STDEVP(1, 5)',
                desc: 'Calculates the standard deviation based on an entire population.',
                data: { A1: 1, A2: 5, target: 'B1', formula: '=STDEVP(A1:A2)', result: 2, highlight: ['A1', 'A2'], steps: ["Pop Std Dev.", "Result 2."] }
            },
            {
                type: 'Statistical',
                name: 'STDEVPA',
                syntax: 'STDEVPA(val1, [val2...])',
                example: '=STDEVPA(1, "5")',
                desc: 'Calculates pop std dev, setting text to 0.',
                data: { A1: 1, A2: "Text", target: 'B1', formula: '=STDEVPA(A1:A2)', result: 0.5, highlight: ['A1', 'A2'], steps: ["Text is 0.", "Pop SD(1,0).", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'STEYX',
                syntax: 'STEYX(y, x)',
                example: '=STEYX(A1:A3, B1:B3)',
                desc: 'Calculates the standard error of the predicted y-value for each x in the regression.',
                data: { A1: 2, A2: 3, B1: 1, B2: 2, target: 'C1', formula: '=STEYX(A1:A2, B1:B2)', result: 0, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Perfect fit error.", "Result 0."] }
            },
            {
                type: 'Statistical',
                name: 'T.DIST',
                syntax: 'T.DIST(x, deg, cum)',
                example: '=T.DIST(1.96, 60, TRUE)',
                desc: 'Returns the right tailed Student distribution for a value x.',
                data: { A1: 1.96, target: 'B1', formula: '=T.DIST(A1, 60, TRUE)', result: 0.97, highlight: ['A1'], steps: ["T-Dist.", "Result ~0.97."] }
            },
            {
                type: 'Statistical',
                name: 'T.DIST.2T',
                syntax: 'T.DIST.2T(x, deg)',
                example: '=T.DIST.2T(1.96, 60)',
                desc: 'Returns the two tailed Student distribution for a value x.',
                data: { A1: 1.96, target: 'B1', formula: '=T.DIST.2T(A1, 60)', result: 0.05, highlight: ['A1'], steps: ["T-Dist 2T.", "Result ~0.05."] }
            },
            {
                type: 'Statistical',
                name: 'T.DIST.RT',
                syntax: 'T.DIST.RT(x, deg)',
                example: '=T.DIST.RT(1.96, 60)',
                desc: 'Returns the right tailed Student distribution for a value x.',
                data: { A1: 1.96, target: 'B1', formula: '=T.DIST.RT(A1, 60)', result: 0.025, highlight: ['A1'], steps: ["T-Dist RT.", "Result ~0.025."] }
            },
            {
                type: 'Statistical',
                name: 'T.INV',
                syntax: 'T.INV(prob, deg)',
                example: '=T.INV(0.975, 60)',
                desc: 'Calculates the negative inverse of the one-tailed TDIST function.',
                data: { A1: 0.975, target: 'B1', formula: '=T.INV(A1, 60)', result: 1.96, highlight: ['A1'], steps: ["Inv T-Dist.", "Result ~1.96."] }
            },
            {
                type: 'Statistical',
                name: 'T.INV.2T',
                syntax: 'T.INV.2T(prob, deg)',
                example: '=T.INV.2T(0.05, 60)',
                desc: 'Calculates the inverse of the two-tailed TDIST function.',
                data: { A1: 0.05, target: 'B1', formula: '=T.INV.2T(A1, 60)', result: 2, highlight: ['A1'], steps: ["Inv T-2T.", "Result ~2."] }
            },
            {
                type: 'Statistical',
                name: 'T.TEST',
                syntax: 'T.TEST(r1, r2, tails, type)',
                example: '=T.TEST(A1:A2, B1:B2, 2, 1)',
                desc: 'Returns the probability associated with Student\'s t-test.',
                data: { A1: 1, A2: 2, B1: 2, B2: 3, target: 'C1', formula: '=T.TEST(A1:A2, B1:B2, 2, 1)', result: 0.3, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["T-Test.", "Result ~0.3."] }
            },
            {
                type: 'Statistical',
                name: 'TDIST',
                syntax: 'TDIST(x, deg, tails)',
                example: '=TDIST(1.96, 60, 2)',
                desc: 'Calculates the probability for Student\'s t-distribution.',
                data: { A1: 1.96, target: 'B1', formula: '=TDIST(A1, 60, 2)', result: 0.05, highlight: ['A1'], steps: ["Legacy T-Dist.", "Result ~0.05."] }
            },
            {
                type: 'Statistical',
                name: 'TINV',
                syntax: 'TINV(prob, deg)',
                example: '=TINV(0.05, 60)',
                desc: 'See T.INV.2T.',
                data: { A1: 0.05, target: 'B1', formula: '=TINV(A1, 60)', result: 2, highlight: ['A1'], steps: ["Legacy Inv T.", "Result ~2."] }
            },
            {
                type: 'Statistical',
                name: 'TRIMMEAN',
                syntax: 'TRIMMEAN(data, prop)',
                example: '=TRIMMEAN(A1:A4, 0.5)',
                desc: 'Calculates mean excluding outliers.',
                data: { A1: 1, A2: 2, A3: 3, A4: 100, target: 'B1', formula: '=TRIMMEAN(A1:A4, 0.5)', result: 2.5, highlight: ['A1', 'A2', 'A3', 'A4'], steps: ["Exclude 1 & 100.", "Avg(2,3).", "Result 2.5."] }
            },
            {
                type: 'Statistical',
                name: 'TTEST',
                syntax: 'TTEST(r1, r2, tails, type)',
                example: '=TTEST(A1:A2, B1:B2, 2, 1)',
                desc: 'See T.TEST.',
                data: { A1: 1, A2: 2, B1: 2, B2: 3, target: 'C1', formula: '=TTEST(A1:A2, B1:B2, 2, 1)', result: 0.3, highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Legacy T-Test.", "Result ~0.3."] }
            },
            {
                type: 'Statistical',
                name: 'VAR',
                syntax: 'VAR(val1, [val2...])',
                example: '=VAR(1, 5)',
                desc: 'Calculates the variance based on a sample.',
                data: { A1: 1, A2: 5, target: 'B1', formula: '=VAR(A1:A2)', result: 8, highlight: ['A1', 'A2'], steps: ["Sample Var.", "Result 8."] }
            },
            {
                type: 'Statistical',
                name: 'VAR.P',
                syntax: 'VAR.P(val1, [val2...])',
                example: '=VAR.P(1, 5)',
                desc: 'See VARP.',
                data: { A1: 1, A2: 5, target: 'B1', formula: '=VAR.P(A1:A2)', result: 4, highlight: ['A1', 'A2'], steps: ["Pop Var.", "Result 4."] }
            },
            {
                type: 'Statistical',
                name: 'VAR.S',
                syntax: 'VAR.S(val1, [val2...])',
                example: '=VAR.S(1, 5)',
                desc: 'See VAR.',
                data: { A1: 1, A2: 5, target: 'B1', formula: '=VAR.S(A1:A2)', result: 8, highlight: ['A1', 'A2'], steps: ["Sample Var.", "Result 8."] }
            },
            {
                type: 'Statistical',
                name: 'VARA',
                syntax: 'VARA(val1, [val2...])',
                example: '=VARA(1, "5")',
                desc: 'Calculates variance based on a sample, setting text to 0.',
                data: { A1: 1, A2: "Text", target: 'B1', formula: '=VARA(A1:A2)', result: 0.5, highlight: ['A1', 'A2'], steps: ["Text is 0.", "Sample Var.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'VARP',
                syntax: 'VARP(val1, [val2...])',
                example: '=VARP(1, 5)',
                desc: 'Calculates the variance based on an entire population.',
                data: { A1: 1, A2: 5, target: 'B1', formula: '=VARP(A1:A2)', result: 4, highlight: ['A1', 'A2'], steps: ["Pop Var.", "Result 4."] }
            },
            {
                type: 'Statistical',
                name: 'VARPA',
                syntax: 'VARPA(val1, [val2...])',
                example: '=VARPA(1, "5")',
                desc: 'Calculates pop variance, setting text to 0.',
                data: { A1: 1, A2: "Text", target: 'B1', formula: '=VARPA(A1:A2)', result: 0.25, highlight: ['A1', 'A2'], steps: ["Pop Var(1,0).", "Result 0.25."] }
            },
            {
                type: 'Statistical',
                name: 'WEIBULL',
                syntax: 'WEIBULL(x, shape, scale, cum)',
                example: '=WEIBULL(105, 20, 100, TRUE)',
                desc: 'Returns the value of the Weibull distribution.',
                data: { A1: 105, target: 'B1', formula: '=WEIBULL(A1, 20, 100, TRUE)', result: 0.93, highlight: ['A1'], steps: ["Legacy func.", "Result ~0.93."] }
            },
            {
                type: 'Statistical',
                name: 'WEIBULL.DIST',
                syntax: 'WEIBULL.DIST(x, shape, scale, cum)',
                example: '=WEIBULL.DIST(105, 20, 100, TRUE)',
                desc: 'See WEIBULL.',
                data: { A1: 105, target: 'B1', formula: '=WEIBULL.DIST(A1, 20, 100, TRUE)', result: 0.93, highlight: ['A1'], steps: ["Weibull Dist.", "Result ~0.93."] }
            },
            {
                type: 'Statistical',
                name: 'Z.TEST',
                syntax: 'Z.TEST(data, val, [std])',
                example: '=Z.TEST(A1:A3, 2)',
                desc: 'Returns the one-tailed P-value of a Z-test.',
                data: { A1: 1, A2: 2, A3: 3, target: 'B1', formula: '=Z.TEST(A1:A3, 2)', result: 0.5, highlight: ['A1', 'A2', 'A3'], steps: ["Z-Test.", "Result 0.5."] }
            },
            {
                type: 'Statistical',
                name: 'ZTEST',
                syntax: 'ZTEST(data, val, [std])',
                example: '=ZTEST(A1:A3, 2)',
                desc: 'See Z.TEST.',
                data: { A1: 1, A2: 2, A3: 3, target: 'B1', formula: '=ZTEST(A1:A3, 2)', result: 0.5, highlight: ['A1', 'A2', 'A3'], steps: ["Legacy Z-Test.", "Result 0.5."] }
            },
            {
                type: 'Parser',
                name: 'CONVERT',
                syntax: 'CONVERT(val, start_unit, end_unit)',
                example: '=CONVERT(1, "m", "ft")',
                desc: 'Converts a numeric value to a different unit of measure.',
                data: { A1: 1, target: 'B1', formula: '=CONVERT(A1, "m", "ft")', result: 3.28, highlight: ['A1'], steps: ["1 meter to feet.", "Result ~3.28."] }
            },
            {
                type: 'Parser',
                name: 'TO_DATE',
                syntax: 'TO_DATE(val)',
                example: '=TO_DATE(44197)',
                desc: 'Converts a provided number to a date.',
                data: { A1: 44197, target: 'B1', formula: '=TO_DATE(A1)', result: "1/1/2021", highlight: ['A1'], steps: ["Serial to Date.", "Result 1/1/2021."] }
            },
            {
                type: 'Parser',
                name: 'TO_DOLLARS',
                syntax: 'TO_DOLLARS(val)',
                example: '=TO_DOLLARS(123.45)',
                desc: 'Converts a provided number to a dollar value.',
                data: { A1: 123.45, target: 'B1', formula: '=TO_DOLLARS(A1)', result: "$123.45", highlight: ['A1'], steps: ["Format as currency.", "Result $123.45."] }
            },
            {
                type: 'Parser',
                name: 'TO_PERCENT',
                syntax: 'TO_PERCENT(val)',
                example: '=TO_PERCENT(0.5)',
                desc: 'Converts a provided number to a percentage.',
                data: { A1: 0.5, target: 'B1', formula: '=TO_PERCENT(A1)', result: "50%", highlight: ['A1'], steps: ["Format as percent.", "Result 50%."] }
            },
            {
                type: 'Parser',
                name: 'TO_PURE_NUMBER',
                syntax: 'TO_PURE_NUMBER(val)',
                example: '=TO_PURE_NUMBER("$100")',
                desc: 'Converts a formatted numeric value to a pure number.',
                data: { A1: "$100", target: 'B1', formula: '=TO_PURE_NUMBER(A1)', result: 100, highlight: ['A1'], steps: ["Strip formatting.", "Result 100."] }
            },
            {
                type: 'Parser',
                name: 'TO_TEXT',
                syntax: 'TO_TEXT(val)',
                example: '=TO_TEXT(123, "0.00")',
                desc: 'Converts a provided numeric value to a text value.',
                data: { A1: 123, target: 'B1', formula: '=TO_TEXT(A1)', result: "123", highlight: ['A1'], steps: ["Convert to text.", "Result '123'."] }
            },
            {
                type: 'Web',
                name: 'ENCODEURL',
                syntax: 'ENCODEURL(text)',
                example: '=ENCODEURL("Hello World")',
                desc: 'Encodes a string of text for the purpose of using in a URL query.',
                data: { A1: "Hello World", target: 'B1', formula: '=ENCODEURL(A1)', result: "Hello%20World", highlight: ['A1'], steps: ["Encode space to %20.", "Result Hello%20World."] }
            },
            {
                type: 'Web',
                name: 'HYPERLINK',
                syntax: 'HYPERLINK(url, [label])',
                example: '=HYPERLINK("http://google.com", "Google")',
                desc: 'Creates a hyperlink inside a cell.',
                data: { A1: "http://google.com", target: 'B1', formula: '=HYPERLINK(A1, "Google")', result: "Google", highlight: ['A1'], steps: ["Create Link.", "Result Google."] }
            },
            {
                type: 'Web',
                name: 'IMPORTDATA',
                syntax: 'IMPORTDATA(url)',
                example: '=IMPORTDATA("http://data.csv")',
                desc: 'Imports data at a given url in .csv or .tsv format.',
                data: { A1: "http://data.csv", target: 'B1', formula: '=IMPORTDATA(A1)', result: "{Data...}", highlight: ['A1'], steps: ["Fetch CSV.", "Parse Data.", "Result {Data...}."] }
            },
            {
                type: 'Web',
                name: 'IMPORTFEED',
                syntax: 'IMPORTFEED(url)',
                example: '=IMPORTFEED("http://feed.rss")',
                desc: 'Imports a RSS or ATOM feed.',
                data: { A1: "http://feed.rss", target: 'B1', formula: '=IMPORTFEED(A1)', result: "{Feed...}", highlight: ['A1'], steps: ["Fetch Feed.", "Parse Items.", "Result {Feed...}."] }
            },
            {
                type: 'Web',
                name: 'IMPORTHTML',
                syntax: 'IMPORTHTML(url, query, index)',
                example: '=IMPORTHTML("http://site.com", "table", 1)',
                desc: 'Imports data from a table or list within an HTML page.',
                data: { A1: "http://site.com", target: 'B1', formula: '=IMPORTHTML(A1, "table", 1)', result: "{Table...}", highlight: ['A1'], steps: ["Fetch HTML.", "Extract Table 1.", "Result {Table...}."] }
            },
            {
                type: 'Web',
                name: 'IMPORTRANGE',
                syntax: 'IMPORTRANGE(url, range)',
                example: '=IMPORTRANGE("keys", "Sheet1!A1:B2")',
                desc: 'Imports a range of cells from a specified spreadsheet.',
                data: { A1: "keys", target: 'B1', formula: '=IMPORTRANGE(A1, "A1:B2")', result: "{1, 2; 3, 4}", highlight: ['A1'], steps: ["Connect Sheet.", "Fetch A1:B2.", "Result Data."] }
            },
            {
                type: 'Web',
                name: 'IMPORTXML',
                syntax: 'IMPORTXML(url, xpath)',
                example: '=IMPORTXML("http://site.com", "//a/@href")',
                desc: 'Imports data from structured data types including XML, HTML, etc.',
                data: { A1: "http://site.com", target: 'B1', formula: '=IMPORTXML(A1, "//a")', result: "{Link1...}", highlight: ['A1'], steps: ["Fetch XML.", "Run XPath.", "Result Links."] }
            },
            {
                type: 'Web',
                name: 'ISURL',
                syntax: 'ISURL(value)',
                example: '=ISURL("http://google.com")',
                desc: 'Checks whether a value is a valid URL.',
                data: { A1: "http://google.com", target: 'B1', formula: '=ISURL(A1)', result: "TRUE", highlight: ['A1'], steps: ["Check format.", "Valid URL.", "Result TRUE."] }
            },
            {
                type: 'Database',
                name: 'DAVERAGE',
                syntax: 'DAVERAGE(db, field, crit)',
                example: '=DAVERAGE(A1:C5, "Score", E1:E2)',
                desc: 'Returns the average of a set of values selected from a database.',
                data: { A1: "Name", A2: "Score", B1: "John", B2: 90, C1: "Jane", C2: 80, target: 'D1', formula: '=DAVERAGE(..., "Score", ...)', result: 85, highlight: ['B2', 'C2'], steps: ["Filter by criteria.", "Avg(90, 80).", "Result 85."] }
            },
            {
                type: 'Database',
                name: 'DCOUNT',
                syntax: 'DCOUNT(db, field, crit)',
                example: '=DCOUNT(A1:C5, "Score", E1:E2)',
                desc: 'Counts numeric values selected from a database.',
                data: { A1: "Name", A2: "Score", B1: "John", B2: 90, C1: "Jane", C2: 80, target: 'D1', formula: '=DCOUNT(..., "Score", ...)', result: 2, highlight: ['B2', 'C2'], steps: ["Filter by criteria.", "Count numbers.", "Result 2."] }
            },
            {
                type: 'Database',
                name: 'DCOUNTA',
                syntax: 'DCOUNTA(db, field, crit)',
                example: '=DCOUNTA(A1:C5, "Name", E1:E2)',
                desc: 'Counts values, including text, selected from a database.',
                data: { A1: "Name", A2: "Score", B1: "John", B2: 90, C1: "Jane", C2: 80, target: 'D1', formula: '=DCOUNTA(..., "Name", ...)', result: 2, highlight: ['B1', 'C1'], steps: ["Filter by criteria.", "Count non-empty.", "Result 2."] }
            },
            {
                type: 'Database',
                name: 'DGET',
                syntax: 'DGET(db, field, crit)',
                example: '=DGET(A1:C5, "Score", E1:E2)',
                desc: 'Returns a single value from a database table-like array.',
                data: { A1: "Name", A2: "Score", B1: "John", B2: 90, target: 'C1', formula: '=DGET(..., "Score", ...)', result: 90, highlight: ['B2'], steps: ["Filter unique.", "Result 90."] }
            },
            {
                type: 'Database',
                name: 'DMAX',
                syntax: 'DMAX(db, field, crit)',
                example: '=DMAX(A1:C5, "Score", E1:E2)',
                desc: 'Returns the maximum value selected from a database.',
                data: { A1: "Name", A2: "Score", B1: "John", B2: 90, C1: "Jane", C2: 80, target: 'D1', formula: '=DMAX(..., "Score", ...)', result: 90, highlight: ['B2', 'C2'], steps: ["Filter by criteria.", "Max(90, 80).", "Result 90."] }
            },
            {
                type: 'Database',
                name: 'DMIN',
                syntax: 'DMIN(db, field, crit)',
                example: '=DMIN(A1:C5, "Score", E1:E2)',
                desc: 'Returns the minimum value selected from a database.',
                data: { A1: "Name", A2: "Score", B1: "John", B2: 90, C1: "Jane", C2: 80, target: 'D1', formula: '=DMIN(..., "Score", ...)', result: 80, highlight: ['B2', 'C2'], steps: ["Filter by criteria.", "Min(90, 80).", "Result 80."] }
            },
            {
                type: 'Database',
                name: 'DPRODUCT',
                syntax: 'DPRODUCT(db, field, crit)',
                example: '=DPRODUCT(A1:C5, "Score", E1:E2)',
                desc: 'Returns the product of values selected from a database.',
                data: { A1: "Name", A2: "Score", B1: "John", B2: 90, C1: "Jane", C2: 80, target: 'D1', formula: '=DPRODUCT(..., "Score", ...)', result: 7200, highlight: ['B2', 'C2'], steps: ["Filter by criteria.", "90 * 80.", "Result 7200."] }
            },
            {
                type: 'Database',
                name: 'DSTDEV',
                syntax: 'DSTDEV(db, field, crit)',
                example: '=DSTDEV(A1:C5, "Score", E1:E2)',
                desc: 'Returns the standard deviation of a sample from a database.',
                data: { A1: "Name", A2: "Score", B1: "John", B2: 90, C1: "Jane", C2: 80, target: 'D1', formula: '=DSTDEV(..., "Score", ...)', result: 7.07, highlight: ['B2', 'C2'], steps: ["Filter by criteria.", "Sample SD.", "Result ~7.07."] }
            },
            {
                type: 'Database',
                name: 'DSTDEVP',
                syntax: 'DSTDEVP(db, field, crit)',
                example: '=DSTDEVP(A1:C5, "Score", E1:E2)',
                desc: 'Returns the standard deviation of a population from a database.',
                data: { A1: "Name", A2: "Score", B1: "John", B2: 90, C1: "Jane", C2: 80, target: 'D1', formula: '=DSTDEVP(..., "Score", ...)', result: 5, highlight: ['B2', 'C2'], steps: ["Filter by criteria.", "Pop SD.", "Result 5."] }
            },
            {
                type: 'Database',
                name: 'DSUM',
                syntax: 'DSUM(db, field, crit)',
                example: '=DSUM(A1:C5, "Score", E1:E2)',
                desc: 'Returns the sum of values selected from a database.',
                data: { A1: "Name", A2: "Score", B1: "John", B2: 90, C1: "Jane", C2: 80, target: 'D1', formula: '=DSUM(..., "Score", ...)', result: 170, highlight: ['B2', 'C2'], steps: ["Filter by criteria.", "90 + 80.", "Result 170."] }
            },
            {
                type: 'Database',
                name: 'DVAR',
                syntax: 'DVAR(db, field, crit)',
                example: '=DVAR(A1:C5, "Score", E1:E2)',
                desc: 'Returns the variance of a sample from a database.',
                data: { A1: "Name", A2: "Score", B1: "John", B2: 90, C1: "Jane", C2: 80, target: 'D1', formula: '=DVAR(..., "Score", ...)', result: 50, highlight: ['B2', 'C2'], steps: ["Filter by criteria.", "Sample Var.", "Result 50."] }
            },
            {
                type: 'Database',
                name: 'DVARP',
                syntax: 'DVARP(db, field, crit)',
                example: '=DVARP(A1:C5, "Score", E1:E2)',
                desc: 'Returns the variance of a population from a database.',
                data: { A1: "Name", A2: "Score", B1: "John", B2: 90, C1: "Jane", C2: 80, target: 'D1', formula: '=DVARP(..., "Score", ...)', result: 25, highlight: ['B2', 'C2'], steps: ["Filter by criteria.", "Pop Var.", "Result 25."] }
            },
            {
                type: 'Lookup',
                name: 'ADDRESS',
                syntax: 'ADDRESS(row, col, [mode], [a1], [sheet])',
                example: '=ADDRESS(1, 1)',
                desc: 'Returns a cell reference as a string.',
                data: { target: 'A1', formula: '=ADDRESS(1, 1)', result: "$A$1", highlight: [], steps: ["Row 1, Col 1.", "Result $A$1."] }
            },
            {
                type: 'Lookup',
                name: 'CHOOSE',
                syntax: 'CHOOSE(index, choice1, [choice2, ...])',
                example: '=CHOOSE(2, "A", "B", "C")',
                desc: 'Returns an element from a list of choices based on index.',
                data: { A1: 2, target: 'B1', formula: '=CHOOSE(A1, "Red", "Blue", "Green")', result: "Blue", highlight: ['A1'], steps: ["Index is 2.", "Pick 2nd: Blue."] }
            },
            {
                type: 'Lookup',
                name: 'COLUMN',
                syntax: 'COLUMN([cell])',
                example: '=COLUMN(B1)',
                desc: 'Returns the column number of a specified cell.',
                data: { target: 'A1', formula: '=COLUMN(B1)', result: 2, highlight: ['B1'], steps: ["Col B is 2nd.", "Result 2."] }
            },
            {
                type: 'Lookup',
                name: 'COLUMNS',
                syntax: 'COLUMNS(range)',
                example: '=COLUMNS(A1:C1)',
                desc: 'Returns the number of columns in a specified array or range.',
                data: { target: 'A1', formula: '=COLUMNS(A1:C1)', result: 3, highlight: ['A1', 'B1', 'C1'], steps: ["Count cols A to C.", "Result 3."] }
            },
            {
                type: 'Lookup',
                name: 'FORMULATEXT',
                syntax: 'FORMULATEXT(cell)',
                example: '=FORMULATEXT(A1)',
                desc: 'Returns the formula as a string.',
                data: { A1: 10, target: 'B1', formula: '=FORMULATEXT(A1)', result: "=SUM(1,2)", highlight: ['A1'], steps: ["Get formula string.", "Result ..."] }
            },
            {
                type: 'Lookup',
                name: 'GETPIVOTDATA',
                syntax: 'GETPIVOTDATA(val_name, pivot_cell, [orig_col, ...])',
                example: '=GETPIVOTDATA("Sales", A1)',
                desc: 'Extracts an aggregated value from a pivot table.',
                data: { target: 'A1', formula: '=GETPIVOTDATA("S", A1)', result: 100, highlight: ['A1'], steps: ["Query pivot.", "Result 100."] }
            },
            {
                type: 'Lookup',
                name: 'HLOOKUP',
                syntax: 'HLOOKUP(key, range, index, [sorted])',
                example: '=HLOOKUP(1, A1:C2, 2, FALSE)',
                desc: 'Horizontal lookup.',
                data: { A1: 1, A2: "One", B1: 2, B2: "Two", target: 'C1', formula: '=HLOOKUP(1, A1:B2, 2, FALSE)', result: "One", highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Find 1 in Row 1.", "Return Row 2.", "Result One."] }
            },
            {
                type: 'Lookup',
                name: 'INDIRECT',
                syntax: 'INDIRECT(ref_string, [a1])',
                example: '=INDIRECT("A1")',
                desc: 'Returns a cell reference specified by a string.',
                data: { A1: 5, target: 'B1', formula: '=INDIRECT("A1")', result: 5, highlight: ['A1'], steps: ["String \"A1\".", "Fetch A1 value.", "Result 5."] }
            },
            {
                type: 'Lookup',
                name: 'LOOKUP',
                syntax: 'LOOKUP(key, search_rng, [result_rng])',
                example: '=LOOKUP(1, A1:A2, B1:B2)',
                desc: 'Looks through a row or column for a key.',
                data: { A1: 1, A2: 2, B1: "One", B2: "Two", target: 'C1', formula: '=LOOKUP(1, A1:A2, B1:B2)', result: "One", highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Find 1 in A.", "Return corresp B.", "Result One."] }
            },
            {
                type: 'Lookup',
                name: 'OFFSET',
                syntax: 'OFFSET(cell_ref, rows, cols, [h], [w])',
                example: '=OFFSET(A1, 1, 1)',
                desc: 'Returns a range reference shifted from a starting cell.',
                data: { A1: "Start", B2: "Target", target: 'C1', formula: '=OFFSET(A1, 1, 1)', result: "Target", highlight: ['A1', 'B2'], steps: ["A1 down 1, right 1.", "Lands on B2.", "Result Target."] }
            },
            {
                type: 'Lookup',
                name: 'ROW',
                syntax: 'ROW([cell])',
                example: '=ROW(A2)',
                desc: 'Returns the row number of a specified cell.',
                data: { target: 'B1', formula: '=ROW(A2)', result: 2, highlight: ['A2'], steps: ["Row A2 is 2.", "Result 2."] }
            },
            {
                type: 'Lookup',
                name: 'ROWS',
                syntax: 'ROWS(range)',
                example: '=ROWS(A1:A3)',
                desc: 'Returns the number of rows in a specified array or range.',
                data: { target: 'B1', formula: '=ROWS(A1:A3)', result: 3, highlight: ['A1', 'A2', 'A3'], steps: ["Count rows 1 to 3.", "Result 3."] }
            },
            {
                type: 'Lookup',
                name: 'VLOOKUP',
                syntax: 'VLOOKUP(key, range, index, [sorted])',
                example: '=VLOOKUP(1, A1:B2, 2, FALSE)',
                desc: 'Vertical lookup.',
                data: { A1: 1, A2: 2, B1: "One", B2: "Two", target: 'C1', formula: '=VLOOKUP(1, A1:B2, 2, FALSE)', result: "One", highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Find 1 in Col A.", "Return Col B.", "Result One."] }
            },
            {
                type: 'Lookup',
                name: 'XLOOKUP',
                syntax: 'XLOOKUP(key, lookup, result, [miss], [match], [search])',
                example: '=XLOOKUP(1, A1:A2, B1:B2)',
                desc: 'Returns values in result range based on match in lookup range.',
                data: { A1: 1, A2: 2, B1: "One", B2: "Two", target: 'C1', formula: '=XLOOKUP(1, A1:A2, B1:B2)', result: "One", highlight: ['A1', 'A2', 'B1', 'B2'], steps: ["Match 1 in A.", "Return B.", "Result One."] }
            },
            {
                type: 'Info',
                name: 'ERROR.TYPE',
                syntax: 'ERROR.TYPE(ref)',
                example: '=ERROR.TYPE(A1)',
                desc: 'Returns a number corresponding to the error value in a different cell.',
                data: { A1: "#N/A", target: 'B1', formula: '=ERROR.TYPE(A1)', result: 7, highlight: ['A1'], steps: ["Check error type.", "Result 7 (for #N/A)."] }
            },
            {
                type: 'Info',
                name: 'ISBLANK',
                syntax: 'ISBLANK(value)',
                example: '=ISBLANK(A1)',
                desc: 'Checks whether the referenced cell is empty.',
                data: { target: 'B1', formula: '=ISBLANK(A1)', result: "TRUE", highlight: ['A1'], steps: ["Check A1.", "It is empty.", "Result TRUE."] }
            },
            {
                type: 'Info',
                name: 'ISDATE',
                syntax: 'ISDATE(value)',
                example: '=ISDATE(A1)',
                desc: 'Returns whether a value is a date.',
                data: { A1: "1/1/2021", target: 'B1', formula: '=ISDATE(A1)', result: "TRUE", highlight: ['A1'], steps: ["Check date format.", "Result TRUE."] }
            },
            {
                type: 'Info',
                name: 'ISEMAIL',
                syntax: 'ISEMAIL(value)',
                example: '=ISEMAIL("test@example.com")',
                desc: 'Checks whether a value is a valid email address.',
                data: { A1: "foo@bar.com", target: 'B1', formula: '=ISEMAIL(A1)', result: "TRUE", highlight: ['A1'], steps: ["Check format.", "Valid email.", "Result TRUE."] }
            },
            {
                type: 'Info',
                name: 'ISERR',
                syntax: 'ISERR(value)',
                example: '=ISERR(A1)',
                desc: 'Checks whether a value is an error other than #N/A.',
                data: { A1: "#VALUE!", target: 'B1', formula: '=ISERR(A1)', result: "TRUE", highlight: ['A1'], steps: ["Check error.", "Not #N/A.", "Result TRUE."] }
            },
            {
                type: 'Info',
                name: 'ISERROR',
                syntax: 'ISERROR(value)',
                example: '=ISERROR(A1)',
                desc: 'Checks whether a value is an error.',
                data: { A1: "#N/A", target: 'B1', formula: '=ISERROR(A1)', result: "TRUE", highlight: ['A1'], steps: ["Check any error.", "Result TRUE."] }
            },
            {
                type: 'Info',
                name: 'ISFORMULA',
                syntax: 'ISFORMULA(cell)',
                example: '=ISFORMULA(A1)',
                desc: 'Checks whether a formula is in the referenced cell.',
                data: { A1: "=SUM(1,1)", target: 'B1', formula: '=ISFORMULA(A1)', result: "TRUE", highlight: ['A1'], steps: ["Check if formula.", "Result TRUE."] }
            },
            {
                type: 'Info',
                name: 'ISLOGICAL',
                syntax: 'ISLOGICAL(value)',
                example: '=ISLOGICAL(TRUE)',
                desc: 'Checks whether a value is TRUE or FALSE.',
                data: { A1: "TRUE", target: 'B1', formula: '=ISLOGICAL(A1)', result: "TRUE", highlight: ['A1'], steps: ["Check boolean.", "Result TRUE."] }
            },
            {
                type: 'Info',
                name: 'ISNA',
                syntax: 'ISNA(value)',
                example: '=ISNA(A1)',
                desc: 'Checks whether a value is the error #N/A.',
                data: { A1: "#N/A", target: 'B1', formula: '=ISNA(A1)', result: "TRUE", highlight: ['A1'], steps: ["Check #N/A.", "Result TRUE."] }
            },
            {
                type: 'Info',
                name: 'ISNONTEXT',
                syntax: 'ISNONTEXT(value)',
                example: '=ISNONTEXT(123)',
                desc: 'Checks whether a value is non-textual.',
                data: { A1: 123, target: 'B1', formula: '=ISNONTEXT(A1)', result: "TRUE", highlight: ['A1'], steps: ["Check content.", "It's number.", "Result TRUE."] }
            },
            {
                type: 'Info',
                name: 'ISNUMBER',
                syntax: 'ISNUMBER(value)',
                example: '=ISNUMBER(123)',
                desc: 'Checks whether a value is a number.',
                data: { A1: 123, target: 'B1', formula: '=ISNUMBER(A1)', result: "TRUE", highlight: ['A1'], steps: ["Check number.", "Result TRUE."] }
            },
            {
                type: 'Info',
                name: 'ISREF',
                syntax: 'ISREF(value)',
                example: '=ISREF(A1)',
                desc: 'Checks whether a value is a valid cell reference.',
                data: { target: 'B1', formula: '=ISREF(A1)', result: "TRUE", highlight: ['A1'], steps: ["Check reference.", "Valid A1.", "Result TRUE."] }
            },
            {
                type: 'Info',
                name: 'ISTEXT',
                syntax: 'ISTEXT(value)',
                example: '=ISTEXT("foo")',
                desc: 'Checks whether a value is text.',
                data: { A1: "foo", target: 'B1', formula: '=ISTEXT(A1)', result: "TRUE", highlight: ['A1'], steps: ["Check text.", "Result TRUE."] }
            },
            {
                type: 'Info',
                name: 'N',
                syntax: 'N(value)',
                example: '=N(TRUE)',
                desc: 'Returns the argument provided as a number.',
                data: { A1: "TRUE", target: 'B1', formula: '=N(A1)', result: 1, highlight: ['A1'], steps: ["Convert to number.", "TRUE is 1.", "Result 1."] }
            },
            {
                type: 'Info',
                name: 'NA',
                syntax: 'NA()',
                example: '=NA()',
                desc: 'Returns the "value not available" error, #N/A.',
                data: { target: 'A1', formula: '=NA()', result: "#N/A", highlight: [], steps: ["Return error.", "Result #N/A."] }
            },
            {
                type: 'Info',
                name: 'TYPE',
                syntax: 'TYPE(value)',
                example: '=TYPE(123)',
                desc: 'Returns a number associated with the type of data.',
                data: { A1: 123, target: 'B1', formula: '=TYPE(A1)', result: 1, highlight: ['A1'], steps: ["Check type.", "1 is number.", "Result 1."] }
            },
            {
                type: 'Info',
                name: 'CELL',
                syntax: 'CELL(info_type, ref)',
                example: '=CELL("address", A1)',
                desc: 'Returns the requested information about the specified cell.',
                data: { target: 'B1', formula: '=CELL("address", A1)', result: "$A$1", highlight: ['A1'], steps: ["Get address info.", "Result $A$1."] }
            }
        ];

        // Render Table
        const tbody = document.getElementById('functions-body');

        // Render Controls
        const mainHeader = document.querySelector('header');
        const controlsHTML = `
            <div class="controls-wrapper">
                <div class="search-box">
                    <input type="text" id="searchInput" class="search-input" placeholder="Search functions...">
                </div>
                <select id="typeFilter" class="filter-select">
                    <option value="all">All Types</option>
                    <option value="math">Math</option>
                    <option value="text">Text</option>
                    <option value="date">Date</option>
                    <option value="filter">Filter</option>
                    <option value="engineering">Engineering</option>
                    <option value="operator">Operator</option>
                    <option value="statistical">Statistical</option>
                    <option value="parser">Parser</option>
                    <option value="web">Web</option>
                    <option value="database">Database</option>
                    <option value="lookup">Lookup</option>
                    <option value="info">Info</option>
                    <option value="google">Google</option>
                </select>
                <select id="readFilter" class="filter-select">
                    <option value="all">All Status</option>
                    <option value="read">Read Only</option>
                    <option value="unread">Unread Only</option>
                </select>
            </div>
        `;
        mainHeader.insertAdjacentHTML('afterend', controlsHTML);

        // Filter Logic
        const searchInput = document.getElementById('searchInput');
        const typeFilter = document.getElementById('typeFilter');
        const readFilter = document.getElementById('readFilter');

        function filterFunctions() {
            const searchTerm = searchInput.value.toLowerCase();
            const selectedType = typeFilter.value.toLowerCase();
            const selectedReadStatus = readFilter.value;
            const rows = document.querySelectorAll('.func-row');
            let visibleCount = 0;

            rows.forEach(row => {
                const name = row.dataset.name;
                const type = row.dataset.type;
                const checkbox = row.querySelector('.read-checkbox');
                const isChecked = checkbox ? checkbox.checked : false;

                const matchesSearch = name.includes(searchTerm);
                const matchesType = selectedType === 'all' || type === selectedType;
                const matchesReadStatus = selectedReadStatus === 'all' ||
                    (selectedReadStatus === 'read' && isChecked) ||
                    (selectedReadStatus === 'unread' && !isChecked);

                if (matchesSearch && matchesType && matchesReadStatus) {
                    row.style.display = '';
                    visibleCount++;
                } else {
                    row.style.display = 'none';
                }
            });
        }

        searchInput.addEventListener('input', filterFunctions);
        typeFilter.addEventListener('change', filterFunctions);
        readFilter.addEventListener('change', filterFunctions);

        // IndexedDB helpers for persisting read status
        const dbName = 'sheetmaster-db';
        const storeName = 'readFunctions';
        let db;

        function openDB() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open(dbName, 1);
                request.onupgradeneeded = function (event) {
                    const db = event.target.result;
                    if (!db.objectStoreNames.contains(storeName)) {
                        db.createObjectStore(storeName, { keyPath: 'name' });
                    }
                };
                request.onsuccess = function (event) {
                    db = event.target.result;
                    resolve();
                };
                request.onerror = function (event) {
                    console.error('IndexedDB error', event);
                    reject(event);
                };
            });
        }

        async function getReadFunctions() {
            await openDB();
            return new Promise((resolve, reject) => {
                const tx = db.transaction(storeName, 'readonly');
                const store = tx.objectStore(storeName);
                const request = store.getAll();
                request.onsuccess = function () {
                    const result = request.result.map(item => item.name);
                    resolve(result);
                };
                request.onerror = function (e) { reject(e); };
            });
        }

        async function saveReadFunction(functionName) {
            await openDB();
            const tx = db.transaction(storeName, 'readwrite');
            const store = tx.objectStore(storeName);
            store.put({ name: functionName });
        }

        async function removeReadFunction(functionName) {
            await openDB();
            const tx = db.transaction(storeName, 'readwrite');
            const store = tx.objectStore(storeName);
            store.delete(functionName);
        }

        // Main Initialization
        (async () => {
            const readFuncs = await getReadFunctions();

            // Render Table Rows
            // Render Table Rows
            functions.forEach((f, index) => {
                const tr = document.createElement('tr');
                tr.className = 'func-row';
                tr.dataset.type = f.type.toLowerCase();
                tr.dataset.name = f.name.toLowerCase();

                const isChecked = readFuncs.includes(f.name);

                tr.innerHTML = `
                    <td style="text-align: center;">
                        <input type="checkbox" class="read-checkbox" data-function="${f.name}" ${isChecked ? 'checked' : ''} />
                    </td>
                    <td><span class="type-badge type-${f.type.toLowerCase()}">${f.type}</span></td>
                    <td><div class="func_name">${f.name}</div></td>
                    <td><div class="syntax">${f.syntax}</div></td>
                    <td><div class="example">${f.example}</div></td>
                    <td><div class="desc">${f.desc}</div></td>
                    <td>
                        <button class="play-btn" onclick="startDemo(${index})">
                            <svg class="play-icon" viewBox="0 0 24 24">
                                <path d="M8 5v14l11-7z"/>
                            </svg>
                        </button>
                    </td>`;
                tbody.appendChild(tr);
            });

            // Calculate and update progress
            updateProgress();
        })();

        // Event listener for checkboxes
        document.addEventListener('change', async (e) => {
            if (e.target.classList.contains('read-checkbox')) {
                const functionName = e.target.dataset.function;
                if (e.target.checked) {
                    await saveReadFunction(functionName);
                } else {
                    await removeReadFunction(functionName);
                }
                filterFunctions();
                updateProgress();
            }
        });

        // Progress Bar Logic
        async function updateProgress() {
            const total = functions.length;
            const reads = await getReadFunctions();
            const percentage = total === 0 ? 0 : Math.round((reads.length / total) * 100);

            const rateEl = document.getElementById('completion-rate');
            const barEl = document.getElementById('progress-bar-fill');

            if (rateEl) rateEl.textContent = `${percentage}%`;
            if (barEl) barEl.style.width = `${percentage}%`;
        }

        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js').catch(err => console.error('SW failed', err));
            });
        }

        // Animation Logic
        let currentAnimationTimeout;
        const modal = document.getElementById('modal');
        const demoTitle = document.getElementById('demo-title');
        const gridContainer = document.getElementById('grid-container');
        const formulaText = document.getElementById('formula-text');
        const cursor = document.getElementById('cursor');
        const statusText = document.getElementById('status-text');

        function closeModal() {
            modal.classList.remove('active');
            clearTimeout(currentAnimationTimeout);
            // Reset state
            formulaText.textContent = '';
            cursor.style.display = 'none';
        }

        // Close on outside click
        modal.addEventListener('click', (e) => {
            if (e.target === modal) closeModal();
        });

        async function wait(ms) {
            return new Promise(resolve => {
                currentAnimationTimeout = setTimeout(resolve, ms);
            });
        }

        async function typeText(text) {
            cursor.style.display = 'inline-block';
            formulaText.textContent = '';
            for (let char of text) {
                await wait(50); // Typing speed
                formulaText.textContent += char;
            }
            await wait(300);
            cursor.style.display = 'none';
        }

        function createGrid(dataObj) {
            gridContainer.innerHTML = '';


            const colsSet = new Set();
            const ignoreKeys = ['target', 'formula', 'result', 'highlight', 'steps'];

            Object.keys(dataObj).forEach(key => {
                if (!ignoreKeys.includes(key)) {
                    // Assume strictly A-Z column notation
                    const colMatch = key.match(/^[A-Z]+/);
                    if (colMatch) {
                        colsSet.add(colMatch[0]);
                    }
                }
            });
            // Ensure at least A-D for basic layout
            ['A', 'B', 'C', 'D'].forEach(c => colsSet.add(c));
            const cols = Array.from(colsSet).sort();

            // Generate Headers (first empty cell then column letters)
            const headers = [' ', ...cols];

            headers.forEach(h => {
                const div = document.createElement('div');
                div.className = 'cell cell-header';
                div.textContent = h;
                gridContainer.appendChild(div);
            });

            // Helper to place a value into a specific cell
            const placeValue = (col, row, value) => {
                const cellId = `${col}${row}`;
                const cellDiv = document.getElementById(`cell-${cellId}`);
                if (cellDiv) cellDiv.textContent = value;
            };

            // Generate grid rows (1..6) and columns based on cols set
            for (let r = 1; r <= 6; r++) {
                // Row header
                const rowHead = document.createElement('div');
                rowHead.className = 'cell cell-header';
                rowHead.textContent = r;
                gridContainer.appendChild(rowHead);

                cols.forEach(c => {
                    const cellId = `${c}${r}`;
                    const div = document.createElement('div');
                    div.className = 'cell';
                    div.id = `cell-${cellId}`;
                    // Direct cell data from dataObj
                    if (dataObj[cellId] !== undefined) {
                        div.textContent = dataObj[cellId];
                    }
                    gridContainer.appendChild(div);
                });
            }

            // Handle spill results (arrays) for functions like SPLIT, UNIQUE, etc.
            if (Array.isArray(dataObj.result) && dataObj.target) {
                // Target is a string like 'A1'
                const startCol = dataObj.target[0];
                const startRow = parseInt(dataObj.target.slice(1), 10);

                // Expected format is 2D array: [["A", "B"], ["C", "D"]]
                // If it's a 1D array at the top level, treat it as a vertical list (column)
                const matrix = Array.isArray(dataObj.result[0]) ? dataObj.result : dataObj.result.map(x => [x]);

                matrix.forEach((rowVals, rowIdx) => {
                    rowVals.forEach((val, colIdx) => {
                        const col = String.fromCharCode(startCol.charCodeAt(0) + colIdx);
                        const row = startRow + rowIdx;
                        placeValue(col, row, val);
                    });
                });
            }
        }

        async function startDemo(index) {
            const func = functions[index];
            let data = func.data;

            // Generate generic data if missing
            if (!data) {
                data = {
                    target: 'A1',
                    formula: func.example ? func.example.split(',')[0] + '...)' : '=' + func.name + '(...)',
                    result: '#DEMO',
                    highlight: [],
                    steps: ["Select cell.", "Type formula syntax.", "Function is executed.", "Result returned."]
                };
            }

            // Setup Modal
            demoTitle.textContent = `${func.name} Function Demo`;
            createGrid(data);
            modal.classList.add('active');

            // Start Animation Sequence

            // Step 1: Initialize
            statusText.textContent = data.steps[0] || "Selecting cell...";
            await wait(800);

            const targetCell = document.getElementById(`cell-${data.target}`);
            if (targetCell) targetCell.classList.add('active');

            // Step 2: Typing Formula
            statusText.textContent = data.steps[1] || "Typing formula...";
            await wait(500);
            await typeText(data.formula);

            // Step 3: Highlight Reference Range
            if (data.highlight && data.highlight.length > 0) {
                statusText.textContent = data.steps[2] || "Referencing cells...";
                // Visual Highlight on Grid
                data.highlight.forEach(id => {
                    const el = document.getElementById(`cell-${id}`);
                    if (el) el.classList.add('highlight');
                });
                await wait(1500);
            }

            // Step 4: Calculate
            statusText.textContent = data.steps[3] || "Calculating result...";
            await wait(800);

            // Show Result in Cell
            if (targetCell) {
                targetCell.textContent = data.result;
                // Flash effect
                targetCell.style.backgroundColor = 'rgba(16, 185, 129, 0.2)';
                setTimeout(() => targetCell.style.backgroundColor = '#fff', 300);
            }

            // Clear highlights
            if (data.highlight) {
                data.highlight.forEach(id => {
                    const el = document.getElementById(`cell-${id}`);
                    if (el) el.classList.remove('highlight');
                });
            }

            statusText.textContent = "Done!";
        }

    </script>

    <!-- Fixed Footer -->
    <footer class="fixed-footer">
        <p>Ideation & development <span class="creator-name">Satyaki Das</span> | Innovation in Education v_03.0.0</p>
    </footer>
</body>

</html>
